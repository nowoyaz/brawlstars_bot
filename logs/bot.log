2025-03-20 18:50:03,321 - __main__ - INFO - Запуск бота...
2025-03-20 18:50:03,715 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:03,715 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-03-20 18:50:03,715 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:03,717 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referrals")
2025-03-20 18:50:03,717 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:03,717 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("announcements")
2025-03-20 18:50:03,718 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:03,718 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("reports")
2025-03-20 18:50:03,719 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:03,719 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("favorites")
2025-03-20 18:50:03,719 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:03,720 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("crystal_transactions")
2025-03-20 18:50:03,720 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:03,721 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("premium_prices")
2025-03-20 18:50:03,721 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:03,721 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sponsors")
2025-03-20 18:50:03,722 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:03,722 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_sponsor_subscriptions")
2025-03-20 18:50:03,722 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:03,722 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_codes")
2025-03-20 18:50:03,723 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:03,723 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_uses")
2025-03-20 18:50:03,723 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:03,723 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-03-20 18:50:03,724 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:03,724 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_achievements")
2025-03-20 18:50:03,724 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:03,724 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_visited_sections")
2025-03-20 18:50:03,725 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:03,725 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_secret_purchases")
2025-03-20 18:50:03,725 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:03,725 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("bot_settings")
2025-03-20 18:50:03,725 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:03,726 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:50:03,753 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:03,759 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:03,759 - sqlalchemy.engine.Engine - INFO - [generated in 0.00052s] (30, 1, 0)
2025-03-20 18:50:03,762 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:03,762 - sqlalchemy.engine.Engine - INFO - [cached since 0.003462s ago] (180, 1, 0)
2025-03-20 18:50:03,764 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:03,765 - sqlalchemy.engine.Engine - INFO - [cached since 0.006176s ago] (365, 1, 0)
2025-03-20 18:50:03,765 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:03,766 - sqlalchemy.engine.Engine - INFO - [cached since 0.007239s ago] (36500, 1, 0)
2025-03-20 18:50:03,766 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:50:03,786 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:03,789 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements) AS anon_1
2025-03-20 18:50:03,790 - sqlalchemy.engine.Engine - INFO - [generated in 0.00120s] ()
2025-03-20 18:50:03,790 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:03,792 - root - INFO - Achievements handlers registered successfully
2025-03-20 18:50:03,929 - aiogram - INFO - Bot: Бубсер Поиск Бот [@Bubser_PoiskBot]
2025-03-20 18:50:04,005 - aiogram - WARNING - Updates were skipped successfully.
2025-03-20 18:50:04,006 - __main__ - INFO - Бот успешно запущен!
2025-03-20 18:50:04,006 - aiogram.dispatcher.dispatcher - INFO - Start polling.
2025-03-20 18:50:04,022 - aiogram - WARNING - Goodbye!
2025-03-20 18:50:09,175 - __main__ - INFO - Запуск бота...
2025-03-20 18:50:09,446 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:09,446 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-03-20 18:50:09,446 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,446 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2025-03-20 18:50:09,447 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,447 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referrals")
2025-03-20 18:50:09,447 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,448 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referrals")
2025-03-20 18:50:09,448 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,449 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("announcements")
2025-03-20 18:50:09,449 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,449 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("announcements")
2025-03-20 18:50:09,450 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,450 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("reports")
2025-03-20 18:50:09,450 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,450 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("reports")
2025-03-20 18:50:09,450 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,451 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("favorites")
2025-03-20 18:50:09,451 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,451 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("favorites")
2025-03-20 18:50:09,451 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,451 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("crystal_transactions")
2025-03-20 18:50:09,451 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,452 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("crystal_transactions")
2025-03-20 18:50:09,452 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,452 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("premium_prices")
2025-03-20 18:50:09,452 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,452 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("premium_prices")
2025-03-20 18:50:09,453 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,453 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sponsors")
2025-03-20 18:50:09,453 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,453 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("sponsors")
2025-03-20 18:50:09,453 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,453 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_sponsor_subscriptions")
2025-03-20 18:50:09,453 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,453 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_sponsor_subscriptions")
2025-03-20 18:50:09,455 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,455 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_codes")
2025-03-20 18:50:09,455 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,456 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("promo_codes")
2025-03-20 18:50:09,456 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,456 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_uses")
2025-03-20 18:50:09,456 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,456 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("promo_uses")
2025-03-20 18:50:09,456 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,457 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-03-20 18:50:09,457 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,457 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("achievements")
2025-03-20 18:50:09,457 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,457 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_achievements")
2025-03-20 18:50:09,457 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,458 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_achievements")
2025-03-20 18:50:09,458 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,458 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_visited_sections")
2025-03-20 18:50:09,458 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,458 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_visited_sections")
2025-03-20 18:50:09,459 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,459 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_secret_purchases")
2025-03-20 18:50:09,459 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,459 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_secret_purchases")
2025-03-20 18:50:09,459 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,459 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("bot_settings")
2025-03-20 18:50:09,460 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,460 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("bot_settings")
2025-03-20 18:50:09,460 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:50:09,461 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	tg_id INTEGER NOT NULL, 
	username VARCHAR, 
	first_name VARCHAR, 
	is_premium BOOLEAN, 
	premium_end_date DATETIME, 
	crystals INTEGER, 
	language VARCHAR, 
	blocked BOOLEAN, 
	last_gift DATETIME, 
	created_at DATETIME, 
	updated_at DATETIME, 
	coins INTEGER, 
	premium_until DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE (tg_id)
)


2025-03-20 18:50:09,462 - sqlalchemy.engine.Engine - INFO - [no key 0.00088s] ()
2025-03-20 18:50:09,467 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_id ON users (id)
2025-03-20 18:50:09,467 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2025-03-20 18:50:09,470 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referrals (
	id INTEGER NOT NULL, 
	referrer_id INTEGER NOT NULL, 
	referred_id INTEGER NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE (referred_id)
)


2025-03-20 18:50:09,471 - sqlalchemy.engine.Engine - INFO - [no key 0.00079s] ()
2025-03-20 18:50:09,473 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_referrals_id ON referrals (id)
2025-03-20 18:50:09,473 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2025-03-20 18:50:09,477 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE premium_prices (
	id INTEGER NOT NULL, 
	duration_days INTEGER NOT NULL, 
	price FLOAT NOT NULL, 
	created_at DATETIME, 
	updated_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE (duration_days)
)


2025-03-20 18:50:09,477 - sqlalchemy.engine.Engine - INFO - [no key 0.00042s] ()
2025-03-20 18:50:09,480 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_premium_prices_id ON premium_prices (id)
2025-03-20 18:50:09,480 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2025-03-20 18:50:09,483 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE sponsors (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	link VARCHAR NOT NULL, 
	channel_id VARCHAR, 
	reward INTEGER, 
	is_active BOOLEAN, 
	created_at DATETIME, 
	updated_at DATETIME, 
	PRIMARY KEY (id)
)


2025-03-20 18:50:09,483 - sqlalchemy.engine.Engine - INFO - [no key 0.00050s] ()
2025-03-20 18:50:09,487 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_sponsors_id ON sponsors (id)
2025-03-20 18:50:09,487 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2025-03-20 18:50:09,491 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE promo_codes (
	id INTEGER NOT NULL, 
	code VARCHAR NOT NULL, 
	duration_days INTEGER NOT NULL, 
	max_uses INTEGER, 
	uses_count INTEGER, 
	is_active BOOLEAN, 
	created_at DATETIME, 
	expires_at DATETIME, 
	PRIMARY KEY (id)
)


2025-03-20 18:50:09,491 - sqlalchemy.engine.Engine - INFO - [no key 0.00047s] ()
2025-03-20 18:50:09,495 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_promo_codes_id ON promo_codes (id)
2025-03-20 18:50:09,495 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2025-03-20 18:50:09,498 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_promo_codes_code ON promo_codes (code)
2025-03-20 18:50:09,498 - sqlalchemy.engine.Engine - INFO - [no key 0.00062s] ()
2025-03-20 18:50:09,500 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE achievements (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	name VARCHAR NOT NULL, 
	description VARCHAR NOT NULL, 
	icon VARCHAR, 
	is_purchasable BOOLEAN, 
	price INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE ("key")
)


2025-03-20 18:50:09,501 - sqlalchemy.engine.Engine - INFO - [no key 0.00038s] ()
2025-03-20 18:50:09,503 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_achievements_id ON achievements (id)
2025-03-20 18:50:09,504 - sqlalchemy.engine.Engine - INFO - [no key 0.00061s] ()
2025-03-20 18:50:09,507 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE bot_settings (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	value VARCHAR, 
	updated_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE ("key")
)


2025-03-20 18:50:09,507 - sqlalchemy.engine.Engine - INFO - [no key 0.00034s] ()
2025-03-20 18:50:09,510 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE announcements (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	announcement_type VARCHAR(4) NOT NULL, 
	image_id VARCHAR NOT NULL, 
	media_id VARCHAR, 
	media_type VARCHAR, 
	description TEXT NOT NULL, 
	keyword VARCHAR, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-03-20 18:50:09,510 - sqlalchemy.engine.Engine - INFO - [no key 0.00046s] ()
2025-03-20 18:50:09,513 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_announcements_id ON announcements (id)
2025-03-20 18:50:09,514 - sqlalchemy.engine.Engine - INFO - [no key 0.00075s] ()
2025-03-20 18:50:09,516 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE crystal_transactions (
	id INTEGER NOT NULL, 
	sender_id INTEGER, 
	receiver_id INTEGER, 
	amount INTEGER NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(sender_id) REFERENCES users (id), 
	FOREIGN KEY(receiver_id) REFERENCES users (id)
)


2025-03-20 18:50:09,516 - sqlalchemy.engine.Engine - INFO - [no key 0.00036s] ()
2025-03-20 18:50:09,519 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_crystal_transactions_id ON crystal_transactions (id)
2025-03-20 18:50:09,519 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2025-03-20 18:50:09,521 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_sponsor_subscriptions (
	id INTEGER NOT NULL, 
	user_tg_id INTEGER NOT NULL, 
	sponsor_id INTEGER NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_tg_id) REFERENCES users (tg_id), 
	FOREIGN KEY(sponsor_id) REFERENCES sponsors (id)
)


2025-03-20 18:50:09,522 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2025-03-20 18:50:09,524 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE promo_uses (
	id INTEGER NOT NULL, 
	promo_id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	used_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(promo_id) REFERENCES promo_codes (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-03-20 18:50:09,526 - sqlalchemy.engine.Engine - INFO - [no key 0.00053s] ()
2025-03-20 18:50:09,528 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_promo_uses_id ON promo_uses (id)
2025-03-20 18:50:09,528 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2025-03-20 18:50:09,531 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_achievements (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	achievement_id INTEGER NOT NULL, 
	achieved_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id), 
	FOREIGN KEY(achievement_id) REFERENCES achievements (id)
)


2025-03-20 18:50:09,532 - sqlalchemy.engine.Engine - INFO - [no key 0.00056s] ()
2025-03-20 18:50:09,535 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_user_achievements_id ON user_achievements (id)
2025-03-20 18:50:09,535 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2025-03-20 18:50:09,538 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_visited_sections (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	section VARCHAR NOT NULL, 
	visited_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-03-20 18:50:09,539 - sqlalchemy.engine.Engine - INFO - [no key 0.00055s] ()
2025-03-20 18:50:09,542 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_user_visited_sections_id ON user_visited_sections (id)
2025-03-20 18:50:09,542 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2025-03-20 18:50:09,547 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_secret_purchases (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	content_key VARCHAR NOT NULL, 
	purchased_at DATETIME, 
	price INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-03-20 18:50:09,547 - sqlalchemy.engine.Engine - INFO - [no key 0.00046s] ()
2025-03-20 18:50:09,550 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_user_secret_purchases_id ON user_secret_purchases (id)
2025-03-20 18:50:09,550 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2025-03-20 18:50:09,553 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE reports (
	id INTEGER NOT NULL, 
	reporter_id INTEGER, 
	announcement_id INTEGER, 
	reason VARCHAR NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(reporter_id) REFERENCES users (id), 
	FOREIGN KEY(announcement_id) REFERENCES announcements (id)
)


2025-03-20 18:50:09,554 - sqlalchemy.engine.Engine - INFO - [no key 0.00117s] ()
2025-03-20 18:50:09,558 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_reports_id ON reports (id)
2025-03-20 18:50:09,558 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2025-03-20 18:50:09,562 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE favorites (
	id INTEGER NOT NULL, 
	user_id INTEGER, 
	announcement_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id), 
	FOREIGN KEY(announcement_id) REFERENCES announcements (id)
)


2025-03-20 18:50:09,563 - sqlalchemy.engine.Engine - INFO - [no key 0.00054s] ()
2025-03-20 18:50:09,565 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_favorites_id ON favorites (id)
2025-03-20 18:50:09,565 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2025-03-20 18:50:09,567 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:50:09,585 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:09,589 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:09,589 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] (30, 1, 0)
2025-03-20 18:50:09,591 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:09,591 - sqlalchemy.engine.Engine - INFO - [cached since 0.001681s ago] (180, 1, 0)
2025-03-20 18:50:09,592 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:09,592 - sqlalchemy.engine.Engine - INFO - [cached since 0.002655s ago] (365, 1, 0)
2025-03-20 18:50:09,593 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:09,593 - sqlalchemy.engine.Engine - INFO - [cached since 0.003537s ago] (36500, 1, 0)
2025-03-20 18:50:09,596 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-20 18:50:09,597 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s (insertmanyvalues) 1/4 (ordered; batch not supported)] (30, 500.0, '2025-03-20 16:50:09.596634', '2025-03-20 16:50:09.596634')
2025-03-20 18:50:09,598 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-20 18:50:09,598 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 2/4 (ordered; batch not supported)] (180, 2500.0, '2025-03-20 16:50:09.596634', '2025-03-20 16:50:09.596634')
2025-03-20 18:50:09,599 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-20 18:50:09,599 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 3/4 (ordered; batch not supported)] (365, 4500.0, '2025-03-20 16:50:09.596634', '2025-03-20 16:50:09.596634')
2025-03-20 18:50:09,599 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-20 18:50:09,599 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 4/4 (ordered; batch not supported)] (36500, 9900.0, '2025-03-20 16:50:09.596634', '2025-03-20 16:50:09.596634')
2025-03-20 18:50:09,600 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:50:09,618 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:09,623 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements) AS anon_1
2025-03-20 18:50:09,623 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] ()
2025-03-20 18:50:09,625 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-03-20 18:50:09,625 - sqlalchemy.engine.Engine - INFO - [generated in 0.00037s] ('major', 'Мажор', 'Доказательство вашей финансовой состоятельности', '💰', 1, 10000, '2025-03-20 16:50:09.625203')
2025-03-20 18:50:09,626 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:50:09,626 - sqlalchemy.engine.Engine - INFO - [generated in 0.00015s (insertmanyvalues) 1/9 (ordered; batch not supported)] ('popular', 'Популярный', 'Добавить объявление по поиску команды', '👥', 0, 0, '2025-03-20 16:50:09.626545')
2025-03-20 18:50:09,627 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:50:09,627 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 2/9 (ordered; batch not supported)] ('club_fighter', 'Бойцовский клуб', 'Добавить объявление по поиску клуба', '🥊', 0, 0, '2025-03-20 16:50:09.626545')
2025-03-20 18:50:09,628 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:50:09,628 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 3/9 (ordered; batch not supported)] ('explorer', 'Искатель', 'Посетить все разделы бота', '🔍', 0, 0, '2025-03-20 16:50:09.626545')
2025-03-20 18:50:09,628 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:50:09,628 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 4/9 (ordered; batch not supported)] ('legend', 'Легенда', 'Купить премиум статус', '⭐', 0, 0, '2025-03-20 16:50:09.626545')
2025-03-20 18:50:09,629 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:50:09,629 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 5/9 (ordered; batch not supported)] ('leprechaun', 'Лепрекон', 'Накопить 15,000 монет в балансе', '🍀', 0, 0, '2025-03-20 16:50:09.626545')
2025-03-20 18:50:09,629 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:50:09,629 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 6/9 (ordered; batch not supported)] ('lucky', 'Испытать удачу', 'Принять участие в розыгрыше монет', '🎁', 0, 0, '2025-03-20 16:50:09.626545')
2025-03-20 18:50:09,630 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:50:09,631 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 7/9 (ordered; batch not supported)] ('business', 'Бизнес-мачо', 'Пригласить человека по реферальной ссылке', '💼', 0, 0, '2025-03-20 16:50:09.626545')
2025-03-20 18:50:09,631 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:50:09,631 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 8/9 (ordered; batch not supported)] ('follow_me', 'Делай как я', 'Пригласить 10 человек по реферальной ссылке', '👑', 0, 0, '2025-03-20 16:50:09.626545')
2025-03-20 18:50:09,632 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:50:09,632 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 9/9 (ordered; batch not supported)] ('friend', 'Настоящий друг', 'Пригласить 25 человек по реферальной ссылке', '❤️', 0, 0, '2025-03-20 16:50:09.626545')
2025-03-20 18:50:09,633 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:50:09,639 - root - INFO - Achievements handlers registered successfully
2025-03-20 18:50:09,771 - aiogram - INFO - Bot: Бубсер Поиск Бот [@Bubser_PoiskBot]
2025-03-20 18:50:09,853 - aiogram - WARNING - Updates were skipped successfully.
2025-03-20 18:50:09,853 - __main__ - INFO - Бот успешно запущен!
2025-03-20 18:50:09,854 - aiogram.dispatcher.dispatcher - INFO - Start polling.
2025-03-20 18:50:14,550 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:14,552 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:14,553 - sqlalchemy.engine.Engine - INFO - [generated in 0.00117s] (7139312538, 1, 0)
2025-03-20 18:50:14,556 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:14,557 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:14,558 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:14,558 - sqlalchemy.engine.Engine - INFO - [cached since 0.005558s ago] (7139312538, 1, 0)
2025-03-20 18:50:14,559 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:14,559 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:14,561 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:14,561 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] (7139312538, 1, 0)
2025-03-20 18:50:14,561 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:14,563 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:14,563 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:14,563 - sqlalchemy.engine.Engine - INFO - [cached since 0.002714s ago] (7139312538, 1, 0)
2025-03-20 18:50:14,564 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:16,293 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:16,293 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:16,293 - sqlalchemy.engine.Engine - INFO - [cached since 1.742s ago] (7139312538, 1, 0)
2025-03-20 18:50:16,295 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:16,298 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:16,299 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:16,299 - sqlalchemy.engine.Engine - INFO - [cached since 1.747s ago] (7139312538, 1, 0)
2025-03-20 18:50:16,300 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:16,301 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:16,301 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:16,302 - sqlalchemy.engine.Engine - INFO - [cached since 1.741s ago] (7139312538, 1, 0)
2025-03-20 18:50:16,305 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:16,353 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:16,354 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:16,354 - sqlalchemy.engine.Engine - INFO - [cached since 1.794s ago] (7139312538, 1, 0)
2025-03-20 18:50:16,357 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:16,410 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:16,411 - sqlalchemy.engine.Engine - INFO - SELECT sponsors.id AS sponsors_id, sponsors.name AS sponsors_name, sponsors.link AS sponsors_link, sponsors.channel_id AS sponsors_channel_id, sponsors.reward AS sponsors_reward, sponsors.is_active AS sponsors_is_active, sponsors.created_at AS sponsors_created_at, sponsors.updated_at AS sponsors_updated_at 
FROM sponsors
2025-03-20 18:50:16,412 - sqlalchemy.engine.Engine - INFO - [generated in 0.00037s] ()
2025-03-20 18:50:16,413 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:17,142 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:17,142 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:17,143 - sqlalchemy.engine.Engine - INFO - [cached since 2.591s ago] (7139312538, 1, 0)
2025-03-20 18:50:17,145 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:17,146 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:17,147 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:17,147 - sqlalchemy.engine.Engine - INFO - [cached since 2.595s ago] (7139312538, 1, 0)
2025-03-20 18:50:17,150 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:17,151 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:17,151 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:17,152 - sqlalchemy.engine.Engine - INFO - [cached since 2.591s ago] (7139312538, 1, 0)
2025-03-20 18:50:17,153 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:24,048 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:24,049 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:24,050 - sqlalchemy.engine.Engine - INFO - [cached since 9.498s ago] (7139312538, 1, 0)
2025-03-20 18:50:24,051 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:24,052 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:24,053 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:24,054 - sqlalchemy.engine.Engine - INFO - [cached since 9.502s ago] (7139312538, 1, 0)
2025-03-20 18:50:24,054 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:24,054 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:24,056 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:24,056 - sqlalchemy.engine.Engine - INFO - [cached since 9.495s ago] (7139312538, 1, 0)
2025-03-20 18:50:24,056 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:24,057 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:24,057 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:24,057 - sqlalchemy.engine.Engine - INFO - [cached since 9.497s ago] (7139312538, 1, 0)
2025-03-20 18:50:24,058 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:25,206 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:25,206 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:25,206 - sqlalchemy.engine.Engine - INFO - [cached since 10.65s ago] (7139312538, 1, 0)
2025-03-20 18:50:25,209 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:25,210 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:25,211 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:25,211 - sqlalchemy.engine.Engine - INFO - [cached since 10.66s ago] (7139312538, 1, 0)
2025-03-20 18:50:25,212 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:25,213 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:25,213 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:25,214 - sqlalchemy.engine.Engine - INFO - [cached since 10.65s ago] (7139312538, 1, 0)
2025-03-20 18:50:25,214 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:25,215 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:25,215 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:25,215 - sqlalchemy.engine.Engine - INFO - [cached since 10.65s ago] (7139312538, 1, 0)
2025-03-20 18:50:25,216 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:30,311 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:30,311 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:30,311 - sqlalchemy.engine.Engine - INFO - [cached since 15.76s ago] (7139312538, 1, 0)
2025-03-20 18:50:30,312 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:30,314 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:30,315 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:30,315 - sqlalchemy.engine.Engine - INFO - [cached since 15.76s ago] (7139312538, 1, 0)
2025-03-20 18:50:30,316 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:30,317 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:30,317 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:30,317 - sqlalchemy.engine.Engine - INFO - [cached since 15.76s ago] (7139312538, 1, 0)
2025-03-20 18:50:30,318 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:30,318 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:30,318 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:30,319 - sqlalchemy.engine.Engine - INFO - [cached since 15.76s ago] (7139312538, 1, 0)
2025-03-20 18:50:30,320 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:31,765 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:31,765 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:31,765 - sqlalchemy.engine.Engine - INFO - [cached since 17.21s ago] (7139312538, 1, 0)
2025-03-20 18:50:31,766 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:31,767 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:31,768 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:31,769 - sqlalchemy.engine.Engine - INFO - [cached since 17.22s ago] (7139312538, 1, 0)
2025-03-20 18:50:31,769 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:31,769 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:31,769 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:31,770 - sqlalchemy.engine.Engine - INFO - [cached since 17.21s ago] (7139312538, 1, 0)
2025-03-20 18:50:31,770 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:31,770 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:31,771 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:31,771 - sqlalchemy.engine.Engine - INFO - [cached since 17.21s ago] (7139312538, 1, 0)
2025-03-20 18:50:31,771 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:31,772 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:31,773 - sqlalchemy.engine.Engine - INFO - INSERT INTO sponsors (name, link, channel_id, reward, is_active, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-03-20 18:50:31,773 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] ('test', 'https://t.me/obrientest1', '-1002294041672', 10, 1, '2025-03-20 16:50:31.773751', '2025-03-20 16:50:31.773751')
2025-03-20 18:50:31,776 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:50:31,877 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:31,878 - sqlalchemy.engine.Engine - INFO - SELECT sponsors.id AS sponsors_id, sponsors.name AS sponsors_name, sponsors.link AS sponsors_link, sponsors.channel_id AS sponsors_channel_id, sponsors.reward AS sponsors_reward, sponsors.is_active AS sponsors_is_active, sponsors.created_at AS sponsors_created_at, sponsors.updated_at AS sponsors_updated_at 
FROM sponsors
2025-03-20 18:50:31,878 - sqlalchemy.engine.Engine - INFO - [cached since 15.47s ago] ()
2025-03-20 18:50:31,880 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:34,192 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:34,192 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:34,192 - sqlalchemy.engine.Engine - INFO - [cached since 19.64s ago] (7139312538, 1, 0)
2025-03-20 18:50:34,193 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:34,193 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:34,195 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:34,195 - sqlalchemy.engine.Engine - INFO - [cached since 19.64s ago] (7139312538, 1, 0)
2025-03-20 18:50:34,196 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:34,197 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:34,197 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:34,198 - sqlalchemy.engine.Engine - INFO - [cached since 19.64s ago] (7139312538, 1, 0)
2025-03-20 18:50:34,199 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:34,199 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:34,200 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:34,200 - sqlalchemy.engine.Engine - INFO - [cached since 19.64s ago] (7139312538, 1, 0)
2025-03-20 18:50:34,201 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:34,201 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:34,201 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:34,202 - sqlalchemy.engine.Engine - INFO - [cached since 19.64s ago] (7139312538, 1, 0)
2025-03-20 18:50:34,202 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:34,202 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:34,203 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:34,203 - sqlalchemy.engine.Engine - INFO - [cached since 19.64s ago] (7139312538, 1, 0)
2025-03-20 18:50:34,203 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:34,203 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:34,203 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:34,203 - sqlalchemy.engine.Engine - INFO - [cached since 19.64s ago] (7139312538, 1, 0)
2025-03-20 18:50:34,205 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (tg_id, username, first_name, is_premium, premium_end_date, crystals, language, blocked, last_gift, created_at, updated_at, coins, premium_until) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-03-20 18:50:34,205 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] (7139312538, 'nowoyaz', "O'Brien", 0, None, 100, 'ru', 0, None, '2025-03-20 18:50:34.204951', '2025-03-20 16:50:34.205989', 0, None)
2025-03-20 18:50:34,210 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:50:35,164 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:35,164 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:35,166 - sqlalchemy.engine.Engine - INFO - [cached since 20.61s ago] (7139312538, 1, 0)
2025-03-20 18:50:35,167 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:35,168 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:35,168 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:35,169 - sqlalchemy.engine.Engine - INFO - [cached since 20.62s ago] (7139312538, 1, 0)
2025-03-20 18:50:35,169 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:35,171 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:35,171 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:35,171 - sqlalchemy.engine.Engine - INFO - [cached since 20.61s ago] (7139312538, 1, 0)
2025-03-20 18:50:35,172 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:35,843 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:35,844 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:35,844 - sqlalchemy.engine.Engine - INFO - [cached since 21.29s ago] (7139312538, 1, 0)
2025-03-20 18:50:35,847 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:35,849 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:35,850 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:35,851 - sqlalchemy.engine.Engine - INFO - [cached since 21.3s ago] (7139312538, 1, 0)
2025-03-20 18:50:35,852 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:35,853 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:35,853 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:35,855 - sqlalchemy.engine.Engine - INFO - [cached since 21.29s ago] (7139312538, 1, 0)
2025-03-20 18:50:35,856 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:35,935 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:35,936 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:35,938 - sqlalchemy.engine.Engine - INFO - [cached since 21.38s ago] (7139312538, 1, 0)
2025-03-20 18:50:35,940 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:35,942 - sqlalchemy.engine.Engine - INFO - [generated in 0.00181s] (1, 'gift', 1, 0)
2025-03-20 18:50:35,945 - sqlalchemy.engine.Engine - INFO - INSERT INTO user_visited_sections (user_id, section, visited_at) VALUES (?, ?, ?)
2025-03-20 18:50:35,946 - sqlalchemy.engine.Engine - INFO - [generated in 0.00137s] (1, 'gift', '2025-03-20 16:50:35.945620')
2025-03-20 18:50:35,951 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:50:35,956 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:35,959 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
2025-03-20 18:50:35,960 - sqlalchemy.engine.Engine - INFO - [generated in 0.00148s] (1,)
2025-03-20 18:50:35,965 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.section AS user_visited_sections_section 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section IN (?, ?, ?, ?, ?, ?)
2025-03-20 18:50:35,965 - sqlalchemy.engine.Engine - INFO - [generated in 0.00087s] (1, 'search_team_menu', 'search_club_menu', 'crystals', 'premium', 'additional', 'gift')
2025-03-20 18:50:35,966 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:36,528 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:36,529 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:36,529 - sqlalchemy.engine.Engine - INFO - [cached since 21.98s ago] (7139312538, 1, 0)
2025-03-20 18:50:36,530 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:36,531 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:36,532 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:36,533 - sqlalchemy.engine.Engine - INFO - [cached since 21.98s ago] (7139312538, 1, 0)
2025-03-20 18:50:36,533 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:36,533 - handlers.gift - INFO - Пользователь 7139312538 запросил подарок
2025-03-20 18:50:36,535 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:36,535 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:36,535 - sqlalchemy.engine.Engine - INFO - [cached since 21.97s ago] (7139312538, 1, 0)
2025-03-20 18:50:36,536 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:36,622 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:36,623 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:36,624 - sqlalchemy.engine.Engine - INFO - [cached since 22.06s ago] (7139312538, 1, 0)
2025-03-20 18:50:36,626 - handlers.gift - INFO - Пользователь 7139312538 премиум: <coroutine object is_user_premium at 0x000001D69B908310>
2025-03-20 18:50:36,628 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:36,630 - sqlalchemy.engine.Engine - INFO - SELECT sponsors.id AS sponsors_id, sponsors.name AS sponsors_name, sponsors.link AS sponsors_link, sponsors.channel_id AS sponsors_channel_id, sponsors.reward AS sponsors_reward, sponsors.is_active AS sponsors_is_active, sponsors.created_at AS sponsors_created_at, sponsors.updated_at AS sponsors_updated_at 
FROM sponsors 
WHERE sponsors.is_active = 1
2025-03-20 18:50:36,630 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ()
2025-03-20 18:50:36,631 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:36,631 - handlers.gift - INFO - Найдено активных спонсоров: 1
2025-03-20 18:50:36,631 - handlers.gift - INFO - Выдача подарка пользователю 7139312538: 32 монет
2025-03-20 18:50:36,632 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:36,633 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:36,633 - sqlalchemy.engine.Engine - INFO - [cached since 22.07s ago] (7139312538, 1, 0)
2025-03-20 18:50:36,637 - sqlalchemy.engine.Engine - INFO - UPDATE users SET last_gift=?, updated_at=? WHERE users.id = ?
2025-03-20 18:50:36,637 - sqlalchemy.engine.Engine - INFO - [generated in 0.00109s] ('2025-03-20 18:50:36.633796', '2025-03-20 16:50:36.637401', 1)
2025-03-20 18:50:36,641 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:50:36,644 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:36,645 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:36,645 - sqlalchemy.engine.Engine - INFO - [cached since 22.08s ago] (7139312538, 1, 0)
2025-03-20 18:50:36,649 - sqlalchemy.engine.Engine - INFO - UPDATE users SET updated_at=?, coins=? WHERE users.id = ?
2025-03-20 18:50:36,650 - sqlalchemy.engine.Engine - INFO - [generated in 0.00101s] ('2025-03-20 16:50:36.649454', 32, 1)
2025-03-20 18:50:36,652 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:50:36,656 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:36,657 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:36,657 - sqlalchemy.engine.Engine - INFO - [cached since 22.1s ago] (7139312538, 1, 0)
2025-03-20 18:50:36,660 - sqlalchemy.engine.Engine - INFO - SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements 
WHERE achievements."key" = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:36,661 - sqlalchemy.engine.Engine - INFO - [generated in 0.00063s] ('lucky', 1, 0)
2025-03-20 18:50:36,665 - sqlalchemy.engine.Engine - INFO - SELECT user_achievements.id AS user_achievements_id, user_achievements.user_id AS user_achievements_user_id, user_achievements.achievement_id AS user_achievements_achievement_id, user_achievements.achieved_at AS user_achievements_achieved_at 
FROM user_achievements 
WHERE user_achievements.user_id = ? AND user_achievements.achievement_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:36,666 - sqlalchemy.engine.Engine - INFO - [generated in 0.00069s] (1, 7, 1, 0)
2025-03-20 18:50:36,668 - sqlalchemy.engine.Engine - INFO - INSERT INTO user_achievements (user_id, achievement_id, achieved_at) VALUES (?, ?, ?)
2025-03-20 18:50:36,669 - sqlalchemy.engine.Engine - INFO - [generated in 0.00148s] (1, 7, '2025-03-20 16:50:36.668349')
2025-03-20 18:50:36,672 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:50:36,779 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:47,473 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:47,473 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:47,474 - sqlalchemy.engine.Engine - INFO - [cached since 32.92s ago] (8053357241, 1, 0)
2025-03-20 18:50:47,474 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:47,475 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:47,475 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:47,475 - sqlalchemy.engine.Engine - INFO - [cached since 32.92s ago] (8053357241, 1, 0)
2025-03-20 18:50:47,477 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:47,478 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:47,479 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:47,479 - sqlalchemy.engine.Engine - INFO - [cached since 32.92s ago] (8053357241, 1, 0)
2025-03-20 18:50:47,480 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:47,615 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:47,615 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:47,617 - sqlalchemy.engine.Engine - INFO - [cached since 33.06s ago] (8053357241, 1, 0)
2025-03-20 18:50:47,619 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:48,474 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:48,474 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:48,474 - sqlalchemy.engine.Engine - INFO - [cached since 33.92s ago] (8053357241, 1, 0)
2025-03-20 18:50:48,475 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:48,478 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:48,478 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:48,479 - sqlalchemy.engine.Engine - INFO - [cached since 33.93s ago] (8053357241, 1, 0)
2025-03-20 18:50:48,479 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:50:48,480 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:50:48,480 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:50:48,480 - sqlalchemy.engine.Engine - INFO - [cached since 33.92s ago] (8053357241, 1, 0)
2025-03-20 18:50:48,481 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:51:13,667 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:51:13,668 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:51:13,669 - sqlalchemy.engine.Engine - INFO - [cached since 59.12s ago] (8053357241, 1, 0)
2025-03-20 18:51:13,670 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:51:13,673 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:51:13,673 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:51:13,673 - sqlalchemy.engine.Engine - INFO - [cached since 59.12s ago] (8053357241, 1, 0)
2025-03-20 18:51:13,675 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:51:13,676 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:51:13,677 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:51:13,677 - sqlalchemy.engine.Engine - INFO - [cached since 59.12s ago] (8053357241, 1, 0)
2025-03-20 18:51:13,678 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:51:13,725 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:51:13,725 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:51:13,725 - sqlalchemy.engine.Engine - INFO - [cached since 59.17s ago] (8053357241, 1, 0)
2025-03-20 18:51:13,727 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (tg_id, username, first_name, is_premium, premium_end_date, crystals, language, blocked, last_gift, created_at, updated_at, coins, premium_until) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-03-20 18:51:13,727 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] (8053357241, 'maksmaksimov12', None, 0, None, 0, 'ru', 0, None, '2025-03-20 16:51:13.727848', '2025-03-20 16:51:13.727848', 0, None)
2025-03-20 18:51:13,730 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:51:13,733 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:51:13,733 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
2025-03-20 18:51:13,733 - sqlalchemy.engine.Engine - INFO - [cached since 37.78s ago] (2,)
2025-03-20 18:51:13,735 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:51:13,735 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:51:13,736 - sqlalchemy.engine.Engine - INFO - [cached since 59.18s ago] (8053357241, 1, 0)
2025-03-20 18:51:13,739 - sqlalchemy.engine.Engine - INFO - SELECT user_achievements.id AS user_achievements_id, user_achievements.user_id AS user_achievements_user_id, user_achievements.achievement_id AS user_achievements_achievement_id, user_achievements.achieved_at AS user_achievements_achieved_at, achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM user_achievements JOIN achievements ON user_achievements.achievement_id = achievements.id 
WHERE user_achievements.user_id = ?
2025-03-20 18:51:13,739 - sqlalchemy.engine.Engine - INFO - [generated in 0.00056s] (2,)
2025-03-20 18:51:13,740 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:51:13,740 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:53:50,142 - aiogram.dispatcher.dispatcher - INFO - Stop polling...
2025-03-20 18:53:50,143 - aiogram - WARNING - Goodbye!
2025-03-20 18:53:51,479 - __main__ - INFO - Запуск бота...
2025-03-20 18:53:51,736 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:53:51,737 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-03-20 18:53:51,737 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:53:51,738 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referrals")
2025-03-20 18:53:51,739 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:53:51,739 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("announcements")
2025-03-20 18:53:51,739 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:53:51,740 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("reports")
2025-03-20 18:53:51,740 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:53:51,740 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("favorites")
2025-03-20 18:53:51,741 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:53:51,741 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("crystal_transactions")
2025-03-20 18:53:51,741 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:53:51,742 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("premium_prices")
2025-03-20 18:53:51,742 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:53:51,742 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sponsors")
2025-03-20 18:53:51,742 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:53:51,743 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_sponsor_subscriptions")
2025-03-20 18:53:51,743 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:53:51,743 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_codes")
2025-03-20 18:53:51,743 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:53:51,743 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_uses")
2025-03-20 18:53:51,743 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:53:51,743 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-03-20 18:53:51,743 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:53:51,745 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_achievements")
2025-03-20 18:53:51,745 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:53:51,745 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_visited_sections")
2025-03-20 18:53:51,745 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:53:51,745 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_secret_purchases")
2025-03-20 18:53:51,746 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:53:51,746 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("bot_settings")
2025-03-20 18:53:51,746 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:53:51,747 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:53:51,765 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:53:51,771 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:53:51,772 - sqlalchemy.engine.Engine - INFO - [generated in 0.00151s] (30, 1, 0)
2025-03-20 18:53:51,773 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:53:51,773 - sqlalchemy.engine.Engine - INFO - [cached since 0.00317s ago] (180, 1, 0)
2025-03-20 18:53:51,773 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:53:51,773 - sqlalchemy.engine.Engine - INFO - [cached since 0.004136s ago] (365, 1, 0)
2025-03-20 18:53:51,775 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:53:51,775 - sqlalchemy.engine.Engine - INFO - [cached since 0.005134s ago] (36500, 1, 0)
2025-03-20 18:53:51,776 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:53:51,793 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:53:51,797 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements) AS anon_1
2025-03-20 18:53:51,798 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] ()
2025-03-20 18:53:51,799 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:53:51,800 - root - INFO - Achievements handlers registered successfully
2025-03-20 18:53:51,932 - aiogram - INFO - Bot: Бубсер Поиск Бот [@Bubser_PoiskBot]
2025-03-20 18:53:52,018 - aiogram - WARNING - Updates were skipped successfully.
2025-03-20 18:53:52,018 - __main__ - INFO - Бот успешно запущен!
2025-03-20 18:53:52,019 - aiogram - WARNING - Goodbye!
2025-03-20 18:54:41,899 - __main__ - INFO - Запуск бота...
2025-03-20 18:54:42,148 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:42,149 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-03-20 18:54:42,149 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:54:42,151 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referrals")
2025-03-20 18:54:42,151 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:54:42,151 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("announcements")
2025-03-20 18:54:42,152 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:54:42,152 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("reports")
2025-03-20 18:54:42,152 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:54:42,153 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("favorites")
2025-03-20 18:54:42,153 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:54:42,153 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("crystal_transactions")
2025-03-20 18:54:42,153 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:54:42,155 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("premium_prices")
2025-03-20 18:54:42,155 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:54:42,155 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sponsors")
2025-03-20 18:54:42,156 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:54:42,156 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_sponsor_subscriptions")
2025-03-20 18:54:42,156 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:54:42,156 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_codes")
2025-03-20 18:54:42,156 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:54:42,157 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_uses")
2025-03-20 18:54:42,157 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:54:42,157 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-03-20 18:54:42,157 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:54:42,157 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_achievements")
2025-03-20 18:54:42,158 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:54:42,158 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_visited_sections")
2025-03-20 18:54:42,158 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:54:42,158 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_secret_purchases")
2025-03-20 18:54:42,158 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:54:42,159 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("bot_settings")
2025-03-20 18:54:42,159 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:54:42,159 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:54:42,176 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:42,179 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:42,179 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] (30, 1, 0)
2025-03-20 18:54:42,180 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:42,181 - sqlalchemy.engine.Engine - INFO - [cached since 0.00163s ago] (180, 1, 0)
2025-03-20 18:54:42,181 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:42,181 - sqlalchemy.engine.Engine - INFO - [cached since 0.002452s ago] (365, 1, 0)
2025-03-20 18:54:42,182 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:42,182 - sqlalchemy.engine.Engine - INFO - [cached since 0.003478s ago] (36500, 1, 0)
2025-03-20 18:54:42,183 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:54:42,193 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:42,198 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements) AS anon_1
2025-03-20 18:54:42,198 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ()
2025-03-20 18:54:42,199 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:42,201 - root - INFO - Achievements handlers registered successfully
2025-03-20 18:54:42,328 - aiogram - INFO - Bot: Бубсер Поиск Бот [@Bubser_PoiskBot]
2025-03-20 18:54:42,407 - aiogram - WARNING - Updates were skipped successfully.
2025-03-20 18:54:42,407 - __main__ - INFO - Бот успешно запущен!
2025-03-20 18:54:42,407 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:42,410 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.tg_id, users.username, users.first_name, users.is_premium, users.premium_end_date, users.crystals, users.language, users.blocked, users.last_gift, users.created_at, users.updated_at, users.coins, users.premium_until 
FROM users 
WHERE users.is_premium = 1 AND users.premium_end_date <= ?
2025-03-20 18:54:42,410 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ('2025-03-20 18:54:42.407784',)
2025-03-20 18:54:42,412 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:54:42,413 - aiogram.dispatcher.dispatcher - INFO - Start polling.
2025-03-20 18:54:47,666 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:47,668 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:47,669 - sqlalchemy.engine.Engine - INFO - [generated in 0.00084s] (7139312538, 1, 0)
2025-03-20 18:54:47,669 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:47,671 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:47,672 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:47,672 - sqlalchemy.engine.Engine - INFO - [cached since 0.004457s ago] (7139312538, 1, 0)
2025-03-20 18:54:47,673 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:47,673 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:47,674 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:47,674 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] (7139312538, 1, 0)
2025-03-20 18:54:47,675 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:47,676 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:47,676 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:47,676 - sqlalchemy.engine.Engine - INFO - [cached since 0.002299s ago] (7139312538, 1, 0)
2025-03-20 18:54:47,678 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:47,679 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:47,680 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:47,680 - sqlalchemy.engine.Engine - INFO - [cached since 0.006215s ago] (7139312538, 1, 0)
2025-03-20 18:54:47,681 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:47,681 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:47,681 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:47,681 - sqlalchemy.engine.Engine - INFO - [cached since 0.007453s ago] (7139312538, 1, 0)
2025-03-20 18:54:47,682 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:49,637 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:49,639 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:49,639 - sqlalchemy.engine.Engine - INFO - [cached since 1.971s ago] (7139312538, 1, 0)
2025-03-20 18:54:49,640 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:49,641 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:49,641 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:49,642 - sqlalchemy.engine.Engine - INFO - [cached since 1.974s ago] (7139312538, 1, 0)
2025-03-20 18:54:49,642 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:49,643 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:49,644 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:49,644 - sqlalchemy.engine.Engine - INFO - [cached since 1.97s ago] (7139312538, 1, 0)
2025-03-20 18:54:49,646 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:50,428 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:50,430 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:50,431 - sqlalchemy.engine.Engine - INFO - [cached since 2.763s ago] (7139312538, 1, 0)
2025-03-20 18:54:50,432 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:50,433 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:50,433 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:50,434 - sqlalchemy.engine.Engine - INFO - [cached since 2.765s ago] (7139312538, 1, 0)
2025-03-20 18:54:50,434 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:50,436 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:50,436 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:50,436 - sqlalchemy.engine.Engine - INFO - [cached since 2.762s ago] (7139312538, 1, 0)
2025-03-20 18:54:50,438 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:50,485 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:50,485 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:50,486 - sqlalchemy.engine.Engine - INFO - [cached since 2.812s ago] (7139312538, 1, 0)
2025-03-20 18:54:50,488 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:50,489 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:50,489 - sqlalchemy.engine.Engine - INFO - [cached since 2.815s ago] (7139312538, 1, 0)
2025-03-20 18:54:50,493 - sqlalchemy.engine.Engine - INFO - SELECT user_achievements.id AS user_achievements_id, user_achievements.user_id AS user_achievements_user_id, user_achievements.achievement_id AS user_achievements_achievement_id, user_achievements.achieved_at AS user_achievements_achieved_at, achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM user_achievements JOIN achievements ON user_achievements.achievement_id = achievements.id 
WHERE user_achievements.user_id = ?
2025-03-20 18:54:50,494 - sqlalchemy.engine.Engine - INFO - [generated in 0.00128s] (1,)
2025-03-20 18:54:50,495 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:50,499 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:54,855 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:54,856 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:54,856 - sqlalchemy.engine.Engine - INFO - [cached since 7.188s ago] (7115599761, 1, 0)
2025-03-20 18:54:54,857 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:54,859 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:54,860 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:54,860 - sqlalchemy.engine.Engine - INFO - [cached since 7.192s ago] (7115599761, 1, 0)
2025-03-20 18:54:54,861 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:54,862 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:54,862 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:54,862 - sqlalchemy.engine.Engine - INFO - [cached since 7.188s ago] (7115599761, 1, 0)
2025-03-20 18:54:54,862 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:54,863 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:54,865 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:54,865 - sqlalchemy.engine.Engine - INFO - [cached since 7.191s ago] (7115599761, 1, 0)
2025-03-20 18:54:54,867 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:54,868 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:54,868 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:54,868 - sqlalchemy.engine.Engine - INFO - [cached since 7.194s ago] (7115599761, 1, 0)
2025-03-20 18:54:54,869 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:54,869 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:54,870 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:54,870 - sqlalchemy.engine.Engine - INFO - [cached since 7.196s ago] (7115599761, 1, 0)
2025-03-20 18:54:54,871 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:54,872 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:54,872 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:54,873 - sqlalchemy.engine.Engine - INFO - [cached since 7.199s ago] (7115599761, 1, 0)
2025-03-20 18:54:54,876 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (tg_id, username, first_name, is_premium, premium_end_date, crystals, language, blocked, last_gift, created_at, updated_at, coins, premium_until) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-03-20 18:54:54,876 - sqlalchemy.engine.Engine - INFO - [generated in 0.00069s] (7115599761, 'hhhsleep', 'zzzsleep', 0, None, 100, 'ru', 0, None, '2025-03-20 18:54:54.874297', '2025-03-20 16:54:54.876348', 0, None)
2025-03-20 18:54:54,879 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:54:55,904 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:55,905 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:55,905 - sqlalchemy.engine.Engine - INFO - [cached since 8.237s ago] (7115599761, 1, 0)
2025-03-20 18:54:55,906 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:55,907 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:55,907 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:55,908 - sqlalchemy.engine.Engine - INFO - [cached since 8.24s ago] (7115599761, 1, 0)
2025-03-20 18:54:55,909 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:55,910 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:55,910 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:55,910 - sqlalchemy.engine.Engine - INFO - [cached since 8.236s ago] (7115599761, 1, 0)
2025-03-20 18:54:55,911 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:56,938 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:56,938 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:56,939 - sqlalchemy.engine.Engine - INFO - [cached since 9.271s ago] (7115599761, 1, 0)
2025-03-20 18:54:56,939 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:56,942 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:56,942 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:56,942 - sqlalchemy.engine.Engine - INFO - [cached since 9.275s ago] (7115599761, 1, 0)
2025-03-20 18:54:56,943 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:56,945 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:56,946 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:56,946 - sqlalchemy.engine.Engine - INFO - [cached since 9.272s ago] (7115599761, 1, 0)
2025-03-20 18:54:56,948 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:57,056 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:57,056 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:57,056 - sqlalchemy.engine.Engine - INFO - [cached since 9.383s ago] (7115599761, 1, 0)
2025-03-20 18:54:57,058 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:54:57,059 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:54:57,059 - sqlalchemy.engine.Engine - INFO - [cached since 9.385s ago] (7115599761, 1, 0)
2025-03-20 18:54:57,060 - sqlalchemy.engine.Engine - INFO - SELECT user_achievements.id AS user_achievements_id, user_achievements.user_id AS user_achievements_user_id, user_achievements.achievement_id AS user_achievements_achievement_id, user_achievements.achieved_at AS user_achievements_achieved_at, achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM user_achievements JOIN achievements ON user_achievements.achievement_id = achievements.id 
WHERE user_achievements.user_id = ?
2025-03-20 18:54:57,060 - sqlalchemy.engine.Engine - INFO - [cached since 6.568s ago] (3,)
2025-03-20 18:54:57,061 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:54:57,061 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:55:07,309 - aiogram.dispatcher.dispatcher - INFO - Stop polling...
2025-03-20 18:55:07,310 - aiogram - WARNING - Goodbye!
2025-03-20 18:55:10,372 - __main__ - INFO - Запуск бота...
2025-03-20 18:55:10,615 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:55:10,616 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-03-20 18:55:10,616 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,617 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2025-03-20 18:55:10,617 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,617 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referrals")
2025-03-20 18:55:10,617 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,618 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referrals")
2025-03-20 18:55:10,618 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,618 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("announcements")
2025-03-20 18:55:10,618 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,618 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("announcements")
2025-03-20 18:55:10,618 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,619 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("reports")
2025-03-20 18:55:10,619 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,619 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("reports")
2025-03-20 18:55:10,619 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,619 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("favorites")
2025-03-20 18:55:10,620 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,620 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("favorites")
2025-03-20 18:55:10,620 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,620 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("crystal_transactions")
2025-03-20 18:55:10,620 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,621 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("crystal_transactions")
2025-03-20 18:55:10,621 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,621 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("premium_prices")
2025-03-20 18:55:10,621 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,622 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("premium_prices")
2025-03-20 18:55:10,622 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,622 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sponsors")
2025-03-20 18:55:10,622 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,622 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("sponsors")
2025-03-20 18:55:10,623 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,623 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_sponsor_subscriptions")
2025-03-20 18:55:10,623 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,623 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_sponsor_subscriptions")
2025-03-20 18:55:10,623 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,623 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_codes")
2025-03-20 18:55:10,623 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,623 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("promo_codes")
2025-03-20 18:55:10,623 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,623 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_uses")
2025-03-20 18:55:10,625 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,625 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("promo_uses")
2025-03-20 18:55:10,625 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,625 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-03-20 18:55:10,625 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,625 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("achievements")
2025-03-20 18:55:10,626 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,626 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_achievements")
2025-03-20 18:55:10,626 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,626 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_achievements")
2025-03-20 18:55:10,626 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,626 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_visited_sections")
2025-03-20 18:55:10,626 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,627 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_visited_sections")
2025-03-20 18:55:10,627 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,627 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_secret_purchases")
2025-03-20 18:55:10,627 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,627 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_secret_purchases")
2025-03-20 18:55:10,628 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,628 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("bot_settings")
2025-03-20 18:55:10,628 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,628 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("bot_settings")
2025-03-20 18:55:10,629 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:55:10,630 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	tg_id INTEGER NOT NULL, 
	username VARCHAR, 
	first_name VARCHAR, 
	is_premium BOOLEAN, 
	premium_end_date DATETIME, 
	crystals INTEGER, 
	language VARCHAR, 
	blocked BOOLEAN, 
	last_gift DATETIME, 
	created_at DATETIME, 
	updated_at DATETIME, 
	coins INTEGER, 
	premium_until DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE (tg_id)
)


2025-03-20 18:55:10,631 - sqlalchemy.engine.Engine - INFO - [no key 0.00042s] ()
2025-03-20 18:55:10,635 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_id ON users (id)
2025-03-20 18:55:10,635 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2025-03-20 18:55:10,639 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referrals (
	id INTEGER NOT NULL, 
	referrer_id INTEGER NOT NULL, 
	referred_id INTEGER NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE (referred_id)
)


2025-03-20 18:55:10,639 - sqlalchemy.engine.Engine - INFO - [no key 0.00034s] ()
2025-03-20 18:55:10,642 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_referrals_id ON referrals (id)
2025-03-20 18:55:10,642 - sqlalchemy.engine.Engine - INFO - [no key 0.00061s] ()
2025-03-20 18:55:10,647 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE premium_prices (
	id INTEGER NOT NULL, 
	duration_days INTEGER NOT NULL, 
	price FLOAT NOT NULL, 
	created_at DATETIME, 
	updated_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE (duration_days)
)


2025-03-20 18:55:10,648 - sqlalchemy.engine.Engine - INFO - [no key 0.00046s] ()
2025-03-20 18:55:10,651 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_premium_prices_id ON premium_prices (id)
2025-03-20 18:55:10,652 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2025-03-20 18:55:10,653 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE sponsors (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	link VARCHAR NOT NULL, 
	channel_id VARCHAR, 
	reward INTEGER, 
	is_active BOOLEAN, 
	created_at DATETIME, 
	updated_at DATETIME, 
	PRIMARY KEY (id)
)


2025-03-20 18:55:10,653 - sqlalchemy.engine.Engine - INFO - [no key 0.00035s] ()
2025-03-20 18:55:10,658 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_sponsors_id ON sponsors (id)
2025-03-20 18:55:10,659 - sqlalchemy.engine.Engine - INFO - [no key 0.00122s] ()
2025-03-20 18:55:10,661 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE promo_codes (
	id INTEGER NOT NULL, 
	code VARCHAR NOT NULL, 
	duration_days INTEGER NOT NULL, 
	max_uses INTEGER, 
	uses_count INTEGER, 
	is_active BOOLEAN, 
	created_at DATETIME, 
	expires_at DATETIME, 
	PRIMARY KEY (id)
)


2025-03-20 18:55:10,662 - sqlalchemy.engine.Engine - INFO - [no key 0.00052s] ()
2025-03-20 18:55:10,665 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_promo_codes_id ON promo_codes (id)
2025-03-20 18:55:10,665 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2025-03-20 18:55:10,667 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_promo_codes_code ON promo_codes (code)
2025-03-20 18:55:10,667 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2025-03-20 18:55:10,670 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE achievements (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	name VARCHAR NOT NULL, 
	description VARCHAR NOT NULL, 
	icon VARCHAR, 
	is_purchasable BOOLEAN, 
	price INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE ("key")
)


2025-03-20 18:55:10,670 - sqlalchemy.engine.Engine - INFO - [no key 0.00037s] ()
2025-03-20 18:55:10,672 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_achievements_id ON achievements (id)
2025-03-20 18:55:10,672 - sqlalchemy.engine.Engine - INFO - [no key 0.00019s] ()
2025-03-20 18:55:10,674 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE bot_settings (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	value VARCHAR, 
	updated_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE ("key")
)


2025-03-20 18:55:10,675 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2025-03-20 18:55:10,677 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE announcements (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	announcement_type VARCHAR(4) NOT NULL, 
	image_id VARCHAR NOT NULL, 
	media_id VARCHAR, 
	media_type VARCHAR, 
	description TEXT NOT NULL, 
	keyword VARCHAR, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-03-20 18:55:10,678 - sqlalchemy.engine.Engine - INFO - [no key 0.00044s] ()
2025-03-20 18:55:10,680 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_announcements_id ON announcements (id)
2025-03-20 18:55:10,680 - sqlalchemy.engine.Engine - INFO - [no key 0.00019s] ()
2025-03-20 18:55:10,682 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE crystal_transactions (
	id INTEGER NOT NULL, 
	sender_id INTEGER, 
	receiver_id INTEGER, 
	amount INTEGER NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(sender_id) REFERENCES users (id), 
	FOREIGN KEY(receiver_id) REFERENCES users (id)
)


2025-03-20 18:55:10,682 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2025-03-20 18:55:10,685 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_crystal_transactions_id ON crystal_transactions (id)
2025-03-20 18:55:10,686 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2025-03-20 18:55:10,688 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_sponsor_subscriptions (
	id INTEGER NOT NULL, 
	user_tg_id INTEGER NOT NULL, 
	sponsor_id INTEGER NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_tg_id) REFERENCES users (tg_id), 
	FOREIGN KEY(sponsor_id) REFERENCES sponsors (id)
)


2025-03-20 18:55:10,688 - sqlalchemy.engine.Engine - INFO - [no key 0.00033s] ()
2025-03-20 18:55:10,691 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE promo_uses (
	id INTEGER NOT NULL, 
	promo_id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	used_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(promo_id) REFERENCES promo_codes (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-03-20 18:55:10,691 - sqlalchemy.engine.Engine - INFO - [no key 0.00039s] ()
2025-03-20 18:55:10,694 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_promo_uses_id ON promo_uses (id)
2025-03-20 18:55:10,694 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2025-03-20 18:55:10,697 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_achievements (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	achievement_id INTEGER NOT NULL, 
	achieved_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id), 
	FOREIGN KEY(achievement_id) REFERENCES achievements (id)
)


2025-03-20 18:55:10,697 - sqlalchemy.engine.Engine - INFO - [no key 0.00040s] ()
2025-03-20 18:55:10,700 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_user_achievements_id ON user_achievements (id)
2025-03-20 18:55:10,701 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2025-03-20 18:55:10,703 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_visited_sections (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	section VARCHAR NOT NULL, 
	visited_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-03-20 18:55:10,703 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2025-03-20 18:55:10,706 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_user_visited_sections_id ON user_visited_sections (id)
2025-03-20 18:55:10,706 - sqlalchemy.engine.Engine - INFO - [no key 0.00041s] ()
2025-03-20 18:55:10,708 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_secret_purchases (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	content_key VARCHAR NOT NULL, 
	purchased_at DATETIME, 
	price INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-03-20 18:55:10,709 - sqlalchemy.engine.Engine - INFO - [no key 0.00035s] ()
2025-03-20 18:55:10,711 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_user_secret_purchases_id ON user_secret_purchases (id)
2025-03-20 18:55:10,711 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2025-03-20 18:55:10,715 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE reports (
	id INTEGER NOT NULL, 
	reporter_id INTEGER, 
	announcement_id INTEGER, 
	reason VARCHAR NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(reporter_id) REFERENCES users (id), 
	FOREIGN KEY(announcement_id) REFERENCES announcements (id)
)


2025-03-20 18:55:10,715 - sqlalchemy.engine.Engine - INFO - [no key 0.00036s] ()
2025-03-20 18:55:10,717 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_reports_id ON reports (id)
2025-03-20 18:55:10,717 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2025-03-20 18:55:10,720 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE favorites (
	id INTEGER NOT NULL, 
	user_id INTEGER, 
	announcement_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id), 
	FOREIGN KEY(announcement_id) REFERENCES announcements (id)
)


2025-03-20 18:55:10,720 - sqlalchemy.engine.Engine - INFO - [no key 0.00036s] ()
2025-03-20 18:55:10,723 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_favorites_id ON favorites (id)
2025-03-20 18:55:10,723 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2025-03-20 18:55:10,726 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:55:10,743 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:55:10,747 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:55:10,748 - sqlalchemy.engine.Engine - INFO - [generated in 0.00069s] (30, 1, 0)
2025-03-20 18:55:10,749 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:55:10,749 - sqlalchemy.engine.Engine - INFO - [cached since 0.002222s ago] (180, 1, 0)
2025-03-20 18:55:10,750 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:55:10,750 - sqlalchemy.engine.Engine - INFO - [cached since 0.003263s ago] (365, 1, 0)
2025-03-20 18:55:10,751 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:55:10,751 - sqlalchemy.engine.Engine - INFO - [cached since 0.004s ago] (36500, 1, 0)
2025-03-20 18:55:10,753 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-20 18:55:10,753 - sqlalchemy.engine.Engine - INFO - [generated in 0.00016s (insertmanyvalues) 1/4 (ordered; batch not supported)] (30, 500.0, '2025-03-20 16:55:10.752649', '2025-03-20 16:55:10.752649')
2025-03-20 18:55:10,755 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-20 18:55:10,755 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 2/4 (ordered; batch not supported)] (180, 2500.0, '2025-03-20 16:55:10.752649', '2025-03-20 16:55:10.752649')
2025-03-20 18:55:10,755 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-20 18:55:10,756 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 3/4 (ordered; batch not supported)] (365, 4500.0, '2025-03-20 16:55:10.752649', '2025-03-20 16:55:10.752649')
2025-03-20 18:55:10,756 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-20 18:55:10,756 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 4/4 (ordered; batch not supported)] (36500, 9900.0, '2025-03-20 16:55:10.752649', '2025-03-20 16:55:10.752649')
2025-03-20 18:55:10,757 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:55:10,772 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:55:10,776 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements) AS anon_1
2025-03-20 18:55:10,776 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] ()
2025-03-20 18:55:10,778 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-03-20 18:55:10,779 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] ('major', 'Мажор', 'Доказательство вашей финансовой состоятельности', '💰', 1, 10000, '2025-03-20 16:55:10.778140')
2025-03-20 18:55:10,780 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:55:10,780 - sqlalchemy.engine.Engine - INFO - [generated in 0.00015s (insertmanyvalues) 1/9 (ordered; batch not supported)] ('popular', 'Популярный', 'Добавить объявление по поиску команды', '👥', 0, 0, '2025-03-20 16:55:10.780131')
2025-03-20 18:55:10,781 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:55:10,781 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 2/9 (ordered; batch not supported)] ('club_fighter', 'Бойцовский клуб', 'Добавить объявление по поиску клуба', '🥊', 0, 0, '2025-03-20 16:55:10.780131')
2025-03-20 18:55:10,781 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:55:10,781 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 3/9 (ordered; batch not supported)] ('explorer', 'Искатель', 'Посетить все разделы бота', '🔍', 0, 0, '2025-03-20 16:55:10.780131')
2025-03-20 18:55:10,782 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:55:10,782 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 4/9 (ordered; batch not supported)] ('legend', 'Легенда', 'Купить премиум статус', '⭐', 0, 0, '2025-03-20 16:55:10.780131')
2025-03-20 18:55:10,782 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:55:10,783 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 5/9 (ordered; batch not supported)] ('leprechaun', 'Лепрекон', 'Накопить 15,000 монет в балансе', '🍀', 0, 0, '2025-03-20 16:55:10.780131')
2025-03-20 18:55:10,783 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:55:10,783 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 6/9 (ordered; batch not supported)] ('lucky', 'Испытать удачу', 'Принять участие в розыгрыше монет', '🎁', 0, 0, '2025-03-20 16:55:10.780131')
2025-03-20 18:55:10,783 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:55:10,783 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 7/9 (ordered; batch not supported)] ('business', 'Бизнес-мачо', 'Пригласить человека по реферальной ссылке', '💼', 0, 0, '2025-03-20 16:55:10.780131')
2025-03-20 18:55:10,783 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:55:10,783 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 8/9 (ordered; batch not supported)] ('follow_me', 'Делай как я', 'Пригласить 10 человек по реферальной ссылке', '👑', 0, 0, '2025-03-20 16:55:10.780131')
2025-03-20 18:55:10,784 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:55:10,784 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 9/9 (ordered; batch not supported)] ('friend', 'Настоящий друг', 'Пригласить 25 человек по реферальной ссылке', '❤️', 0, 0, '2025-03-20 16:55:10.780131')
2025-03-20 18:55:10,784 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:55:10,787 - root - INFO - Achievements handlers registered successfully
2025-03-20 18:55:10,921 - aiogram - INFO - Bot: Бубсер Поиск Бот [@Bubser_PoiskBot]
2025-03-20 18:55:11,000 - aiogram - WARNING - Updates were skipped successfully.
2025-03-20 18:55:11,000 - __main__ - INFO - Бот успешно запущен!
2025-03-20 18:55:11,001 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:55:11,004 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.tg_id, users.username, users.first_name, users.is_premium, users.premium_end_date, users.crystals, users.language, users.blocked, users.last_gift, users.created_at, users.updated_at, users.coins, users.premium_until 
FROM users 
WHERE users.is_premium = 1 AND users.premium_end_date <= ?
2025-03-20 18:55:11,004 - sqlalchemy.engine.Engine - INFO - [generated in 0.00056s] ('2025-03-20 18:55:11.000454',)
2025-03-20 18:55:11,005 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:55:11,005 - aiogram.dispatcher.dispatcher - INFO - Start polling.
2025-03-20 18:55:12,796 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:55:12,798 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:55:12,798 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] (7115599761, 1, 0)
2025-03-20 18:55:12,800 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:55:12,801 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:55:12,802 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:55:12,802 - sqlalchemy.engine.Engine - INFO - [cached since 0.004176s ago] (7115599761, 1, 0)
2025-03-20 18:55:12,802 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:55:12,803 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:55:12,804 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:55:12,804 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] (7115599761, 1, 0)
2025-03-20 18:55:12,805 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:55:12,805 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:55:12,805 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:55:12,806 - sqlalchemy.engine.Engine - INFO - [cached since 0.002579s ago] (7115599761, 1, 0)
2025-03-20 18:55:12,806 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:55:12,807 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:55:12,807 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:55:12,807 - sqlalchemy.engine.Engine - INFO - [cached since 0.004361s ago] (7115599761, 1, 0)
2025-03-20 18:55:12,808 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:55:12,808 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:55:12,808 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:55:12,809 - sqlalchemy.engine.Engine - INFO - [cached since 0.005568s ago] (7115599761, 1, 0)
2025-03-20 18:55:12,809 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:55:12,809 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:55:12,809 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:55:12,810 - sqlalchemy.engine.Engine - INFO - [cached since 0.006673s ago] (7115599761, 1, 0)
2025-03-20 18:55:12,811 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (tg_id, username, first_name, is_premium, premium_end_date, crystals, language, blocked, last_gift, created_at, updated_at, coins, premium_until) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-03-20 18:55:12,811 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] (7115599761, 'hhhsleep', 'zzzsleep', 0, None, 100, 'ru', 0, None, '2025-03-20 18:55:12.810870', '2025-03-20 16:55:12.811868', 0, None)
2025-03-20 18:55:12,813 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:55:13,794 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:55:13,794 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:55:13,795 - sqlalchemy.engine.Engine - INFO - [cached since 0.9969s ago] (7115599761, 1, 0)
2025-03-20 18:55:13,795 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:55:13,796 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:55:13,796 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:55:13,798 - sqlalchemy.engine.Engine - INFO - [cached since 0.9999s ago] (7115599761, 1, 0)
2025-03-20 18:55:13,798 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:55:13,799 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:55:13,799 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:55:13,800 - sqlalchemy.engine.Engine - INFO - [cached since 0.9961s ago] (7115599761, 1, 0)
2025-03-20 18:55:13,801 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:55:14,772 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:55:14,773 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:55:14,773 - sqlalchemy.engine.Engine - INFO - [cached since 1.976s ago] (7115599761, 1, 0)
2025-03-20 18:55:14,775 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:55:14,778 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:55:14,779 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:55:14,779 - sqlalchemy.engine.Engine - INFO - [cached since 1.982s ago] (7115599761, 1, 0)
2025-03-20 18:55:14,780 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:55:14,780 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:55:14,781 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:55:14,781 - sqlalchemy.engine.Engine - INFO - [cached since 1.977s ago] (7115599761, 1, 0)
2025-03-20 18:55:14,782 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:55:14,835 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:55:14,836 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:55:14,836 - sqlalchemy.engine.Engine - INFO - [cached since 2.033s ago] (7115599761, 1, 0)
2025-03-20 18:55:14,839 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:55:14,840 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:55:14,841 - sqlalchemy.engine.Engine - INFO - [cached since 2.037s ago] (7115599761, 1, 0)
2025-03-20 18:55:14,843 - sqlalchemy.engine.Engine - INFO - SELECT user_achievements.id AS user_achievements_id, user_achievements.user_id AS user_achievements_user_id, user_achievements.achievement_id AS user_achievements_achievement_id, user_achievements.achieved_at AS user_achievements_achieved_at, achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM user_achievements JOIN achievements ON user_achievements.achievement_id = achievements.id 
WHERE user_achievements.user_id = ?
2025-03-20 18:55:14,843 - sqlalchemy.engine.Engine - INFO - [generated in 0.00073s] (1,)
2025-03-20 18:55:14,845 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:55:14,846 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:57:19,263 - aiogram.dispatcher.dispatcher - INFO - Stop polling...
2025-03-20 18:57:19,263 - aiogram - WARNING - Goodbye!
2025-03-20 18:57:20,903 - __main__ - INFO - Запуск бота...
2025-03-20 18:57:21,183 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:57:21,185 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-03-20 18:57:21,185 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:57:21,188 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referrals")
2025-03-20 18:57:21,188 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:57:21,189 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("announcements")
2025-03-20 18:57:21,189 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:57:21,190 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("reports")
2025-03-20 18:57:21,190 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:57:21,190 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("favorites")
2025-03-20 18:57:21,190 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:57:21,191 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("crystal_transactions")
2025-03-20 18:57:21,191 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:57:21,191 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("premium_prices")
2025-03-20 18:57:21,191 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:57:21,192 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sponsors")
2025-03-20 18:57:21,192 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:57:21,192 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_sponsor_subscriptions")
2025-03-20 18:57:21,193 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:57:21,194 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_codes")
2025-03-20 18:57:21,194 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:57:21,194 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_uses")
2025-03-20 18:57:21,195 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:57:21,195 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-03-20 18:57:21,195 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:57:21,195 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_achievements")
2025-03-20 18:57:21,195 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:57:21,196 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_visited_sections")
2025-03-20 18:57:21,196 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:57:21,196 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_secret_purchases")
2025-03-20 18:57:21,196 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:57:21,197 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("bot_settings")
2025-03-20 18:57:21,197 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:57:21,197 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:57:21,223 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:57:21,228 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:57:21,229 - sqlalchemy.engine.Engine - INFO - [generated in 0.00172s] (30, 1, 0)
2025-03-20 18:57:21,231 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:57:21,232 - sqlalchemy.engine.Engine - INFO - [cached since 0.004245s ago] (180, 1, 0)
2025-03-20 18:57:21,233 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:57:21,233 - sqlalchemy.engine.Engine - INFO - [cached since 0.005905s ago] (365, 1, 0)
2025-03-20 18:57:21,235 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:57:21,235 - sqlalchemy.engine.Engine - INFO - [cached since 0.008572s ago] (36500, 1, 0)
2025-03-20 18:57:21,236 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:57:21,257 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:57:21,262 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements) AS anon_1
2025-03-20 18:57:21,265 - sqlalchemy.engine.Engine - INFO - [generated in 0.00294s] ()
2025-03-20 18:57:21,266 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:57:21,272 - root - INFO - Achievements handlers registered successfully
2025-03-20 18:57:21,412 - aiogram - INFO - Bot: Бубсер Поиск Бот [@Bubser_PoiskBot]
2025-03-20 18:57:21,492 - aiogram - WARNING - Updates were skipped successfully.
2025-03-20 18:57:21,492 - __main__ - INFO - Бот успешно запущен!
2025-03-20 18:57:21,493 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:57:21,496 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.tg_id, users.username, users.first_name, users.is_premium, users.premium_end_date, users.crystals, users.language, users.blocked, users.last_gift, users.created_at, users.updated_at, users.coins, users.premium_until 
FROM users 
WHERE users.is_premium = 1 AND users.premium_end_date <= ?
2025-03-20 18:57:21,496 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] ('2025-03-20 18:57:21.493012',)
2025-03-20 18:57:21,497 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:57:21,498 - aiogram.dispatcher.dispatcher - INFO - Start polling.
2025-03-20 18:57:22,335 - aiogram.dispatcher.dispatcher - INFO - Stop polling...
2025-03-20 18:57:22,335 - aiogram - WARNING - Goodbye!
2025-03-20 18:58:06,423 - __main__ - INFO - Запуск бота...
2025-03-20 18:58:06,685 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:06,686 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-03-20 18:58:06,686 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,687 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2025-03-20 18:58:06,688 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,688 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referrals")
2025-03-20 18:58:06,688 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,688 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referrals")
2025-03-20 18:58:06,688 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,689 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("announcements")
2025-03-20 18:58:06,689 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,689 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("announcements")
2025-03-20 18:58:06,689 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,689 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("reports")
2025-03-20 18:58:06,689 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,690 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("reports")
2025-03-20 18:58:06,690 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,690 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("favorites")
2025-03-20 18:58:06,690 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,691 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("favorites")
2025-03-20 18:58:06,691 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,691 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("crystal_transactions")
2025-03-20 18:58:06,691 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,692 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("crystal_transactions")
2025-03-20 18:58:06,692 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,693 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("premium_prices")
2025-03-20 18:58:06,693 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,693 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("premium_prices")
2025-03-20 18:58:06,693 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,694 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sponsors")
2025-03-20 18:58:06,694 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,695 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("sponsors")
2025-03-20 18:58:06,695 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,696 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_sponsor_subscriptions")
2025-03-20 18:58:06,696 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,696 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_sponsor_subscriptions")
2025-03-20 18:58:06,696 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,696 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_codes")
2025-03-20 18:58:06,696 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,697 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("promo_codes")
2025-03-20 18:58:06,697 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,697 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_uses")
2025-03-20 18:58:06,697 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,698 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("promo_uses")
2025-03-20 18:58:06,698 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,698 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-03-20 18:58:06,698 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,699 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("achievements")
2025-03-20 18:58:06,699 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,700 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_achievements")
2025-03-20 18:58:06,700 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,700 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_achievements")
2025-03-20 18:58:06,701 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,701 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_visited_sections")
2025-03-20 18:58:06,701 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,702 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_visited_sections")
2025-03-20 18:58:06,702 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,702 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_secret_purchases")
2025-03-20 18:58:06,702 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,702 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_secret_purchases")
2025-03-20 18:58:06,703 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,703 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("bot_settings")
2025-03-20 18:58:06,703 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,703 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("bot_settings")
2025-03-20 18:58:06,703 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:06,703 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	tg_id INTEGER NOT NULL, 
	username VARCHAR, 
	first_name VARCHAR, 
	is_premium BOOLEAN, 
	premium_end_date DATETIME, 
	crystals INTEGER, 
	language VARCHAR, 
	blocked BOOLEAN, 
	last_gift DATETIME, 
	created_at DATETIME, 
	updated_at DATETIME, 
	coins INTEGER, 
	premium_until DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE (tg_id)
)


2025-03-20 18:58:06,705 - sqlalchemy.engine.Engine - INFO - [no key 0.00043s] ()
2025-03-20 18:58:06,709 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_id ON users (id)
2025-03-20 18:58:06,709 - sqlalchemy.engine.Engine - INFO - [no key 0.00033s] ()
2025-03-20 18:58:06,712 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referrals (
	id INTEGER NOT NULL, 
	referrer_id INTEGER NOT NULL, 
	referred_id INTEGER NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE (referred_id)
)


2025-03-20 18:58:06,713 - sqlalchemy.engine.Engine - INFO - [no key 0.00065s] ()
2025-03-20 18:58:06,727 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_referrals_id ON referrals (id)
2025-03-20 18:58:06,727 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2025-03-20 18:58:06,730 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE premium_prices (
	id INTEGER NOT NULL, 
	duration_days INTEGER NOT NULL, 
	price FLOAT NOT NULL, 
	created_at DATETIME, 
	updated_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE (duration_days)
)


2025-03-20 18:58:06,731 - sqlalchemy.engine.Engine - INFO - [no key 0.00044s] ()
2025-03-20 18:58:06,734 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_premium_prices_id ON premium_prices (id)
2025-03-20 18:58:06,735 - sqlalchemy.engine.Engine - INFO - [no key 0.00041s] ()
2025-03-20 18:58:06,739 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE sponsors (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	link VARCHAR NOT NULL, 
	channel_id VARCHAR, 
	reward INTEGER, 
	is_active BOOLEAN, 
	created_at DATETIME, 
	updated_at DATETIME, 
	PRIMARY KEY (id)
)


2025-03-20 18:58:06,741 - sqlalchemy.engine.Engine - INFO - [no key 0.00156s] ()
2025-03-20 18:58:06,743 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_sponsors_id ON sponsors (id)
2025-03-20 18:58:06,745 - sqlalchemy.engine.Engine - INFO - [no key 0.00039s] ()
2025-03-20 18:58:06,749 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE promo_codes (
	id INTEGER NOT NULL, 
	code VARCHAR NOT NULL, 
	duration_days INTEGER NOT NULL, 
	max_uses INTEGER, 
	uses_count INTEGER, 
	is_active BOOLEAN, 
	created_at DATETIME, 
	expires_at DATETIME, 
	PRIMARY KEY (id)
)


2025-03-20 18:58:06,749 - sqlalchemy.engine.Engine - INFO - [no key 0.00065s] ()
2025-03-20 18:58:06,752 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_promo_codes_id ON promo_codes (id)
2025-03-20 18:58:06,752 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2025-03-20 18:58:06,756 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_promo_codes_code ON promo_codes (code)
2025-03-20 18:58:06,756 - sqlalchemy.engine.Engine - INFO - [no key 0.00091s] ()
2025-03-20 18:58:06,761 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE achievements (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	name VARCHAR NOT NULL, 
	description VARCHAR NOT NULL, 
	icon VARCHAR, 
	is_purchasable BOOLEAN, 
	price INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE ("key")
)


2025-03-20 18:58:06,761 - sqlalchemy.engine.Engine - INFO - [no key 0.00061s] ()
2025-03-20 18:58:06,765 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_achievements_id ON achievements (id)
2025-03-20 18:58:06,765 - sqlalchemy.engine.Engine - INFO - [no key 0.00033s] ()
2025-03-20 18:58:06,768 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE bot_settings (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	value VARCHAR, 
	updated_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE ("key")
)


2025-03-20 18:58:06,768 - sqlalchemy.engine.Engine - INFO - [no key 0.00036s] ()
2025-03-20 18:58:06,771 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE announcements (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	announcement_type VARCHAR(4) NOT NULL, 
	image_id VARCHAR NOT NULL, 
	media_id VARCHAR, 
	media_type VARCHAR, 
	description TEXT NOT NULL, 
	keyword VARCHAR, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-03-20 18:58:06,771 - sqlalchemy.engine.Engine - INFO - [no key 0.00038s] ()
2025-03-20 18:58:06,774 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_announcements_id ON announcements (id)
2025-03-20 18:58:06,774 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2025-03-20 18:58:06,777 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE crystal_transactions (
	id INTEGER NOT NULL, 
	sender_id INTEGER, 
	receiver_id INTEGER, 
	amount INTEGER NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(sender_id) REFERENCES users (id), 
	FOREIGN KEY(receiver_id) REFERENCES users (id)
)


2025-03-20 18:58:06,778 - sqlalchemy.engine.Engine - INFO - [no key 0.00039s] ()
2025-03-20 18:58:06,780 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_crystal_transactions_id ON crystal_transactions (id)
2025-03-20 18:58:06,780 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2025-03-20 18:58:06,783 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_sponsor_subscriptions (
	id INTEGER NOT NULL, 
	user_tg_id INTEGER NOT NULL, 
	sponsor_id INTEGER NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_tg_id) REFERENCES users (tg_id), 
	FOREIGN KEY(sponsor_id) REFERENCES sponsors (id)
)


2025-03-20 18:58:06,783 - sqlalchemy.engine.Engine - INFO - [no key 0.00069s] ()
2025-03-20 18:58:06,787 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE promo_uses (
	id INTEGER NOT NULL, 
	promo_id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	used_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(promo_id) REFERENCES promo_codes (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-03-20 18:58:06,787 - sqlalchemy.engine.Engine - INFO - [no key 0.00036s] ()
2025-03-20 18:58:06,790 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_promo_uses_id ON promo_uses (id)
2025-03-20 18:58:06,790 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2025-03-20 18:58:06,793 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_achievements (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	achievement_id INTEGER NOT NULL, 
	achieved_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id), 
	FOREIGN KEY(achievement_id) REFERENCES achievements (id)
)


2025-03-20 18:58:06,793 - sqlalchemy.engine.Engine - INFO - [no key 0.00033s] ()
2025-03-20 18:58:06,796 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_user_achievements_id ON user_achievements (id)
2025-03-20 18:58:06,798 - sqlalchemy.engine.Engine - INFO - [no key 0.00114s] ()
2025-03-20 18:58:06,800 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_visited_sections (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	section VARCHAR NOT NULL, 
	visited_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-03-20 18:58:06,801 - sqlalchemy.engine.Engine - INFO - [no key 0.00038s] ()
2025-03-20 18:58:06,804 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_user_visited_sections_id ON user_visited_sections (id)
2025-03-20 18:58:06,804 - sqlalchemy.engine.Engine - INFO - [no key 0.00048s] ()
2025-03-20 18:58:06,810 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_secret_purchases (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	content_key VARCHAR NOT NULL, 
	purchased_at DATETIME, 
	price INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-03-20 18:58:06,811 - sqlalchemy.engine.Engine - INFO - [no key 0.00139s] ()
2025-03-20 18:58:06,814 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_user_secret_purchases_id ON user_secret_purchases (id)
2025-03-20 18:58:06,815 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2025-03-20 18:58:06,819 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE reports (
	id INTEGER NOT NULL, 
	reporter_id INTEGER, 
	announcement_id INTEGER, 
	reason VARCHAR NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(reporter_id) REFERENCES users (id), 
	FOREIGN KEY(announcement_id) REFERENCES announcements (id)
)


2025-03-20 18:58:06,819 - sqlalchemy.engine.Engine - INFO - [no key 0.00041s] ()
2025-03-20 18:58:06,821 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_reports_id ON reports (id)
2025-03-20 18:58:06,822 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2025-03-20 18:58:06,824 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE favorites (
	id INTEGER NOT NULL, 
	user_id INTEGER, 
	announcement_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id), 
	FOREIGN KEY(announcement_id) REFERENCES announcements (id)
)


2025-03-20 18:58:06,825 - sqlalchemy.engine.Engine - INFO - [no key 0.00083s] ()
2025-03-20 18:58:06,827 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_favorites_id ON favorites (id)
2025-03-20 18:58:06,827 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2025-03-20 18:58:06,831 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:58:06,849 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:06,853 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:06,855 - sqlalchemy.engine.Engine - INFO - [generated in 0.00069s] (30, 1, 0)
2025-03-20 18:58:06,856 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:06,856 - sqlalchemy.engine.Engine - INFO - [cached since 0.002159s ago] (180, 1, 0)
2025-03-20 18:58:06,857 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:06,857 - sqlalchemy.engine.Engine - INFO - [cached since 0.003388s ago] (365, 1, 0)
2025-03-20 18:58:06,858 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:06,859 - sqlalchemy.engine.Engine - INFO - [cached since 0.005092s ago] (36500, 1, 0)
2025-03-20 18:58:06,861 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-20 18:58:06,861 - sqlalchemy.engine.Engine - INFO - [generated in 0.00016s (insertmanyvalues) 1/4 (ordered; batch not supported)] (30, 500.0, '2025-03-20 16:58:06.861920', '2025-03-20 16:58:06.861920')
2025-03-20 18:58:06,862 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-20 18:58:06,862 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 2/4 (ordered; batch not supported)] (180, 2500.0, '2025-03-20 16:58:06.861920', '2025-03-20 16:58:06.861920')
2025-03-20 18:58:06,863 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-20 18:58:06,863 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 3/4 (ordered; batch not supported)] (365, 4500.0, '2025-03-20 16:58:06.861920', '2025-03-20 16:58:06.861920')
2025-03-20 18:58:06,863 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-20 18:58:06,863 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 4/4 (ordered; batch not supported)] (36500, 9900.0, '2025-03-20 16:58:06.861920', '2025-03-20 16:58:06.861920')
2025-03-20 18:58:06,863 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:58:06,881 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:06,885 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements) AS anon_1
2025-03-20 18:58:06,885 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] ()
2025-03-20 18:58:06,889 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-03-20 18:58:06,889 - sqlalchemy.engine.Engine - INFO - [generated in 0.00063s] ('major', 'Мажор', 'Доказательство вашей финансовой состоятельности', '💰', 1, 10000, '2025-03-20 16:58:06.888446')
2025-03-20 18:58:06,891 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:58:06,892 - sqlalchemy.engine.Engine - INFO - [generated in 0.00016s (insertmanyvalues) 1/9 (ordered; batch not supported)] ('popular', 'Популярный', 'Добавить объявление по поиску команды', '👥', 0, 0, '2025-03-20 16:58:06.891439')
2025-03-20 18:58:06,892 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:58:06,893 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 2/9 (ordered; batch not supported)] ('club_fighter', 'Бойцовский клуб', 'Добавить объявление по поиску клуба', '🥊', 0, 0, '2025-03-20 16:58:06.891439')
2025-03-20 18:58:06,893 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:58:06,893 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 3/9 (ordered; batch not supported)] ('explorer', 'Искатель', 'Посетить все разделы бота', '🔍', 0, 0, '2025-03-20 16:58:06.891439')
2025-03-20 18:58:06,894 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:58:06,894 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 4/9 (ordered; batch not supported)] ('legend', 'Легенда', 'Купить премиум статус', '⭐', 0, 0, '2025-03-20 16:58:06.891439')
2025-03-20 18:58:06,895 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:58:06,895 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 5/9 (ordered; batch not supported)] ('leprechaun', 'Лепрекон', 'Накопить 15,000 монет в балансе', '🍀', 0, 0, '2025-03-20 16:58:06.891439')
2025-03-20 18:58:06,895 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:58:06,895 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 6/9 (ordered; batch not supported)] ('lucky', 'Испытать удачу', 'Принять участие в розыгрыше монет', '🎁', 0, 0, '2025-03-20 16:58:06.891439')
2025-03-20 18:58:06,895 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:58:06,895 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 7/9 (ordered; batch not supported)] ('business', 'Бизнес-мачо', 'Пригласить человека по реферальной ссылке', '💼', 0, 0, '2025-03-20 16:58:06.891439')
2025-03-20 18:58:06,896 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:58:06,896 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 8/9 (ordered; batch not supported)] ('follow_me', 'Делай как я', 'Пригласить 10 человек по реферальной ссылке', '👑', 0, 0, '2025-03-20 16:58:06.891439')
2025-03-20 18:58:06,896 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:58:06,896 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 9/9 (ordered; batch not supported)] ('friend', 'Настоящий друг', 'Пригласить 25 человек по реферальной ссылке', '❤️', 0, 0, '2025-03-20 16:58:06.891439')
2025-03-20 18:58:06,897 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:58:06,900 - root - INFO - Achievements handlers registered successfully
2025-03-20 18:58:07,029 - aiogram - INFO - Bot: Бубсер Поиск Бот [@Bubser_PoiskBot]
2025-03-20 18:58:07,115 - aiogram - WARNING - Updates were skipped successfully.
2025-03-20 18:58:07,116 - __main__ - INFO - Бот успешно запущен!
2025-03-20 18:58:07,118 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:07,120 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.tg_id, users.username, users.first_name, users.is_premium, users.premium_end_date, users.crystals, users.language, users.blocked, users.last_gift, users.created_at, users.updated_at, users.coins, users.premium_until 
FROM users 
WHERE users.is_premium = 1 AND users.premium_end_date <= ?
2025-03-20 18:58:07,120 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('2025-03-20 18:58:07.116472',)
2025-03-20 18:58:07,121 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:58:07,122 - aiogram.dispatcher.dispatcher - INFO - Start polling.
2025-03-20 18:58:08,102 - aiogram.dispatcher.dispatcher - INFO - Stop polling...
2025-03-20 18:58:08,103 - aiogram - WARNING - Goodbye!
2025-03-20 18:58:11,822 - __main__ - INFO - Запуск бота...
2025-03-20 18:58:12,141 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:12,142 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-03-20 18:58:12,143 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,144 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2025-03-20 18:58:12,145 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,145 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referrals")
2025-03-20 18:58:12,145 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,145 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referrals")
2025-03-20 18:58:12,146 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,146 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("announcements")
2025-03-20 18:58:12,146 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,146 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("announcements")
2025-03-20 18:58:12,146 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,146 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("reports")
2025-03-20 18:58:12,146 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,148 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("reports")
2025-03-20 18:58:12,148 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,148 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("favorites")
2025-03-20 18:58:12,149 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,149 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("favorites")
2025-03-20 18:58:12,149 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,149 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("crystal_transactions")
2025-03-20 18:58:12,149 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,150 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("crystal_transactions")
2025-03-20 18:58:12,150 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,151 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("premium_prices")
2025-03-20 18:58:12,151 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,151 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("premium_prices")
2025-03-20 18:58:12,152 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,152 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sponsors")
2025-03-20 18:58:12,152 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,152 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("sponsors")
2025-03-20 18:58:12,152 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,152 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_sponsor_subscriptions")
2025-03-20 18:58:12,153 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,153 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_sponsor_subscriptions")
2025-03-20 18:58:12,153 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,153 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_codes")
2025-03-20 18:58:12,153 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,154 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("promo_codes")
2025-03-20 18:58:12,154 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,154 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_uses")
2025-03-20 18:58:12,154 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,154 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("promo_uses")
2025-03-20 18:58:12,154 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,154 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-03-20 18:58:12,154 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,155 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("achievements")
2025-03-20 18:58:12,155 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,155 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_achievements")
2025-03-20 18:58:12,155 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,155 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_achievements")
2025-03-20 18:58:12,155 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,155 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_visited_sections")
2025-03-20 18:58:12,155 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,157 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_visited_sections")
2025-03-20 18:58:12,157 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,158 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_secret_purchases")
2025-03-20 18:58:12,158 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,159 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_secret_purchases")
2025-03-20 18:58:12,159 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,159 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("bot_settings")
2025-03-20 18:58:12,160 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,160 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("bot_settings")
2025-03-20 18:58:12,160 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-20 18:58:12,162 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	tg_id INTEGER NOT NULL, 
	username VARCHAR, 
	first_name VARCHAR, 
	is_premium BOOLEAN, 
	premium_end_date DATETIME, 
	crystals INTEGER, 
	language VARCHAR, 
	blocked BOOLEAN, 
	last_gift DATETIME, 
	created_at DATETIME, 
	updated_at DATETIME, 
	coins INTEGER, 
	premium_until DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE (tg_id)
)


2025-03-20 18:58:12,162 - sqlalchemy.engine.Engine - INFO - [no key 0.00047s] ()
2025-03-20 18:58:12,166 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_id ON users (id)
2025-03-20 18:58:12,166 - sqlalchemy.engine.Engine - INFO - [no key 0.00043s] ()
2025-03-20 18:58:12,169 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referrals (
	id INTEGER NOT NULL, 
	referrer_id INTEGER NOT NULL, 
	referred_id INTEGER NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE (referred_id)
)


2025-03-20 18:58:12,169 - sqlalchemy.engine.Engine - INFO - [no key 0.00041s] ()
2025-03-20 18:58:12,173 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_referrals_id ON referrals (id)
2025-03-20 18:58:12,174 - sqlalchemy.engine.Engine - INFO - [no key 0.00054s] ()
2025-03-20 18:58:12,178 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE premium_prices (
	id INTEGER NOT NULL, 
	duration_days INTEGER NOT NULL, 
	price FLOAT NOT NULL, 
	created_at DATETIME, 
	updated_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE (duration_days)
)


2025-03-20 18:58:12,179 - sqlalchemy.engine.Engine - INFO - [no key 0.00161s] ()
2025-03-20 18:58:12,183 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_premium_prices_id ON premium_prices (id)
2025-03-20 18:58:12,183 - sqlalchemy.engine.Engine - INFO - [no key 0.00033s] ()
2025-03-20 18:58:12,187 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE sponsors (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	link VARCHAR NOT NULL, 
	channel_id VARCHAR, 
	reward INTEGER, 
	is_active BOOLEAN, 
	created_at DATETIME, 
	updated_at DATETIME, 
	PRIMARY KEY (id)
)


2025-03-20 18:58:12,187 - sqlalchemy.engine.Engine - INFO - [no key 0.00059s] ()
2025-03-20 18:58:12,192 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_sponsors_id ON sponsors (id)
2025-03-20 18:58:12,193 - sqlalchemy.engine.Engine - INFO - [no key 0.00090s] ()
2025-03-20 18:58:12,195 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE promo_codes (
	id INTEGER NOT NULL, 
	code VARCHAR NOT NULL, 
	duration_days INTEGER NOT NULL, 
	max_uses INTEGER, 
	uses_count INTEGER, 
	is_active BOOLEAN, 
	created_at DATETIME, 
	expires_at DATETIME, 
	PRIMARY KEY (id)
)


2025-03-20 18:58:12,195 - sqlalchemy.engine.Engine - INFO - [no key 0.00048s] ()
2025-03-20 18:58:12,200 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_promo_codes_id ON promo_codes (id)
2025-03-20 18:58:12,200 - sqlalchemy.engine.Engine - INFO - [no key 0.00041s] ()
2025-03-20 18:58:12,203 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_promo_codes_code ON promo_codes (code)
2025-03-20 18:58:12,203 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2025-03-20 18:58:12,206 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE achievements (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	name VARCHAR NOT NULL, 
	description VARCHAR NOT NULL, 
	icon VARCHAR, 
	is_purchasable BOOLEAN, 
	price INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE ("key")
)


2025-03-20 18:58:12,207 - sqlalchemy.engine.Engine - INFO - [no key 0.00060s] ()
2025-03-20 18:58:12,209 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_achievements_id ON achievements (id)
2025-03-20 18:58:12,210 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2025-03-20 18:58:12,212 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE bot_settings (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	value VARCHAR, 
	updated_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE ("key")
)


2025-03-20 18:58:12,213 - sqlalchemy.engine.Engine - INFO - [no key 0.00098s] ()
2025-03-20 18:58:12,216 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE announcements (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	announcement_type VARCHAR(4) NOT NULL, 
	image_id VARCHAR NOT NULL, 
	media_id VARCHAR, 
	media_type VARCHAR, 
	description TEXT NOT NULL, 
	keyword VARCHAR, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-03-20 18:58:12,216 - sqlalchemy.engine.Engine - INFO - [no key 0.00046s] ()
2025-03-20 18:58:12,223 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_announcements_id ON announcements (id)
2025-03-20 18:58:12,226 - sqlalchemy.engine.Engine - INFO - [no key 0.00290s] ()
2025-03-20 18:58:12,232 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE crystal_transactions (
	id INTEGER NOT NULL, 
	sender_id INTEGER, 
	receiver_id INTEGER, 
	amount INTEGER NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(sender_id) REFERENCES users (id), 
	FOREIGN KEY(receiver_id) REFERENCES users (id)
)


2025-03-20 18:58:12,232 - sqlalchemy.engine.Engine - INFO - [no key 0.00051s] ()
2025-03-20 18:58:12,235 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_crystal_transactions_id ON crystal_transactions (id)
2025-03-20 18:58:12,236 - sqlalchemy.engine.Engine - INFO - [no key 0.00038s] ()
2025-03-20 18:58:12,238 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_sponsor_subscriptions (
	id INTEGER NOT NULL, 
	user_tg_id INTEGER NOT NULL, 
	sponsor_id INTEGER NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_tg_id) REFERENCES users (tg_id), 
	FOREIGN KEY(sponsor_id) REFERENCES sponsors (id)
)


2025-03-20 18:58:12,238 - sqlalchemy.engine.Engine - INFO - [no key 0.00036s] ()
2025-03-20 18:58:12,243 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE promo_uses (
	id INTEGER NOT NULL, 
	promo_id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	used_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(promo_id) REFERENCES promo_codes (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-03-20 18:58:12,243 - sqlalchemy.engine.Engine - INFO - [no key 0.00043s] ()
2025-03-20 18:58:12,246 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_promo_uses_id ON promo_uses (id)
2025-03-20 18:58:12,246 - sqlalchemy.engine.Engine - INFO - [no key 0.00035s] ()
2025-03-20 18:58:12,250 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_achievements (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	achievement_id INTEGER NOT NULL, 
	achieved_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id), 
	FOREIGN KEY(achievement_id) REFERENCES achievements (id)
)


2025-03-20 18:58:12,250 - sqlalchemy.engine.Engine - INFO - [no key 0.00038s] ()
2025-03-20 18:58:12,253 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_user_achievements_id ON user_achievements (id)
2025-03-20 18:58:12,253 - sqlalchemy.engine.Engine - INFO - [no key 0.00036s] ()
2025-03-20 18:58:12,257 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_visited_sections (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	section VARCHAR NOT NULL, 
	visited_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-03-20 18:58:12,258 - sqlalchemy.engine.Engine - INFO - [no key 0.00036s] ()
2025-03-20 18:58:12,260 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_user_visited_sections_id ON user_visited_sections (id)
2025-03-20 18:58:12,260 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2025-03-20 18:58:12,265 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_secret_purchases (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	content_key VARCHAR NOT NULL, 
	purchased_at DATETIME, 
	price INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-03-20 18:58:12,265 - sqlalchemy.engine.Engine - INFO - [no key 0.00054s] ()
2025-03-20 18:58:12,269 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_user_secret_purchases_id ON user_secret_purchases (id)
2025-03-20 18:58:12,269 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2025-03-20 18:58:12,272 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE reports (
	id INTEGER NOT NULL, 
	reporter_id INTEGER, 
	announcement_id INTEGER, 
	reason VARCHAR NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(reporter_id) REFERENCES users (id), 
	FOREIGN KEY(announcement_id) REFERENCES announcements (id)
)


2025-03-20 18:58:12,272 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2025-03-20 18:58:12,275 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_reports_id ON reports (id)
2025-03-20 18:58:12,276 - sqlalchemy.engine.Engine - INFO - [no key 0.00047s] ()
2025-03-20 18:58:12,279 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE favorites (
	id INTEGER NOT NULL, 
	user_id INTEGER, 
	announcement_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id), 
	FOREIGN KEY(announcement_id) REFERENCES announcements (id)
)


2025-03-20 18:58:12,279 - sqlalchemy.engine.Engine - INFO - [no key 0.00034s] ()
2025-03-20 18:58:12,282 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_favorites_id ON favorites (id)
2025-03-20 18:58:12,283 - sqlalchemy.engine.Engine - INFO - [no key 0.00099s] ()
2025-03-20 18:58:12,286 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:58:12,306 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:12,311 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:12,311 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] (30, 1, 0)
2025-03-20 18:58:12,313 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:12,313 - sqlalchemy.engine.Engine - INFO - [cached since 0.002369s ago] (180, 1, 0)
2025-03-20 18:58:12,314 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:12,314 - sqlalchemy.engine.Engine - INFO - [cached since 0.003345s ago] (365, 1, 0)
2025-03-20 18:58:12,315 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:12,315 - sqlalchemy.engine.Engine - INFO - [cached since 0.004438s ago] (36500, 1, 0)
2025-03-20 18:58:12,318 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-20 18:58:12,318 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s (insertmanyvalues) 1/4 (ordered; batch not supported)] (30, 500.0, '2025-03-20 16:58:12.318672', '2025-03-20 16:58:12.318672')
2025-03-20 18:58:12,320 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-20 18:58:12,320 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 2/4 (ordered; batch not supported)] (180, 2500.0, '2025-03-20 16:58:12.318672', '2025-03-20 16:58:12.318672')
2025-03-20 18:58:12,320 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-20 18:58:12,320 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 3/4 (ordered; batch not supported)] (365, 4500.0, '2025-03-20 16:58:12.318672', '2025-03-20 16:58:12.318672')
2025-03-20 18:58:12,320 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-20 18:58:12,321 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 4/4 (ordered; batch not supported)] (36500, 9900.0, '2025-03-20 16:58:12.318672', '2025-03-20 16:58:12.318672')
2025-03-20 18:58:12,321 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:58:12,337 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:12,342 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements) AS anon_1
2025-03-20 18:58:12,343 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] ()
2025-03-20 18:58:12,346 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-03-20 18:58:12,346 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('major', 'Мажор', 'Доказательство вашей финансовой состоятельности', '💰', 1, 10000, '2025-03-20 16:58:12.346392')
2025-03-20 18:58:12,347 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:58:12,348 - sqlalchemy.engine.Engine - INFO - [generated in 0.00017s (insertmanyvalues) 1/9 (ordered; batch not supported)] ('popular', 'Популярный', 'Добавить объявление по поиску команды', '👥', 0, 0, '2025-03-20 16:58:12.347599')
2025-03-20 18:58:12,348 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:58:12,348 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 2/9 (ordered; batch not supported)] ('club_fighter', 'Бойцовский клуб', 'Добавить объявление по поиску клуба', '🥊', 0, 0, '2025-03-20 16:58:12.347599')
2025-03-20 18:58:12,348 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:58:12,348 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 3/9 (ordered; batch not supported)] ('explorer', 'Искатель', 'Посетить все разделы бота', '🔍', 0, 0, '2025-03-20 16:58:12.347599')
2025-03-20 18:58:12,349 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:58:12,349 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 4/9 (ordered; batch not supported)] ('legend', 'Легенда', 'Купить премиум статус', '⭐', 0, 0, '2025-03-20 16:58:12.347599')
2025-03-20 18:58:12,349 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:58:12,349 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 5/9 (ordered; batch not supported)] ('leprechaun', 'Лепрекон', 'Накопить 15,000 монет в балансе', '🍀', 0, 0, '2025-03-20 16:58:12.347599')
2025-03-20 18:58:12,349 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:58:12,349 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 6/9 (ordered; batch not supported)] ('lucky', 'Испытать удачу', 'Принять участие в розыгрыше монет', '🎁', 0, 0, '2025-03-20 16:58:12.347599')
2025-03-20 18:58:12,350 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:58:12,350 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 7/9 (ordered; batch not supported)] ('business', 'Бизнес-мачо', 'Пригласить человека по реферальной ссылке', '💼', 0, 0, '2025-03-20 16:58:12.347599')
2025-03-20 18:58:12,350 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:58:12,350 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 8/9 (ordered; batch not supported)] ('follow_me', 'Делай как я', 'Пригласить 10 человек по реферальной ссылке', '👑', 0, 0, '2025-03-20 16:58:12.347599')
2025-03-20 18:58:12,350 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-20 18:58:12,351 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 9/9 (ordered; batch not supported)] ('friend', 'Настоящий друг', 'Пригласить 25 человек по реферальной ссылке', '❤️', 0, 0, '2025-03-20 16:58:12.347599')
2025-03-20 18:58:12,351 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:58:12,356 - root - INFO - Achievements handlers registered successfully
2025-03-20 18:58:12,489 - aiogram - INFO - Bot: Бубсер Поиск Бот [@Bubser_PoiskBot]
2025-03-20 18:58:12,568 - aiogram - WARNING - Updates were skipped successfully.
2025-03-20 18:58:12,568 - __main__ - INFO - Бот успешно запущен!
2025-03-20 18:58:12,569 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:12,573 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.tg_id, users.username, users.first_name, users.is_premium, users.premium_end_date, users.crystals, users.language, users.blocked, users.last_gift, users.created_at, users.updated_at, users.coins, users.premium_until 
FROM users 
WHERE users.is_premium = 1 AND users.premium_end_date <= ?
2025-03-20 18:58:12,605 - sqlalchemy.engine.Engine - INFO - [generated in 0.03261s] ('2025-03-20 18:58:12.568163',)
2025-03-20 18:58:12,611 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:58:12,612 - aiogram.dispatcher.dispatcher - INFO - Start polling.
2025-03-20 18:58:34,928 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:34,930 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:34,930 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] (7115599761, 1, 0)
2025-03-20 18:58:34,931 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:34,931 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:34,932 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:34,932 - sqlalchemy.engine.Engine - INFO - [cached since 0.002107s ago] (7115599761, 1, 0)
2025-03-20 18:58:34,932 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:34,933 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:34,935 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:34,935 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] (7115599761, 1, 0)
2025-03-20 18:58:34,936 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:34,936 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:34,937 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:34,937 - sqlalchemy.engine.Engine - INFO - [cached since 0.002328s ago] (7115599761, 1, 0)
2025-03-20 18:58:34,938 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:34,938 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:34,939 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:34,939 - sqlalchemy.engine.Engine - INFO - [cached since 0.004154s ago] (7115599761, 1, 0)
2025-03-20 18:58:34,939 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:34,940 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:34,940 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:34,940 - sqlalchemy.engine.Engine - INFO - [cached since 0.005651s ago] (7115599761, 1, 0)
2025-03-20 18:58:34,942 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:34,942 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:34,942 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:34,943 - sqlalchemy.engine.Engine - INFO - [cached since 0.007982s ago] (7115599761, 1, 0)
2025-03-20 18:58:34,944 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (tg_id, username, first_name, is_premium, premium_end_date, crystals, language, blocked, last_gift, created_at, updated_at, coins, premium_until) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-03-20 18:58:34,944 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] (7115599761, 'hhhsleep', 'zzzsleep', 0, None, 100, 'ru', 0, None, '2025-03-20 18:58:34.943569', '2025-03-20 16:58:34.944564', 0, None)
2025-03-20 18:58:34,945 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:58:35,756 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:35,757 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:35,757 - sqlalchemy.engine.Engine - INFO - [cached since 0.8273s ago] (7115599761, 1, 0)
2025-03-20 18:58:35,758 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:35,759 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:35,759 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:35,760 - sqlalchemy.engine.Engine - INFO - [cached since 0.8297s ago] (7115599761, 1, 0)
2025-03-20 18:58:35,761 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:35,762 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:35,763 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:35,763 - sqlalchemy.engine.Engine - INFO - [cached since 0.8284s ago] (7115599761, 1, 0)
2025-03-20 18:58:35,764 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:36,899 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:36,900 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:36,901 - sqlalchemy.engine.Engine - INFO - [cached since 1.97s ago] (7115599761, 1, 0)
2025-03-20 18:58:36,902 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:36,904 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:36,904 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:36,905 - sqlalchemy.engine.Engine - INFO - [cached since 1.975s ago] (7115599761, 1, 0)
2025-03-20 18:58:36,905 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:36,906 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:36,907 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:36,907 - sqlalchemy.engine.Engine - INFO - [cached since 1.972s ago] (7115599761, 1, 0)
2025-03-20 18:58:36,908 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:37,026 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:37,027 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:37,028 - sqlalchemy.engine.Engine - INFO - [cached since 2.093s ago] (7115599761, 1, 0)
2025-03-20 18:58:37,033 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:37,033 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:37,034 - sqlalchemy.engine.Engine - INFO - [cached since 2.099s ago] (7115599761, 1, 0)
2025-03-20 18:58:37,040 - sqlalchemy.engine.Engine - INFO - SELECT user_achievements.id AS user_achievements_id, user_achievements.user_id AS user_achievements_user_id, user_achievements.achievement_id AS user_achievements_achievement_id, user_achievements.achieved_at AS user_achievements_achieved_at, achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM user_achievements JOIN achievements ON user_achievements.achievement_id = achievements.id 
WHERE user_achievements.user_id = ?
2025-03-20 18:58:37,041 - sqlalchemy.engine.Engine - INFO - [generated in 0.00118s] (1,)
2025-03-20 18:58:37,042 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:37,042 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:37,043 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:37,043 - sqlalchemy.engine.Engine - INFO - [cached since 2.108s ago] (7115599761, 1, 0)
2025-03-20 18:58:37,043 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:37,044 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:43,182 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:43,182 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:43,182 - sqlalchemy.engine.Engine - INFO - [cached since 8.252s ago] (7115599761, 1, 0)
2025-03-20 18:58:43,185 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:43,195 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:43,195 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:43,196 - sqlalchemy.engine.Engine - INFO - [cached since 8.265s ago] (7115599761, 1, 0)
2025-03-20 18:58:43,196 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:43,197 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:43,197 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:43,198 - sqlalchemy.engine.Engine - INFO - [cached since 8.263s ago] (7115599761, 1, 0)
2025-03-20 18:58:43,199 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:47,449 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:47,449 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:47,450 - sqlalchemy.engine.Engine - INFO - [cached since 12.52s ago] (7115599761, 1, 0)
2025-03-20 18:58:47,450 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:47,451 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:47,451 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:47,451 - sqlalchemy.engine.Engine - INFO - [cached since 12.52s ago] (7115599761, 1, 0)
2025-03-20 18:58:47,452 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:47,452 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:47,452 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:47,453 - sqlalchemy.engine.Engine - INFO - [cached since 12.52s ago] (7115599761, 1, 0)
2025-03-20 18:58:47,453 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:47,617 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:47,617 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:47,618 - sqlalchemy.engine.Engine - INFO - [cached since 12.68s ago] (7115599761, 1, 0)
2025-03-20 18:58:47,620 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:47,620 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] (1, 'search_team_menu', 1, 0)
2025-03-20 18:58:47,623 - sqlalchemy.engine.Engine - INFO - INSERT INTO user_visited_sections (user_id, section, visited_at) VALUES (?, ?, ?)
2025-03-20 18:58:47,625 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] (1, 'search_team_menu', '2025-03-20 16:58:47.623933')
2025-03-20 18:58:47,626 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:58:47,630 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:47,631 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
2025-03-20 18:58:47,631 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] (1,)
2025-03-20 18:58:47,632 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.section AS user_visited_sections_section 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section IN (?, ?, ?, ?, ?, ?)
2025-03-20 18:58:47,632 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] (1, 'search_team_menu', 'search_club_menu', 'crystals', 'premium', 'additional', 'gift')
2025-03-20 18:58:47,634 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:49,263 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:49,305 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:49,307 - sqlalchemy.engine.Engine - INFO - [cached since 14.38s ago] (7115599761, 1, 0)
2025-03-20 18:58:49,310 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:49,311 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:49,313 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:49,313 - sqlalchemy.engine.Engine - INFO - [cached since 14.38s ago] (7115599761, 1, 0)
2025-03-20 18:58:49,314 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:49,316 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:49,317 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:49,317 - sqlalchemy.engine.Engine - INFO - [cached since 14.38s ago] (7115599761, 1, 0)
2025-03-20 18:58:49,318 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:49,455 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:49,476 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:49,479 - sqlalchemy.engine.Engine - INFO - [cached since 14.54s ago] (7115599761, 1, 0)
2025-03-20 18:58:49,485 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:49,486 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:49,488 - sqlalchemy.engine.Engine - INFO - SELECT announcements.id AS announcements_id, announcements.user_id AS announcements_user_id, announcements.announcement_type AS announcements_announcement_type, announcements.image_id AS announcements_image_id, announcements.media_id AS announcements_media_id, announcements.media_type AS announcements_media_type, announcements.description AS announcements_description, announcements.keyword AS announcements_keyword, announcements.created_at AS announcements_created_at 
FROM announcements 
WHERE announcements.user_id = ? AND announcements.announcement_type = ? ORDER BY announcements.created_at DESC
 LIMIT ? OFFSET ?
2025-03-20 18:58:49,488 - sqlalchemy.engine.Engine - INFO - [generated in 0.00069s] (7115599761, 'team', 2, 0)
2025-03-20 18:58:49,490 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:50,333 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:50,346 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:50,349 - sqlalchemy.engine.Engine - INFO - [cached since 15.42s ago] (7115599761, 1, 0)
2025-03-20 18:58:50,354 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:50,355 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:50,355 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:50,379 - sqlalchemy.engine.Engine - INFO - [cached since 15.45s ago] (7115599761, 1, 0)
2025-03-20 18:58:50,390 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:50,392 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:50,393 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:50,393 - sqlalchemy.engine.Engine - INFO - [cached since 15.46s ago] (7517432356, 1, 0)
2025-03-20 18:58:50,395 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:50,397 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:50,398 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:50,399 - sqlalchemy.engine.Engine - INFO - [cached since 15.46s ago] (7517432356, 1, 0)
2025-03-20 18:58:50,401 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:50,402 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:50,403 - sqlalchemy.engine.Engine - INFO - SELECT announcements.id AS announcements_id, announcements.user_id AS announcements_user_id, announcements.announcement_type AS announcements_announcement_type, announcements.image_id AS announcements_image_id, announcements.media_id AS announcements_media_id, announcements.media_type AS announcements_media_type, announcements.description AS announcements_description, announcements.keyword AS announcements_keyword, announcements.created_at AS announcements_created_at 
FROM announcements 
WHERE announcements.user_id = ? AND announcements.announcement_type = ? ORDER BY announcements.created_at DESC
 LIMIT ? OFFSET ?
2025-03-20 18:58:50,403 - sqlalchemy.engine.Engine - INFO - [cached since 0.9151s ago] (7517432356, 'team', 2, 0)
2025-03-20 18:58:50,404 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:50,405 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:50,406 - sqlalchemy.engine.Engine - INFO - SELECT announcements.id AS announcements_id, announcements.user_id AS announcements_user_id, announcements.announcement_type AS announcements_announcement_type, announcements.image_id AS announcements_image_id, announcements.media_id AS announcements_media_id, announcements.media_type AS announcements_media_type, announcements.description AS announcements_description, announcements.keyword AS announcements_keyword, announcements.created_at AS announcements_created_at 
FROM announcements 
WHERE announcements.user_id = ? AND announcements.announcement_type = ? ORDER BY announcements.created_at DESC
 LIMIT ? OFFSET ?
2025-03-20 18:58:50,407 - sqlalchemy.engine.Engine - INFO - [cached since 0.9195s ago] (7517432356, 'team', 2, 0)
2025-03-20 18:58:50,408 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:50,410 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:50,410 - sqlalchemy.engine.Engine - INFO - SELECT announcements.id AS announcements_id, announcements.user_id AS announcements_user_id, announcements.announcement_type AS announcements_announcement_type, announcements.image_id AS announcements_image_id, announcements.media_id AS announcements_media_id, announcements.media_type AS announcements_media_type, announcements.description AS announcements_description, announcements.keyword AS announcements_keyword, announcements.created_at AS announcements_created_at 
FROM announcements 
WHERE announcements.user_id = ? AND announcements.announcement_type = ? ORDER BY announcements.created_at DESC
 LIMIT ? OFFSET ?
2025-03-20 18:58:50,411 - sqlalchemy.engine.Engine - INFO - [cached since 0.9231s ago] (7517432356, 'club', 2, 0)
2025-03-20 18:58:50,412 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:52,577 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:52,578 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:52,578 - sqlalchemy.engine.Engine - INFO - [cached since 17.65s ago] (7115599761, 1, 0)
2025-03-20 18:58:52,580 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:58:52,582 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:58:52,583 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:58:52,610 - sqlalchemy.engine.Engine - INFO - [cached since 17.68s ago] (7115599761, 1, 0)
2025-03-20 18:58:52,611 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:08,591 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:08,592 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:08,592 - sqlalchemy.engine.Engine - INFO - [cached since 33.66s ago] (7115599761, 1, 0)
2025-03-20 18:59:08,593 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:08,594 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:08,594 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:08,594 - sqlalchemy.engine.Engine - INFO - [cached since 33.66s ago] (7115599761, 1, 0)
2025-03-20 18:59:08,595 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:08,596 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:08,597 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:08,597 - sqlalchemy.engine.Engine - INFO - [cached since 33.66s ago] (7115599761, 1, 0)
2025-03-20 18:59:08,597 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:08,598 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:08,598 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:08,598 - sqlalchemy.engine.Engine - INFO - [cached since 33.66s ago] (7115599761, 1, 0)
2025-03-20 18:59:08,599 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:08,600 - handlers.announcement - INFO - Получено фото от user=7115599761
2025-03-20 18:59:08,601 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:08,601 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:08,602 - sqlalchemy.engine.Engine - INFO - [cached since 33.67s ago] (7115599761, 1, 0)
2025-03-20 18:59:08,602 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:10,735 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:10,735 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:10,737 - sqlalchemy.engine.Engine - INFO - [cached since 35.81s ago] (7115599761, 1, 0)
2025-03-20 18:59:10,739 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:10,740 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:10,741 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:10,741 - sqlalchemy.engine.Engine - INFO - [cached since 35.81s ago] (7115599761, 1, 0)
2025-03-20 18:59:10,742 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:17,974 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:17,975 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:17,975 - sqlalchemy.engine.Engine - INFO - [cached since 43.05s ago] (7139312538, 1, 0)
2025-03-20 18:59:17,978 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:17,979 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:17,980 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:17,980 - sqlalchemy.engine.Engine - INFO - [cached since 43.05s ago] (7139312538, 1, 0)
2025-03-20 18:59:17,980 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:17,981 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:17,982 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:18,000 - sqlalchemy.engine.Engine - INFO - [cached since 43.06s ago] (7139312538, 1, 0)
2025-03-20 18:59:18,001 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:18,002 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:18,004 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:18,006 - sqlalchemy.engine.Engine - INFO - [cached since 43.07s ago] (7139312538, 1, 0)
2025-03-20 18:59:18,007 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:20,008 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:20,008 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:20,009 - sqlalchemy.engine.Engine - INFO - [cached since 45.08s ago] (7139312538, 1, 0)
2025-03-20 18:59:20,011 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:20,013 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:20,013 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:20,013 - sqlalchemy.engine.Engine - INFO - [cached since 45.08s ago] (7139312538, 1, 0)
2025-03-20 18:59:20,014 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:20,014 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:20,015 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:20,015 - sqlalchemy.engine.Engine - INFO - [cached since 45.08s ago] (7139312538, 1, 0)
2025-03-20 18:59:20,018 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:20,205 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:20,206 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:20,206 - sqlalchemy.engine.Engine - INFO - [cached since 45.27s ago] (7139312538, 1, 0)
2025-03-20 18:59:20,210 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:20,368 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:20,371 - sqlalchemy.engine.Engine - INFO - SELECT sponsors.id AS sponsors_id, sponsors.name AS sponsors_name, sponsors.link AS sponsors_link, sponsors.channel_id AS sponsors_channel_id, sponsors.reward AS sponsors_reward, sponsors.is_active AS sponsors_is_active, sponsors.created_at AS sponsors_created_at, sponsors.updated_at AS sponsors_updated_at 
FROM sponsors
2025-03-20 18:59:20,372 - sqlalchemy.engine.Engine - INFO - [generated in 0.00079s] ()
2025-03-20 18:59:20,373 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:21,379 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:21,380 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:21,380 - sqlalchemy.engine.Engine - INFO - [cached since 46.45s ago] (7139312538, 1, 0)
2025-03-20 18:59:21,381 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:21,384 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:21,385 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:21,386 - sqlalchemy.engine.Engine - INFO - [cached since 46.46s ago] (7139312538, 1, 0)
2025-03-20 18:59:21,387 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:21,388 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:21,389 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:21,389 - sqlalchemy.engine.Engine - INFO - [cached since 46.45s ago] (7139312538, 1, 0)
2025-03-20 18:59:21,390 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:23,014 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:23,015 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:23,015 - sqlalchemy.engine.Engine - INFO - [cached since 48.09s ago] (7139312538, 1, 0)
2025-03-20 18:59:23,017 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:23,019 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:23,019 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:23,020 - sqlalchemy.engine.Engine - INFO - [cached since 48.09s ago] (7139312538, 1, 0)
2025-03-20 18:59:23,021 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:23,022 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:23,022 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:23,023 - sqlalchemy.engine.Engine - INFO - [cached since 48.09s ago] (7139312538, 1, 0)
2025-03-20 18:59:23,023 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:23,024 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:23,024 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:23,025 - sqlalchemy.engine.Engine - INFO - [cached since 48.09s ago] (7139312538, 1, 0)
2025-03-20 18:59:23,026 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:27,841 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:27,842 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:27,842 - sqlalchemy.engine.Engine - INFO - [cached since 52.91s ago] (7139312538, 1, 0)
2025-03-20 18:59:27,844 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:27,845 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:27,846 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:27,846 - sqlalchemy.engine.Engine - INFO - [cached since 52.92s ago] (7139312538, 1, 0)
2025-03-20 18:59:27,848 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:27,849 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:27,851 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:27,852 - sqlalchemy.engine.Engine - INFO - [cached since 52.92s ago] (7139312538, 1, 0)
2025-03-20 18:59:27,853 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:27,853 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:27,853 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:27,853 - sqlalchemy.engine.Engine - INFO - [cached since 52.92s ago] (7139312538, 1, 0)
2025-03-20 18:59:27,854 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:32,283 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:32,283 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:32,284 - sqlalchemy.engine.Engine - INFO - [cached since 57.35s ago] (7139312538, 1, 0)
2025-03-20 18:59:32,285 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:32,287 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:32,288 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:32,289 - sqlalchemy.engine.Engine - INFO - [cached since 57.36s ago] (7139312538, 1, 0)
2025-03-20 18:59:32,290 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:32,291 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:32,292 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:32,292 - sqlalchemy.engine.Engine - INFO - [cached since 57.36s ago] (7139312538, 1, 0)
2025-03-20 18:59:32,293 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:32,294 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:32,295 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:32,296 - sqlalchemy.engine.Engine - INFO - [cached since 57.36s ago] (7139312538, 1, 0)
2025-03-20 18:59:32,297 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:34,604 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:34,604 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:34,605 - sqlalchemy.engine.Engine - INFO - [cached since 59.67s ago] (7139312538, 1, 0)
2025-03-20 18:59:34,605 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:34,606 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:34,607 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:34,608 - sqlalchemy.engine.Engine - INFO - [cached since 59.68s ago] (7139312538, 1, 0)
2025-03-20 18:59:34,608 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:34,609 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:34,609 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:34,610 - sqlalchemy.engine.Engine - INFO - [cached since 59.68s ago] (7139312538, 1, 0)
2025-03-20 18:59:34,611 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:34,611 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:34,612 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 18:59:34,612 - sqlalchemy.engine.Engine - INFO - [cached since 59.68s ago] (7139312538, 1, 0)
2025-03-20 18:59:34,613 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 18:59:34,614 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:34,615 - sqlalchemy.engine.Engine - INFO - INSERT INTO sponsors (name, link, channel_id, reward, is_active, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-03-20 18:59:34,615 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] ('test', 'https://t.me/obrientest1', '-1002294041672', 10, 1, '2025-03-20 16:59:34.615661', '2025-03-20 16:59:34.615661')
2025-03-20 18:59:34,617 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 18:59:34,713 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 18:59:34,714 - sqlalchemy.engine.Engine - INFO - SELECT sponsors.id AS sponsors_id, sponsors.name AS sponsors_name, sponsors.link AS sponsors_link, sponsors.channel_id AS sponsors_channel_id, sponsors.reward AS sponsors_reward, sponsors.is_active AS sponsors_is_active, sponsors.created_at AS sponsors_created_at, sponsors.updated_at AS sponsors_updated_at 
FROM sponsors
2025-03-20 18:59:34,714 - sqlalchemy.engine.Engine - INFO - [cached since 14.34s ago] ()
2025-03-20 18:59:34,715 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:10,190 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:10,190 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:10,191 - sqlalchemy.engine.Engine - INFO - [cached since 95.26s ago] (7115599761, 1, 0)
2025-03-20 19:00:10,192 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:10,194 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:10,194 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:10,195 - sqlalchemy.engine.Engine - INFO - [cached since 95.26s ago] (7115599761, 1, 0)
2025-03-20 19:00:10,195 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:10,196 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:10,198 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:10,198 - sqlalchemy.engine.Engine - INFO - [cached since 95.26s ago] (7115599761, 1, 0)
2025-03-20 19:00:10,199 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:10,199 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:10,200 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:10,200 - sqlalchemy.engine.Engine - INFO - [cached since 95.27s ago] (7115599761, 1, 0)
2025-03-20 19:00:10,201 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:10,201 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:10,202 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:10,202 - sqlalchemy.engine.Engine - INFO - [cached since 95.27s ago] (7115599761, 1, 0)
2025-03-20 19:00:10,202 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:10,204 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:10,204 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:10,204 - sqlalchemy.engine.Engine - INFO - [cached since 95.27s ago] (7115599761, 1, 0)
2025-03-20 19:00:10,204 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:12,393 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:12,465 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:12,472 - sqlalchemy.engine.Engine - INFO - [cached since 97.54s ago] (7115599761, 1, 0)
2025-03-20 19:00:12,477 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:12,479 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:12,482 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:12,483 - sqlalchemy.engine.Engine - INFO - [cached since 97.55s ago] (7115599761, 1, 0)
2025-03-20 19:00:12,524 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:12,526 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:12,533 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:12,539 - sqlalchemy.engine.Engine - INFO - [cached since 97.6s ago] (7115599761, 1, 0)
2025-03-20 19:00:12,542 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:13,861 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:13,861 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:13,863 - sqlalchemy.engine.Engine - INFO - [cached since 98.93s ago] (7115599761, 1, 0)
2025-03-20 19:00:13,864 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:13,865 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:13,866 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:13,866 - sqlalchemy.engine.Engine - INFO - [cached since 98.94s ago] (7115599761, 1, 0)
2025-03-20 19:00:13,867 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:13,868 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:13,868 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:13,869 - sqlalchemy.engine.Engine - INFO - [cached since 98.93s ago] (7115599761, 1, 0)
2025-03-20 19:00:13,872 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:14,017 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:14,020 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:14,021 - sqlalchemy.engine.Engine - INFO - [cached since 99.09s ago] (7115599761, 1, 0)
2025-03-20 19:00:14,079 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:14,081 - sqlalchemy.engine.Engine - INFO - [cached since 86.46s ago] (1, 'gift', 1, 0)
2025-03-20 19:00:14,082 - sqlalchemy.engine.Engine - INFO - INSERT INTO user_visited_sections (user_id, section, visited_at) VALUES (?, ?, ?)
2025-03-20 19:00:14,082 - sqlalchemy.engine.Engine - INFO - [cached since 86.46s ago] (1, 'gift', '2025-03-20 17:00:14.082957')
2025-03-20 19:00:14,087 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 19:00:14,094 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:14,095 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
2025-03-20 19:00:14,095 - sqlalchemy.engine.Engine - INFO - [cached since 86.46s ago] (1,)
2025-03-20 19:00:14,098 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.section AS user_visited_sections_section 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section IN (?, ?, ?, ?, ?, ?)
2025-03-20 19:00:14,100 - sqlalchemy.engine.Engine - INFO - [cached since 86.47s ago] (1, 'search_team_menu', 'search_club_menu', 'crystals', 'premium', 'additional', 'gift')
2025-03-20 19:00:14,101 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:14,942 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:14,942 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:14,943 - sqlalchemy.engine.Engine - INFO - [cached since 100s ago] (7115599761, 1, 0)
2025-03-20 19:00:14,944 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:14,945 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:14,945 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:14,945 - sqlalchemy.engine.Engine - INFO - [cached since 100s ago] (7115599761, 1, 0)
2025-03-20 19:00:14,946 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:14,947 - handlers.gift - INFO - Пользователь 7115599761 запросил подарок
2025-03-20 19:00:14,947 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:14,948 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:14,948 - sqlalchemy.engine.Engine - INFO - [cached since 100s ago] (7115599761, 1, 0)
2025-03-20 19:00:14,950 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:15,065 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:15,065 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:15,066 - sqlalchemy.engine.Engine - INFO - [cached since 100.1s ago] (7115599761, 1, 0)
2025-03-20 19:00:15,068 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:15,069 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:15,069 - sqlalchemy.engine.Engine - INFO - [cached since 100.1s ago] (7115599761, 1, 0)
2025-03-20 19:00:15,071 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:15,072 - handlers.gift - INFO - Пользователь 7115599761 премиум: False
2025-03-20 19:00:15,072 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:15,075 - sqlalchemy.engine.Engine - INFO - SELECT sponsors.id AS sponsors_id, sponsors.name AS sponsors_name, sponsors.link AS sponsors_link, sponsors.channel_id AS sponsors_channel_id, sponsors.reward AS sponsors_reward, sponsors.is_active AS sponsors_is_active, sponsors.created_at AS sponsors_created_at, sponsors.updated_at AS sponsors_updated_at 
FROM sponsors 
WHERE sponsors.is_active = 1
2025-03-20 19:00:15,076 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] ()
2025-03-20 19:00:15,077 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:15,078 - handlers.gift - INFO - Найдено активных спонсоров: 1
2025-03-20 19:00:15,078 - handlers.gift - INFO - Проверка подписки пользователя 7115599761 на спонсора test (ID: 1)
2025-03-20 19:00:15,078 - utils.helpers - INFO - Проверка подписки пользователя 7115599761 на канал -1002294041672
2025-03-20 19:00:15,203 - utils.helpers - INFO - Статус подписки пользователя 7115599761 на канал -1002294041672: member
2025-03-20 19:00:15,203 - utils.helpers - INFO - Результат проверки подписки: True
2025-03-20 19:00:15,204 - handlers.gift - INFO - Результат проверки подписки на test: True
2025-03-20 19:00:15,205 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:15,208 - sqlalchemy.engine.Engine - INFO - SELECT user_sponsor_subscriptions.id AS user_sponsor_subscriptions_id, user_sponsor_subscriptions.user_tg_id AS user_sponsor_subscriptions_user_tg_id, user_sponsor_subscriptions.sponsor_id AS user_sponsor_subscriptions_sponsor_id, user_sponsor_subscriptions.created_at AS user_sponsor_subscriptions_created_at 
FROM user_sponsor_subscriptions 
WHERE user_sponsor_subscriptions.user_tg_id = ? AND user_sponsor_subscriptions.sponsor_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:15,208 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] (7115599761, 1, 1, 0)
2025-03-20 19:00:15,211 - sqlalchemy.engine.Engine - INFO - INSERT INTO user_sponsor_subscriptions (user_tg_id, sponsor_id, created_at) VALUES (?, ?, ?)
2025-03-20 19:00:15,212 - sqlalchemy.engine.Engine - INFO - [generated in 0.00174s] (7115599761, 1, '2025-03-20 17:00:15.211420')
2025-03-20 19:00:15,218 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 19:00:15,223 - handlers.gift - INFO - Добавлена запись о подписке пользователя 7115599761 на спонсора test
2025-03-20 19:00:15,225 - handlers.gift - INFO - Пользователь 7115599761 подписан на всех спонсоров
2025-03-20 19:00:15,225 - handlers.gift - INFO - Вторичная проверка подписок пользователя 7115599761
2025-03-20 19:00:15,226 - utils.helpers - INFO - Проверка подписки пользователя 7115599761 на канал -1002294041672
2025-03-20 19:00:15,268 - utils.helpers - INFO - Статус подписки пользователя 7115599761 на канал -1002294041672: member
2025-03-20 19:00:15,268 - utils.helpers - INFO - Результат проверки подписки: True
2025-03-20 19:00:15,268 - handlers.gift - INFO - Вторичная проверка подписки на test: True
2025-03-20 19:00:15,268 - handlers.gift - INFO - Пользователь 7115599761 прошел вторичную проверку подписок
2025-03-20 19:00:15,268 - handlers.gift - INFO - Выдача подарка пользователю 7115599761: 27 монет
2025-03-20 19:00:15,269 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:15,270 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:15,270 - sqlalchemy.engine.Engine - INFO - [cached since 100.3s ago] (7115599761, 1, 0)
2025-03-20 19:00:15,272 - sqlalchemy.engine.Engine - INFO - UPDATE users SET last_gift=?, updated_at=? WHERE users.id = ?
2025-03-20 19:00:15,273 - sqlalchemy.engine.Engine - INFO - [generated in 0.00127s] ('2025-03-20 19:00:15.271641', '2025-03-20 17:00:15.272641', 1)
2025-03-20 19:00:15,277 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 19:00:15,281 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:15,283 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:15,283 - sqlalchemy.engine.Engine - INFO - [cached since 100.3s ago] (7115599761, 1, 0)
2025-03-20 19:00:15,286 - sqlalchemy.engine.Engine - INFO - UPDATE users SET updated_at=?, coins=? WHERE users.id = ?
2025-03-20 19:00:15,287 - sqlalchemy.engine.Engine - INFO - [generated in 0.00107s] ('2025-03-20 17:00:15.286704', 27, 1)
2025-03-20 19:00:15,290 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 19:00:15,295 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:15,296 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:15,296 - sqlalchemy.engine.Engine - INFO - [cached since 100.4s ago] (7115599761, 1, 0)
2025-03-20 19:00:15,297 - sqlalchemy.engine.Engine - INFO - SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements 
WHERE achievements."key" = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:15,298 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] ('lucky', 1, 0)
2025-03-20 19:00:15,300 - sqlalchemy.engine.Engine - INFO - SELECT user_achievements.id AS user_achievements_id, user_achievements.user_id AS user_achievements_user_id, user_achievements.achievement_id AS user_achievements_achievement_id, user_achievements.achieved_at AS user_achievements_achieved_at 
FROM user_achievements 
WHERE user_achievements.user_id = ? AND user_achievements.achievement_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:15,301 - sqlalchemy.engine.Engine - INFO - [generated in 0.00124s] (1, 7, 1, 0)
2025-03-20 19:00:15,304 - sqlalchemy.engine.Engine - INFO - INSERT INTO user_achievements (user_id, achievement_id, achieved_at) VALUES (?, ?, ?)
2025-03-20 19:00:15,304 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] (1, 7, '2025-03-20 17:00:15.304636')
2025-03-20 19:00:15,309 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 19:00:15,441 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:22,652 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:22,652 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:22,653 - sqlalchemy.engine.Engine - INFO - [cached since 107.7s ago] (8053357241, 1, 0)
2025-03-20 19:00:22,654 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:22,655 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:22,657 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:22,657 - sqlalchemy.engine.Engine - INFO - [cached since 107.7s ago] (8053357241, 1, 0)
2025-03-20 19:00:22,658 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:22,658 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:22,659 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:22,659 - sqlalchemy.engine.Engine - INFO - [cached since 107.7s ago] (8053357241, 1, 0)
2025-03-20 19:00:22,659 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:22,660 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:22,661 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:22,662 - sqlalchemy.engine.Engine - INFO - [cached since 107.7s ago] (8053357241, 1, 0)
2025-03-20 19:00:22,663 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:22,665 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:22,665 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:22,665 - sqlalchemy.engine.Engine - INFO - [cached since 107.7s ago] (8053357241, 1, 0)
2025-03-20 19:00:22,666 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:22,666 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:22,667 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:22,668 - sqlalchemy.engine.Engine - INFO - [cached since 107.7s ago] (8053357241, 1, 0)
2025-03-20 19:00:22,669 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:22,671 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:22,671 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:22,671 - sqlalchemy.engine.Engine - INFO - [cached since 107.7s ago] (8053357241, 1, 0)
2025-03-20 19:00:22,672 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (tg_id, username, first_name, is_premium, premium_end_date, crystals, language, blocked, last_gift, created_at, updated_at, coins, premium_until) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-03-20 19:00:22,672 - sqlalchemy.engine.Engine - INFO - [cached since 107.7s ago] (8053357241, 'maksmaksimov12', 'Maks', 0, None, 100, 'ru', 0, None, '2025-03-20 19:00:22.671261', '2025-03-20 17:00:22.672258', 0, None)
2025-03-20 19:00:22,673 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 19:00:24,015 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:24,016 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:24,017 - sqlalchemy.engine.Engine - INFO - [cached since 109.1s ago] (8053357241, 1, 0)
2025-03-20 19:00:24,019 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:24,020 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:24,020 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:24,020 - sqlalchemy.engine.Engine - INFO - [cached since 109.1s ago] (8053357241, 1, 0)
2025-03-20 19:00:24,021 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:24,021 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:24,022 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:24,023 - sqlalchemy.engine.Engine - INFO - [cached since 109.1s ago] (8053357241, 1, 0)
2025-03-20 19:00:24,025 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:25,449 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:25,450 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:25,450 - sqlalchemy.engine.Engine - INFO - [cached since 110.5s ago] (8053357241, 1, 0)
2025-03-20 19:00:25,452 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:25,454 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:25,454 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:25,455 - sqlalchemy.engine.Engine - INFO - [cached since 110.5s ago] (8053357241, 1, 0)
2025-03-20 19:00:25,455 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:25,457 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:25,457 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:25,458 - sqlalchemy.engine.Engine - INFO - [cached since 110.5s ago] (8053357241, 1, 0)
2025-03-20 19:00:25,459 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:25,528 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:25,542 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:25,545 - sqlalchemy.engine.Engine - INFO - [cached since 110.6s ago] (8053357241, 1, 0)
2025-03-20 19:00:25,598 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:25,612 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:25,613 - sqlalchemy.engine.Engine - INFO - [cached since 110.7s ago] (8053357241, 1, 0)
2025-03-20 19:00:25,616 - sqlalchemy.engine.Engine - INFO - SELECT user_achievements.id AS user_achievements_id, user_achievements.user_id AS user_achievements_user_id, user_achievements.achievement_id AS user_achievements_achievement_id, user_achievements.achieved_at AS user_achievements_achieved_at, achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM user_achievements JOIN achievements ON user_achievements.achievement_id = achievements.id 
WHERE user_achievements.user_id = ?
2025-03-20 19:00:25,616 - sqlalchemy.engine.Engine - INFO - [cached since 108.6s ago] (2,)
2025-03-20 19:00:25,617 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:25,618 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:25,618 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:25,618 - sqlalchemy.engine.Engine - INFO - [cached since 110.7s ago] (8053357241, 1, 0)
2025-03-20 19:00:25,619 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:25,621 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:26,818 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:26,871 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:26,872 - sqlalchemy.engine.Engine - INFO - [cached since 111.9s ago] (8053357241, 1, 0)
2025-03-20 19:00:26,873 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:26,878 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:26,893 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:26,893 - sqlalchemy.engine.Engine - INFO - [cached since 112s ago] (8053357241, 1, 0)
2025-03-20 19:00:26,894 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:26,895 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:26,910 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:26,914 - sqlalchemy.engine.Engine - INFO - [cached since 112s ago] (8053357241, 1, 0)
2025-03-20 19:00:26,918 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:26,974 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:26,975 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:26,976 - sqlalchemy.engine.Engine - INFO - [cached since 112s ago] (8053357241, 1, 0)
2025-03-20 19:00:26,979 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:26,980 - sqlalchemy.engine.Engine - INFO - [cached since 99.36s ago] (2, 'gift', 1, 0)
2025-03-20 19:00:26,982 - sqlalchemy.engine.Engine - INFO - INSERT INTO user_visited_sections (user_id, section, visited_at) VALUES (?, ?, ?)
2025-03-20 19:00:26,982 - sqlalchemy.engine.Engine - INFO - [cached since 99.36s ago] (2, 'gift', '2025-03-20 17:00:26.981196')
2025-03-20 19:00:26,985 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-20 19:00:26,990 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:26,991 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
2025-03-20 19:00:26,991 - sqlalchemy.engine.Engine - INFO - [cached since 99.36s ago] (2,)
2025-03-20 19:00:26,993 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.section AS user_visited_sections_section 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section IN (?, ?, ?, ?, ?, ?)
2025-03-20 19:00:26,994 - sqlalchemy.engine.Engine - INFO - [cached since 99.36s ago] (2, 'search_team_menu', 'search_club_menu', 'crystals', 'premium', 'additional', 'gift')
2025-03-20 19:00:26,995 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:27,545 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:27,545 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:27,546 - sqlalchemy.engine.Engine - INFO - [cached since 112.6s ago] (8053357241, 1, 0)
2025-03-20 19:00:27,547 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:27,549 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:27,550 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:27,550 - sqlalchemy.engine.Engine - INFO - [cached since 112.6s ago] (8053357241, 1, 0)
2025-03-20 19:00:27,552 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:27,552 - handlers.gift - INFO - Пользователь 8053357241 запросил подарок
2025-03-20 19:00:27,553 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:27,554 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:27,554 - sqlalchemy.engine.Engine - INFO - [cached since 112.6s ago] (8053357241, 1, 0)
2025-03-20 19:00:27,558 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:27,611 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:27,611 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:27,611 - sqlalchemy.engine.Engine - INFO - [cached since 112.7s ago] (8053357241, 1, 0)
2025-03-20 19:00:27,614 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:27,614 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-20 19:00:27,615 - sqlalchemy.engine.Engine - INFO - [cached since 112.7s ago] (8053357241, 1, 0)
2025-03-20 19:00:27,616 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:27,617 - handlers.gift - INFO - Пользователь 8053357241 премиум: False
2025-03-20 19:00:27,619 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-20 19:00:27,621 - sqlalchemy.engine.Engine - INFO - SELECT sponsors.id AS sponsors_id, sponsors.name AS sponsors_name, sponsors.link AS sponsors_link, sponsors.channel_id AS sponsors_channel_id, sponsors.reward AS sponsors_reward, sponsors.is_active AS sponsors_is_active, sponsors.created_at AS sponsors_created_at, sponsors.updated_at AS sponsors_updated_at 
FROM sponsors 
WHERE sponsors.is_active = 1
2025-03-20 19:00:27,622 - sqlalchemy.engine.Engine - INFO - [cached since 12.55s ago] ()
2025-03-20 19:00:27,623 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:27,623 - handlers.gift - INFO - Найдено активных спонсоров: 1
2025-03-20 19:00:27,623 - handlers.gift - INFO - Проверка подписки пользователя 8053357241 на спонсора test (ID: 1)
2025-03-20 19:00:27,623 - utils.helpers - INFO - Проверка подписки пользователя 8053357241 на канал -1002294041672
2025-03-20 19:00:27,673 - utils.helpers - INFO - Статус подписки пользователя 8053357241 на канал -1002294041672: left
2025-03-20 19:00:27,673 - utils.helpers - INFO - Результат проверки подписки: False
2025-03-20 19:00:27,674 - handlers.gift - INFO - Результат проверки подписки на test: False
2025-03-20 19:00:27,674 - handlers.gift - INFO - Пользователь 8053357241 не подписан на спонсора test
2025-03-20 19:00:27,674 - handlers.gift - INFO - Пользователь 8053357241 не подписан на всех спонсоров. Неподписанные спонсоры: ['test']
2025-03-20 19:00:27,780 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-20 19:00:31,310 - aiogram.dispatcher.dispatcher - INFO - Stop polling...
2025-03-20 19:00:31,310 - aiogram - WARNING - Goodbye!
2025-03-21 14:46:18,195 - __main__ - INFO - Запуск бота...
2025-03-21 14:46:18,492 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:18,492 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-03-21 14:46:18,493 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:46:18,498 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referrals")
2025-03-21 14:46:18,499 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:46:18,499 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("announcements")
2025-03-21 14:46:18,499 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:46:18,501 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("reports")
2025-03-21 14:46:18,501 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:46:18,501 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("favorites")
2025-03-21 14:46:18,502 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:46:18,502 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("crystal_transactions")
2025-03-21 14:46:18,502 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:46:18,503 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("premium_prices")
2025-03-21 14:46:18,504 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:46:18,504 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sponsors")
2025-03-21 14:46:18,504 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:46:18,505 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_sponsor_subscriptions")
2025-03-21 14:46:18,505 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:46:18,505 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_codes")
2025-03-21 14:46:18,505 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:46:18,506 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_uses")
2025-03-21 14:46:18,506 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:46:18,506 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-03-21 14:46:18,506 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:46:18,506 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_achievements")
2025-03-21 14:46:18,506 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:46:18,507 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_visited_sections")
2025-03-21 14:46:18,507 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:46:18,507 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_secret_purchases")
2025-03-21 14:46:18,507 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:46:18,508 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("bot_settings")
2025-03-21 14:46:18,508 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:46:18,508 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:46:18,534 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:18,540 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:18,541 - sqlalchemy.engine.Engine - INFO - [generated in 0.00142s] (30, 1, 0)
2025-03-21 14:46:18,542 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:18,542 - sqlalchemy.engine.Engine - INFO - [cached since 0.002766s ago] (180, 1, 0)
2025-03-21 14:46:18,542 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:18,543 - sqlalchemy.engine.Engine - INFO - [cached since 0.0035s ago] (365, 1, 0)
2025-03-21 14:46:18,543 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:18,544 - sqlalchemy.engine.Engine - INFO - [cached since 0.004394s ago] (36500, 1, 0)
2025-03-21 14:46:18,544 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:46:18,559 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:18,564 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements) AS anon_1
2025-03-21 14:46:18,564 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] ()
2025-03-21 14:46:18,565 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:18,567 - root - INFO - Achievements handlers registered successfully
2025-03-21 14:46:18,742 - aiogram - INFO - Bot: Бубсер Поиск Бот [@Bubser_PoiskBot]
2025-03-21 14:46:18,822 - aiogram - WARNING - Updates were skipped successfully.
2025-03-21 14:46:18,823 - __main__ - INFO - Бот успешно запущен!
2025-03-21 14:46:18,823 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:18,826 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.tg_id, users.username, users.first_name, users.is_premium, users.premium_end_date, users.crystals, users.language, users.blocked, users.last_gift, users.created_at, users.updated_at, users.coins, users.premium_until 
FROM users 
WHERE users.is_premium = 1 AND users.premium_end_date <= ?
2025-03-21 14:46:18,826 - sqlalchemy.engine.Engine - INFO - [generated in 0.00070s] ('2025-03-21 14:46:18.823320',)
2025-03-21 14:46:18,828 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:46:18,829 - aiogram.dispatcher.dispatcher - INFO - Start polling.
2025-03-21 14:46:27,582 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:27,585 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:27,585 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] (7139312538, 1, 0)
2025-03-21 14:46:27,585 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:27,586 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:27,586 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:27,587 - sqlalchemy.engine.Engine - INFO - [cached since 0.002828s ago] (7139312538, 1, 0)
2025-03-21 14:46:27,587 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:27,588 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:27,590 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:27,591 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] (7139312538, 1, 0)
2025-03-21 14:46:27,591 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:27,592 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:27,592 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:27,592 - sqlalchemy.engine.Engine - INFO - [cached since 0.002373s ago] (7139312538, 1, 0)
2025-03-21 14:46:27,593 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:27,593 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:27,594 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:27,594 - sqlalchemy.engine.Engine - INFO - [cached since 0.004848s ago] (7139312538, 1, 0)
2025-03-21 14:46:27,596 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:27,596 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:27,596 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:27,596 - sqlalchemy.engine.Engine - INFO - [cached since 0.006381s ago] (7139312538, 1, 0)
2025-03-21 14:46:27,597 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:27,597 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:27,597 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:27,597 - sqlalchemy.engine.Engine - INFO - [cached since 0.007416s ago] (7139312538, 1, 0)
2025-03-21 14:46:27,599 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (tg_id, username, first_name, is_premium, premium_end_date, crystals, language, blocked, last_gift, created_at, updated_at, coins, premium_until) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-03-21 14:46:27,599 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] (7139312538, 'nowoyaz', "O'Brien", 0, None, 100, 'ru', 0, None, '2025-03-21 14:46:27.598492', '2025-03-21 12:46:27.599489', 0, None)
2025-03-21 14:46:27,602 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:46:29,503 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:29,504 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:29,505 - sqlalchemy.engine.Engine - INFO - [cached since 1.921s ago] (7139312538, 1, 0)
2025-03-21 14:46:29,506 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:29,507 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:29,507 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:29,508 - sqlalchemy.engine.Engine - INFO - [cached since 1.924s ago] (7139312538, 1, 0)
2025-03-21 14:46:29,509 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:29,510 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:29,510 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:29,511 - sqlalchemy.engine.Engine - INFO - [cached since 1.921s ago] (7139312538, 1, 0)
2025-03-21 14:46:29,511 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:29,512 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:29,512 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:29,512 - sqlalchemy.engine.Engine - INFO - [cached since 1.922s ago] (7139312538, 1, 0)
2025-03-21 14:46:29,513 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:31,648 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:31,649 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:31,649 - sqlalchemy.engine.Engine - INFO - [cached since 4.065s ago] (7139312538, 1, 0)
2025-03-21 14:46:31,650 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:31,653 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:31,653 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:31,653 - sqlalchemy.engine.Engine - INFO - [cached since 4.07s ago] (7139312538, 1, 0)
2025-03-21 14:46:31,655 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:31,655 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:31,655 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:31,656 - sqlalchemy.engine.Engine - INFO - [cached since 4.065s ago] (7139312538, 1, 0)
2025-03-21 14:46:31,658 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:31,707 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:31,708 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:31,708 - sqlalchemy.engine.Engine - INFO - [cached since 4.118s ago] (7139312538, 1, 0)
2025-03-21 14:46:31,710 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:31,753 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:31,755 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes
2025-03-21 14:46:31,756 - sqlalchemy.engine.Engine - INFO - [generated in 0.00130s] ()
2025-03-21 14:46:31,758 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:32,522 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:32,523 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:32,523 - sqlalchemy.engine.Engine - INFO - [cached since 4.939s ago] (7139312538, 1, 0)
2025-03-21 14:46:32,523 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:32,527 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:32,528 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:32,528 - sqlalchemy.engine.Engine - INFO - [cached since 4.944s ago] (7139312538, 1, 0)
2025-03-21 14:46:32,529 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:32,530 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:32,530 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:32,530 - sqlalchemy.engine.Engine - INFO - [cached since 4.94s ago] (7139312538, 1, 0)
2025-03-21 14:46:32,532 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:34,447 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:34,449 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:34,450 - sqlalchemy.engine.Engine - INFO - [cached since 6.866s ago] (7139312538, 1, 0)
2025-03-21 14:46:34,451 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:34,452 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:34,453 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:34,454 - sqlalchemy.engine.Engine - INFO - [cached since 6.87s ago] (7139312538, 1, 0)
2025-03-21 14:46:34,456 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:34,457 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:34,458 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:34,458 - sqlalchemy.engine.Engine - INFO - [cached since 6.868s ago] (7139312538, 1, 0)
2025-03-21 14:46:34,459 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:34,460 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:34,460 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:34,460 - sqlalchemy.engine.Engine - INFO - [cached since 6.87s ago] (7139312538, 1, 0)
2025-03-21 14:46:34,461 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:35,828 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:35,829 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:35,829 - sqlalchemy.engine.Engine - INFO - [cached since 8.245s ago] (7139312538, 1, 0)
2025-03-21 14:46:35,831 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:35,833 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:35,833 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:35,833 - sqlalchemy.engine.Engine - INFO - [cached since 8.249s ago] (7139312538, 1, 0)
2025-03-21 14:46:35,833 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:35,834 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:35,834 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:35,835 - sqlalchemy.engine.Engine - INFO - [cached since 8.245s ago] (7139312538, 1, 0)
2025-03-21 14:46:35,836 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:36,497 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:36,498 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:36,498 - sqlalchemy.engine.Engine - INFO - [cached since 8.914s ago] (7139312538, 1, 0)
2025-03-21 14:46:36,499 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:36,499 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:36,500 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:36,500 - sqlalchemy.engine.Engine - INFO - [cached since 8.916s ago] (7139312538, 1, 0)
2025-03-21 14:46:36,500 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:36,501 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:36,501 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:36,501 - sqlalchemy.engine.Engine - INFO - [cached since 8.911s ago] (7139312538, 1, 0)
2025-03-21 14:46:36,502 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:37,373 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:37,373 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:37,374 - sqlalchemy.engine.Engine - INFO - [cached since 9.79s ago] (7139312538, 1, 0)
2025-03-21 14:46:37,376 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:37,377 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:37,378 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:37,378 - sqlalchemy.engine.Engine - INFO - [cached since 9.793s ago] (7139312538, 1, 0)
2025-03-21 14:46:37,379 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:37,379 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:37,380 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:37,380 - sqlalchemy.engine.Engine - INFO - [cached since 9.79s ago] (7139312538, 1, 0)
2025-03-21 14:46:37,381 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:37,496 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:37,499 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:37,499 - sqlalchemy.engine.Engine - INFO - [generated in 0.00071s] ('TEST', 1, 0)
2025-03-21 14:46:37,503 - sqlalchemy.engine.Engine - INFO - INSERT INTO promo_codes (code, duration_days, max_uses, uses_count, is_active, created_at, expires_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-03-21 14:46:37,504 - sqlalchemy.engine.Engine - INFO - [generated in 0.00125s] ('TEST', 7, 5, 0, 1, '2025-03-21 12:46:37.503139', '2025-03-28 12:46:37.495587')
2025-03-21 14:46:37,507 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:46:37,511 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:37,512 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id, promo_codes.code, promo_codes.duration_days, promo_codes.max_uses, promo_codes.uses_count, promo_codes.is_active, promo_codes.created_at, promo_codes.expires_at 
FROM promo_codes 
WHERE promo_codes.id = ?
2025-03-21 14:46:37,513 - sqlalchemy.engine.Engine - INFO - [generated in 0.00108s] (1,)
2025-03-21 14:46:37,514 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:38,411 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:38,412 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:38,412 - sqlalchemy.engine.Engine - INFO - [cached since 10.83s ago] (7139312538, 1, 0)
2025-03-21 14:46:38,413 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:38,416 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:38,417 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:38,417 - sqlalchemy.engine.Engine - INFO - [cached since 10.83s ago] (7139312538, 1, 0)
2025-03-21 14:46:38,418 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:38,418 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:38,419 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:38,419 - sqlalchemy.engine.Engine - INFO - [cached since 10.83s ago] (7139312538, 1, 0)
2025-03-21 14:46:38,421 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:39,209 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:39,210 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:39,210 - sqlalchemy.engine.Engine - INFO - [cached since 11.63s ago] (7139312538, 1, 0)
2025-03-21 14:46:39,211 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:39,214 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:39,215 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:39,215 - sqlalchemy.engine.Engine - INFO - [cached since 11.63s ago] (7139312538, 1, 0)
2025-03-21 14:46:39,215 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:39,216 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:39,216 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:39,216 - sqlalchemy.engine.Engine - INFO - [cached since 11.63s ago] (7139312538, 1, 0)
2025-03-21 14:46:39,217 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:39,268 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:39,270 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:39,270 - sqlalchemy.engine.Engine - INFO - [cached since 11.68s ago] (7139312538, 1, 0)
2025-03-21 14:46:39,272 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:39,322 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:39,323 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes
2025-03-21 14:46:39,323 - sqlalchemy.engine.Engine - INFO - [cached since 7.568s ago] ()
2025-03-21 14:46:39,325 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:41,087 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:41,088 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:41,088 - sqlalchemy.engine.Engine - INFO - [cached since 13.5s ago] (7139312538, 1, 0)
2025-03-21 14:46:41,089 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:41,089 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:41,089 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:41,089 - sqlalchemy.engine.Engine - INFO - [cached since 13.51s ago] (7139312538, 1, 0)
2025-03-21 14:46:41,089 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:41,090 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:41,090 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:41,090 - sqlalchemy.engine.Engine - INFO - [cached since 13.5s ago] (7139312538, 1, 0)
2025-03-21 14:46:41,092 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:42,436 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:42,437 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:42,438 - sqlalchemy.engine.Engine - INFO - [cached since 14.85s ago] (7139312538, 1, 0)
2025-03-21 14:46:42,439 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:42,441 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:42,441 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:42,442 - sqlalchemy.engine.Engine - INFO - [cached since 14.86s ago] (7139312538, 1, 0)
2025-03-21 14:46:42,442 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:42,442 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:42,443 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:42,443 - sqlalchemy.engine.Engine - INFO - [cached since 14.85s ago] (7139312538, 1, 0)
2025-03-21 14:46:42,443 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:42,443 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:42,443 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:42,443 - sqlalchemy.engine.Engine - INFO - [cached since 14.85s ago] (7139312538, 1, 0)
2025-03-21 14:46:42,445 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:43,624 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:43,625 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:43,625 - sqlalchemy.engine.Engine - INFO - [cached since 16.04s ago] (7139312538, 1, 0)
2025-03-21 14:46:43,627 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:43,628 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:43,628 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:43,629 - sqlalchemy.engine.Engine - INFO - [cached since 16.04s ago] (7139312538, 1, 0)
2025-03-21 14:46:43,630 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:43,630 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:43,631 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:43,631 - sqlalchemy.engine.Engine - INFO - [cached since 16.04s ago] (7139312538, 1, 0)
2025-03-21 14:46:43,632 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:44,347 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:44,347 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:44,348 - sqlalchemy.engine.Engine - INFO - [cached since 16.76s ago] (7139312538, 1, 0)
2025-03-21 14:46:44,349 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:44,349 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:44,349 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:44,350 - sqlalchemy.engine.Engine - INFO - [cached since 16.77s ago] (7139312538, 1, 0)
2025-03-21 14:46:44,350 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:44,351 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:44,351 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:44,351 - sqlalchemy.engine.Engine - INFO - [cached since 16.76s ago] (7139312538, 1, 0)
2025-03-21 14:46:44,352 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:45,056 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:45,056 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:45,057 - sqlalchemy.engine.Engine - INFO - [cached since 17.47s ago] (7139312538, 1, 0)
2025-03-21 14:46:45,058 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:45,060 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:45,061 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:45,062 - sqlalchemy.engine.Engine - INFO - [cached since 17.48s ago] (7139312538, 1, 0)
2025-03-21 14:46:45,062 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:45,063 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:45,063 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:45,063 - sqlalchemy.engine.Engine - INFO - [cached since 17.47s ago] (7139312538, 1, 0)
2025-03-21 14:46:45,064 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:45,126 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:45,127 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:45,128 - sqlalchemy.engine.Engine - INFO - [cached since 7.629s ago] ('TEST2', 1, 0)
2025-03-21 14:46:45,129 - sqlalchemy.engine.Engine - INFO - INSERT INTO promo_codes (code, duration_days, max_uses, uses_count, is_active, created_at, expires_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-03-21 14:46:45,130 - sqlalchemy.engine.Engine - INFO - [cached since 7.627s ago] ('TEST2', 7, 5, 0, 1, '2025-03-21 12:46:45.129006', '2025-03-28 12:46:45.126008')
2025-03-21 14:46:45,132 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:46:45,137 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:45,139 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id, promo_codes.code, promo_codes.duration_days, promo_codes.max_uses, promo_codes.uses_count, promo_codes.is_active, promo_codes.created_at, promo_codes.expires_at 
FROM promo_codes 
WHERE promo_codes.id = ?
2025-03-21 14:46:45,139 - sqlalchemy.engine.Engine - INFO - [cached since 7.627s ago] (2,)
2025-03-21 14:46:45,140 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:46,985 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:46,986 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:46,986 - sqlalchemy.engine.Engine - INFO - [cached since 19.4s ago] (7139312538, 1, 0)
2025-03-21 14:46:46,987 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:46,987 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:46,987 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:46,988 - sqlalchemy.engine.Engine - INFO - [cached since 19.4s ago] (7139312538, 1, 0)
2025-03-21 14:46:46,988 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:46,989 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:46,989 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:46,989 - sqlalchemy.engine.Engine - INFO - [cached since 19.4s ago] (7139312538, 1, 0)
2025-03-21 14:46:46,990 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:46,990 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:46,990 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:46,990 - sqlalchemy.engine.Engine - INFO - [cached since 19.4s ago] (7139312538, 1, 0)
2025-03-21 14:46:46,991 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:46,991 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:46,992 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:46,992 - sqlalchemy.engine.Engine - INFO - [cached since 19.4s ago] (7139312538, 1, 0)
2025-03-21 14:46:46,992 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:46,992 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:46,993 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:46,993 - sqlalchemy.engine.Engine - INFO - [cached since 19.4s ago] (7139312538, 1, 0)
2025-03-21 14:46:46,993 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:47,986 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:47,987 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:47,987 - sqlalchemy.engine.Engine - INFO - [cached since 20.4s ago] (7139312538, 1, 0)
2025-03-21 14:46:47,988 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:47,989 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:47,990 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:47,990 - sqlalchemy.engine.Engine - INFO - [cached since 20.41s ago] (7139312538, 1, 0)
2025-03-21 14:46:47,991 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:47,992 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:47,992 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:47,992 - sqlalchemy.engine.Engine - INFO - [cached since 20.4s ago] (7139312538, 1, 0)
2025-03-21 14:46:47,993 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:49,425 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:49,425 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:49,426 - sqlalchemy.engine.Engine - INFO - [cached since 21.84s ago] (7139312538, 1, 0)
2025-03-21 14:46:49,427 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:49,429 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:49,429 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:49,429 - sqlalchemy.engine.Engine - INFO - [cached since 21.85s ago] (7139312538, 1, 0)
2025-03-21 14:46:49,430 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:49,430 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:49,431 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:49,431 - sqlalchemy.engine.Engine - INFO - [cached since 21.84s ago] (7139312538, 1, 0)
2025-03-21 14:46:49,432 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:49,573 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:49,573 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:49,574 - sqlalchemy.engine.Engine - INFO - [cached since 21.98s ago] (7139312538, 1, 0)
2025-03-21 14:46:49,576 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:49,577 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:49,577 - sqlalchemy.engine.Engine - INFO - [cached since 21.99s ago] (7139312538, 1, 0)
2025-03-21 14:46:49,579 - sqlalchemy.engine.Engine - INFO - SELECT user_achievements.id AS user_achievements_id, user_achievements.user_id AS user_achievements_user_id, user_achievements.achievement_id AS user_achievements_achievement_id, user_achievements.achieved_at AS user_achievements_achieved_at, achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM user_achievements JOIN achievements ON user_achievements.achievement_id = achievements.id 
WHERE user_achievements.user_id = ?
2025-03-21 14:46:49,579 - sqlalchemy.engine.Engine - INFO - [generated in 0.00064s] (3,)
2025-03-21 14:46:49,581 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:49,581 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:49,582 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:49,582 - sqlalchemy.engine.Engine - INFO - [cached since 21.99s ago] (7139312538, 1, 0)
2025-03-21 14:46:49,582 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:49,583 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:50,495 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:50,495 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:50,496 - sqlalchemy.engine.Engine - INFO - [cached since 22.91s ago] (7139312538, 1, 0)
2025-03-21 14:46:50,497 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:50,498 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:50,499 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:50,500 - sqlalchemy.engine.Engine - INFO - [cached since 22.92s ago] (7139312538, 1, 0)
2025-03-21 14:46:50,501 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:50,501 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:50,502 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:50,502 - sqlalchemy.engine.Engine - INFO - [cached since 22.91s ago] (7139312538, 1, 0)
2025-03-21 14:46:50,504 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:50,505 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:50,506 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:50,506 - sqlalchemy.engine.Engine - INFO - [cached since 22.92s ago] (7139312538, 1, 0)
2025-03-21 14:46:50,506 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:50,507 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:50,507 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:50,508 - sqlalchemy.engine.Engine - INFO - [cached since 22.92s ago] (7139312538, 1, 0)
2025-03-21 14:46:50,509 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:50,510 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] (3, 'premium', 1, 0)
2025-03-21 14:46:50,511 - sqlalchemy.engine.Engine - INFO - INSERT INTO user_visited_sections (user_id, section, visited_at) VALUES (?, ?, ?)
2025-03-21 14:46:50,512 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] (3, 'premium', '2025-03-21 12:46:50.511458')
2025-03-21 14:46:50,514 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:46:50,518 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:50,520 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
2025-03-21 14:46:50,520 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] (3,)
2025-03-21 14:46:50,521 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.section AS user_visited_sections_section 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section IN (?, ?, ?, ?, ?, ?)
2025-03-21 14:46:50,521 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] (3, 'search_team_menu', 'search_club_menu', 'crystals', 'premium', 'additional', 'gift')
2025-03-21 14:46:50,521 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:51,883 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:51,883 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:51,883 - sqlalchemy.engine.Engine - INFO - [cached since 24.3s ago] (7139312538, 1, 0)
2025-03-21 14:46:51,884 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:51,886 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:51,886 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:51,888 - sqlalchemy.engine.Engine - INFO - [cached since 24.3s ago] (7139312538, 1, 0)
2025-03-21 14:46:51,890 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:51,891 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:51,891 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:51,893 - sqlalchemy.engine.Engine - INFO - [cached since 24.3s ago] (7139312538, 1, 0)
2025-03-21 14:46:51,895 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:52,879 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:52,880 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:52,880 - sqlalchemy.engine.Engine - INFO - [cached since 25.3s ago] (7139312538, 1, 0)
2025-03-21 14:46:52,881 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:52,881 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:52,882 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:52,882 - sqlalchemy.engine.Engine - INFO - [cached since 25.3s ago] (7139312538, 1, 0)
2025-03-21 14:46:52,882 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:52,883 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:52,883 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:52,883 - sqlalchemy.engine.Engine - INFO - [cached since 25.29s ago] (7139312538, 1, 0)
2025-03-21 14:46:52,883 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:52,884 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:52,884 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:52,884 - sqlalchemy.engine.Engine - INFO - [cached since 25.29s ago] (7139312538, 1, 0)
2025-03-21 14:46:52,886 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:52,886 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:52,887 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:52,887 - sqlalchemy.engine.Engine - INFO - [cached since 15.39s ago] ('TEST', 1, 0)
2025-03-21 14:46:52,889 - sqlalchemy.engine.Engine - INFO - SELECT promo_uses.id AS promo_uses_id, promo_uses.promo_id AS promo_uses_promo_id, promo_uses.user_tg_id AS promo_uses_user_tg_id, promo_uses.used_at AS promo_uses_used_at 
FROM promo_uses 
WHERE promo_uses.promo_id = ? AND promo_uses.user_tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:52,889 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] (1, 7139312538, 1, 0)
2025-03-21 14:46:52,889 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:55,574 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:55,576 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:55,576 - sqlalchemy.engine.Engine - INFO - [cached since 27.99s ago] (7139312538, 1, 0)
2025-03-21 14:46:55,578 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:55,578 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:55,579 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:55,579 - sqlalchemy.engine.Engine - INFO - [cached since 27.99s ago] (7139312538, 1, 0)
2025-03-21 14:46:55,580 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:55,581 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:55,582 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:55,582 - sqlalchemy.engine.Engine - INFO - [cached since 27.99s ago] (7139312538, 1, 0)
2025-03-21 14:46:55,583 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:56,413 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:56,415 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:56,416 - sqlalchemy.engine.Engine - INFO - [cached since 28.83s ago] (7139312538, 1, 0)
2025-03-21 14:46:56,417 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:56,418 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:56,419 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:56,419 - sqlalchemy.engine.Engine - INFO - [cached since 28.84s ago] (7139312538, 1, 0)
2025-03-21 14:46:56,421 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:56,422 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:56,422 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:56,422 - sqlalchemy.engine.Engine - INFO - [cached since 28.83s ago] (7139312538, 1, 0)
2025-03-21 14:46:56,423 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:56,423 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:56,425 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:56,425 - sqlalchemy.engine.Engine - INFO - [cached since 28.83s ago] (7139312538, 1, 0)
2025-03-21 14:46:56,425 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:56,426 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:56,426 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:56,426 - sqlalchemy.engine.Engine - INFO - [cached since 28.84s ago] (7139312538, 1, 0)
2025-03-21 14:46:56,427 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:56,427 - sqlalchemy.engine.Engine - INFO - [cached since 5.918s ago] (3, 'premium', 1, 0)
2025-03-21 14:46:56,428 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:57,161 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:57,161 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:57,162 - sqlalchemy.engine.Engine - INFO - [cached since 29.58s ago] (7139312538, 1, 0)
2025-03-21 14:46:57,163 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:57,166 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:57,166 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:57,167 - sqlalchemy.engine.Engine - INFO - [cached since 29.58s ago] (7139312538, 1, 0)
2025-03-21 14:46:57,167 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:57,168 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:57,168 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:57,168 - sqlalchemy.engine.Engine - INFO - [cached since 29.58s ago] (7139312538, 1, 0)
2025-03-21 14:46:57,169 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:58,219 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:58,220 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:58,220 - sqlalchemy.engine.Engine - INFO - [cached since 30.64s ago] (7139312538, 1, 0)
2025-03-21 14:46:58,221 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:58,223 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:58,223 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:58,224 - sqlalchemy.engine.Engine - INFO - [cached since 30.64s ago] (7139312538, 1, 0)
2025-03-21 14:46:58,224 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:58,225 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:58,225 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:58,225 - sqlalchemy.engine.Engine - INFO - [cached since 30.63s ago] (7139312538, 1, 0)
2025-03-21 14:46:58,226 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:58,226 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:58,226 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:58,227 - sqlalchemy.engine.Engine - INFO - [cached since 30.64s ago] (7139312538, 1, 0)
2025-03-21 14:46:58,227 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:46:58,228 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:46:58,228 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:58,228 - sqlalchemy.engine.Engine - INFO - [cached since 20.73s ago] ('TEST2', 1, 0)
2025-03-21 14:46:58,229 - sqlalchemy.engine.Engine - INFO - SELECT promo_uses.id AS promo_uses_id, promo_uses.promo_id AS promo_uses_promo_id, promo_uses.user_tg_id AS promo_uses_user_tg_id, promo_uses.used_at AS promo_uses_used_at 
FROM promo_uses 
WHERE promo_uses.promo_id = ? AND promo_uses.user_tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:46:58,229 - sqlalchemy.engine.Engine - INFO - [cached since 5.341s ago] (2, 7139312538, 1, 0)
2025-03-21 14:46:58,230 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:27,473 - aiogram.dispatcher.dispatcher - INFO - Stop polling...
2025-03-21 14:47:27,475 - aiogram - WARNING - Goodbye!
2025-03-21 14:47:35,233 - __main__ - INFO - Запуск бота...
2025-03-21 14:47:35,480 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:35,481 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-03-21 14:47:35,481 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,481 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2025-03-21 14:47:35,481 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,482 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referrals")
2025-03-21 14:47:35,482 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,482 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referrals")
2025-03-21 14:47:35,482 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,483 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("announcements")
2025-03-21 14:47:35,483 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,484 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("announcements")
2025-03-21 14:47:35,484 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,484 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("reports")
2025-03-21 14:47:35,484 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,485 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("reports")
2025-03-21 14:47:35,485 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,485 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("favorites")
2025-03-21 14:47:35,485 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,485 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("favorites")
2025-03-21 14:47:35,486 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,486 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("crystal_transactions")
2025-03-21 14:47:35,486 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,486 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("crystal_transactions")
2025-03-21 14:47:35,486 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,487 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("premium_prices")
2025-03-21 14:47:35,487 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,487 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("premium_prices")
2025-03-21 14:47:35,487 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,487 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sponsors")
2025-03-21 14:47:35,487 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,488 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("sponsors")
2025-03-21 14:47:35,488 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,488 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_sponsor_subscriptions")
2025-03-21 14:47:35,488 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,488 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_sponsor_subscriptions")
2025-03-21 14:47:35,489 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,489 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_codes")
2025-03-21 14:47:35,489 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,489 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("promo_codes")
2025-03-21 14:47:35,489 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,490 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_uses")
2025-03-21 14:47:35,490 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,490 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("promo_uses")
2025-03-21 14:47:35,490 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,491 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-03-21 14:47:35,491 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,492 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("achievements")
2025-03-21 14:47:35,492 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,493 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_achievements")
2025-03-21 14:47:35,493 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,493 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_achievements")
2025-03-21 14:47:35,493 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,493 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_visited_sections")
2025-03-21 14:47:35,493 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,493 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_visited_sections")
2025-03-21 14:47:35,493 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,495 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_secret_purchases")
2025-03-21 14:47:35,495 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,495 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("user_secret_purchases")
2025-03-21 14:47:35,495 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,495 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("bot_settings")
2025-03-21 14:47:35,496 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,496 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("bot_settings")
2025-03-21 14:47:35,496 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:47:35,498 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	tg_id INTEGER NOT NULL, 
	username VARCHAR, 
	first_name VARCHAR, 
	is_premium BOOLEAN, 
	premium_end_date DATETIME, 
	crystals INTEGER, 
	language VARCHAR, 
	blocked BOOLEAN, 
	last_gift DATETIME, 
	created_at DATETIME, 
	updated_at DATETIME, 
	coins INTEGER, 
	premium_until DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE (tg_id)
)


2025-03-21 14:47:35,498 - sqlalchemy.engine.Engine - INFO - [no key 0.00039s] ()
2025-03-21 14:47:35,502 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_id ON users (id)
2025-03-21 14:47:35,502 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2025-03-21 14:47:35,504 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referrals (
	id INTEGER NOT NULL, 
	referrer_id INTEGER NOT NULL, 
	referred_id INTEGER NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE (referred_id)
)


2025-03-21 14:47:35,505 - sqlalchemy.engine.Engine - INFO - [no key 0.00038s] ()
2025-03-21 14:47:35,508 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_referrals_id ON referrals (id)
2025-03-21 14:47:35,508 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2025-03-21 14:47:35,510 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE premium_prices (
	id INTEGER NOT NULL, 
	duration_days INTEGER NOT NULL, 
	price FLOAT NOT NULL, 
	created_at DATETIME, 
	updated_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE (duration_days)
)


2025-03-21 14:47:35,510 - sqlalchemy.engine.Engine - INFO - [no key 0.00035s] ()
2025-03-21 14:47:35,512 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_premium_prices_id ON premium_prices (id)
2025-03-21 14:47:35,513 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2025-03-21 14:47:35,515 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE sponsors (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	link VARCHAR NOT NULL, 
	channel_id VARCHAR, 
	reward INTEGER, 
	is_active BOOLEAN, 
	created_at DATETIME, 
	updated_at DATETIME, 
	PRIMARY KEY (id)
)


2025-03-21 14:47:35,515 - sqlalchemy.engine.Engine - INFO - [no key 0.00034s] ()
2025-03-21 14:47:35,517 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_sponsors_id ON sponsors (id)
2025-03-21 14:47:35,518 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2025-03-21 14:47:35,520 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE promo_codes (
	id INTEGER NOT NULL, 
	code VARCHAR NOT NULL, 
	duration_days INTEGER NOT NULL, 
	max_uses INTEGER, 
	uses_count INTEGER, 
	is_active BOOLEAN, 
	created_at DATETIME, 
	expires_at DATETIME, 
	PRIMARY KEY (id)
)


2025-03-21 14:47:35,521 - sqlalchemy.engine.Engine - INFO - [no key 0.00035s] ()
2025-03-21 14:47:35,524 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_promo_codes_id ON promo_codes (id)
2025-03-21 14:47:35,524 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2025-03-21 14:47:35,528 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_promo_codes_code ON promo_codes (code)
2025-03-21 14:47:35,528 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2025-03-21 14:47:35,532 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE achievements (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	name VARCHAR NOT NULL, 
	description VARCHAR NOT NULL, 
	icon VARCHAR, 
	is_purchasable BOOLEAN, 
	price INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE ("key")
)


2025-03-21 14:47:35,532 - sqlalchemy.engine.Engine - INFO - [no key 0.00038s] ()
2025-03-21 14:47:35,535 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_achievements_id ON achievements (id)
2025-03-21 14:47:35,535 - sqlalchemy.engine.Engine - INFO - [no key 0.00018s] ()
2025-03-21 14:47:35,537 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE bot_settings (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	value VARCHAR, 
	updated_at DATETIME, 
	PRIMARY KEY (id), 
	UNIQUE ("key")
)


2025-03-21 14:47:35,537 - sqlalchemy.engine.Engine - INFO - [no key 0.00037s] ()
2025-03-21 14:47:35,540 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE announcements (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	announcement_type VARCHAR(4) NOT NULL, 
	image_id VARCHAR NOT NULL, 
	media_id VARCHAR, 
	media_type VARCHAR, 
	description TEXT NOT NULL, 
	keyword VARCHAR, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-03-21 14:47:35,540 - sqlalchemy.engine.Engine - INFO - [no key 0.00048s] ()
2025-03-21 14:47:35,542 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_announcements_id ON announcements (id)
2025-03-21 14:47:35,542 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2025-03-21 14:47:35,546 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE crystal_transactions (
	id INTEGER NOT NULL, 
	sender_id INTEGER, 
	receiver_id INTEGER, 
	amount INTEGER NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(sender_id) REFERENCES users (id), 
	FOREIGN KEY(receiver_id) REFERENCES users (id)
)


2025-03-21 14:47:35,546 - sqlalchemy.engine.Engine - INFO - [no key 0.00039s] ()
2025-03-21 14:47:35,548 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_crystal_transactions_id ON crystal_transactions (id)
2025-03-21 14:47:35,549 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2025-03-21 14:47:35,551 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_sponsor_subscriptions (
	id INTEGER NOT NULL, 
	user_tg_id INTEGER NOT NULL, 
	sponsor_id INTEGER NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_tg_id) REFERENCES users (tg_id), 
	FOREIGN KEY(sponsor_id) REFERENCES sponsors (id)
)


2025-03-21 14:47:35,551 - sqlalchemy.engine.Engine - INFO - [no key 0.00040s] ()
2025-03-21 14:47:35,554 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE promo_uses (
	id INTEGER NOT NULL, 
	promo_id INTEGER NOT NULL, 
	user_tg_id INTEGER NOT NULL, 
	used_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(promo_id) REFERENCES promo_codes (id)
)


2025-03-21 14:47:35,554 - sqlalchemy.engine.Engine - INFO - [no key 0.00033s] ()
2025-03-21 14:47:35,557 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_promo_uses_id ON promo_uses (id)
2025-03-21 14:47:35,557 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2025-03-21 14:47:35,561 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_achievements (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	achievement_id INTEGER NOT NULL, 
	achieved_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id), 
	FOREIGN KEY(achievement_id) REFERENCES achievements (id)
)


2025-03-21 14:47:35,561 - sqlalchemy.engine.Engine - INFO - [no key 0.00037s] ()
2025-03-21 14:47:35,563 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_user_achievements_id ON user_achievements (id)
2025-03-21 14:47:35,563 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2025-03-21 14:47:35,566 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_visited_sections (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	section VARCHAR NOT NULL, 
	visited_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-03-21 14:47:35,566 - sqlalchemy.engine.Engine - INFO - [no key 0.00052s] ()
2025-03-21 14:47:35,568 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_user_visited_sections_id ON user_visited_sections (id)
2025-03-21 14:47:35,568 - sqlalchemy.engine.Engine - INFO - [no key 0.00019s] ()
2025-03-21 14:47:35,571 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE user_secret_purchases (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	content_key VARCHAR NOT NULL, 
	purchased_at DATETIME, 
	price INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-03-21 14:47:35,571 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2025-03-21 14:47:35,574 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_user_secret_purchases_id ON user_secret_purchases (id)
2025-03-21 14:47:35,574 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2025-03-21 14:47:35,575 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE reports (
	id INTEGER NOT NULL, 
	reporter_id INTEGER, 
	announcement_id INTEGER, 
	reason VARCHAR NOT NULL, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(reporter_id) REFERENCES users (id), 
	FOREIGN KEY(announcement_id) REFERENCES announcements (id)
)


2025-03-21 14:47:35,575 - sqlalchemy.engine.Engine - INFO - [no key 0.00034s] ()
2025-03-21 14:47:35,578 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_reports_id ON reports (id)
2025-03-21 14:47:35,580 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2025-03-21 14:47:35,583 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE favorites (
	id INTEGER NOT NULL, 
	user_id INTEGER, 
	announcement_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id), 
	FOREIGN KEY(announcement_id) REFERENCES announcements (id)
)


2025-03-21 14:47:35,583 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2025-03-21 14:47:35,585 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_favorites_id ON favorites (id)
2025-03-21 14:47:35,585 - sqlalchemy.engine.Engine - INFO - [no key 0.00019s] ()
2025-03-21 14:47:35,587 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:47:35,602 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:35,605 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:35,606 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] (30, 1, 0)
2025-03-21 14:47:35,607 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:35,607 - sqlalchemy.engine.Engine - INFO - [cached since 0.001846s ago] (180, 1, 0)
2025-03-21 14:47:35,608 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:35,608 - sqlalchemy.engine.Engine - INFO - [cached since 0.003116s ago] (365, 1, 0)
2025-03-21 14:47:35,609 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:35,609 - sqlalchemy.engine.Engine - INFO - [cached since 0.004036s ago] (36500, 1, 0)
2025-03-21 14:47:35,611 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-21 14:47:35,611 - sqlalchemy.engine.Engine - INFO - [generated in 0.00017s (insertmanyvalues) 1/4 (ordered; batch not supported)] (30, 500.0, '2025-03-21 12:47:35.611389', '2025-03-21 12:47:35.611389')
2025-03-21 14:47:35,612 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-21 14:47:35,612 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 2/4 (ordered; batch not supported)] (180, 2500.0, '2025-03-21 12:47:35.611389', '2025-03-21 12:47:35.611389')
2025-03-21 14:47:35,613 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-21 14:47:35,613 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 3/4 (ordered; batch not supported)] (365, 4500.0, '2025-03-21 12:47:35.611389', '2025-03-21 12:47:35.611389')
2025-03-21 14:47:35,613 - sqlalchemy.engine.Engine - INFO - INSERT INTO premium_prices (duration_days, price, created_at, updated_at) VALUES (?, ?, ?, ?) RETURNING id
2025-03-21 14:47:35,613 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 4/4 (ordered; batch not supported)] (36500, 9900.0, '2025-03-21 12:47:35.611389', '2025-03-21 12:47:35.611389')
2025-03-21 14:47:35,613 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:47:35,626 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:35,630 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements) AS anon_1
2025-03-21 14:47:35,630 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ()
2025-03-21 14:47:35,631 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-03-21 14:47:35,631 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] ('major', 'Мажор', 'Доказательство вашей финансовой состоятельности', '💰', 1, 10000, '2025-03-21 12:47:35.631824')
2025-03-21 14:47:35,633 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-21 14:47:35,633 - sqlalchemy.engine.Engine - INFO - [generated in 0.00014s (insertmanyvalues) 1/9 (ordered; batch not supported)] ('popular', 'Популярный', 'Добавить объявление по поиску команды', '👥', 0, 0, '2025-03-21 12:47:35.633819')
2025-03-21 14:47:35,634 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-21 14:47:35,634 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 2/9 (ordered; batch not supported)] ('club_fighter', 'Бойцовский клуб', 'Добавить объявление по поиску клуба', '🥊', 0, 0, '2025-03-21 12:47:35.633819')
2025-03-21 14:47:35,634 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-21 14:47:35,635 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 3/9 (ordered; batch not supported)] ('explorer', 'Искатель', 'Посетить все разделы бота', '🔍', 0, 0, '2025-03-21 12:47:35.633819')
2025-03-21 14:47:35,635 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-21 14:47:35,635 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 4/9 (ordered; batch not supported)] ('legend', 'Легенда', 'Купить премиум статус', '⭐', 0, 0, '2025-03-21 12:47:35.633819')
2025-03-21 14:47:35,637 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-21 14:47:35,637 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 5/9 (ordered; batch not supported)] ('leprechaun', 'Лепрекон', 'Накопить 15,000 монет в балансе', '🍀', 0, 0, '2025-03-21 12:47:35.633819')
2025-03-21 14:47:35,638 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-21 14:47:35,638 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 6/9 (ordered; batch not supported)] ('lucky', 'Испытать удачу', 'Принять участие в розыгрыше монет', '🎁', 0, 0, '2025-03-21 12:47:35.633819')
2025-03-21 14:47:35,638 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-21 14:47:35,639 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 7/9 (ordered; batch not supported)] ('business', 'Бизнес-мачо', 'Пригласить человека по реферальной ссылке', '💼', 0, 0, '2025-03-21 12:47:35.633819')
2025-03-21 14:47:35,639 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-21 14:47:35,639 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 8/9 (ordered; batch not supported)] ('follow_me', 'Делай как я', 'Пригласить 10 человек по реферальной ссылке', '👑', 0, 0, '2025-03-21 12:47:35.633819')
2025-03-21 14:47:35,639 - sqlalchemy.engine.Engine - INFO - INSERT INTO achievements ("key", name, description, icon, is_purchasable, price, created_at) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
2025-03-21 14:47:35,640 - sqlalchemy.engine.Engine - INFO - [insertmanyvalues 9/9 (ordered; batch not supported)] ('friend', 'Настоящий друг', 'Пригласить 25 человек по реферальной ссылке', '❤️', 0, 0, '2025-03-21 12:47:35.633819')
2025-03-21 14:47:35,640 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:47:35,648 - root - INFO - Achievements handlers registered successfully
2025-03-21 14:47:35,858 - aiogram - INFO - Bot: Бубсер Поиск Бот [@Bubser_PoiskBot]
2025-03-21 14:47:35,935 - aiogram - WARNING - Updates were skipped successfully.
2025-03-21 14:47:35,936 - __main__ - INFO - Бот успешно запущен!
2025-03-21 14:47:35,936 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:35,939 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.tg_id, users.username, users.first_name, users.is_premium, users.premium_end_date, users.crystals, users.language, users.blocked, users.last_gift, users.created_at, users.updated_at, users.coins, users.premium_until 
FROM users 
WHERE users.is_premium = 1 AND users.premium_end_date <= ?
2025-03-21 14:47:35,939 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] ('2025-03-21 14:47:35.936568',)
2025-03-21 14:47:35,939 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:47:35,940 - aiogram.dispatcher.dispatcher - INFO - Start polling.
2025-03-21 14:47:38,205 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:38,207 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:38,208 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] (7139312538, 1, 0)
2025-03-21 14:47:38,209 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:38,210 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:38,210 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:38,210 - sqlalchemy.engine.Engine - INFO - [cached since 0.003033s ago] (7139312538, 1, 0)
2025-03-21 14:47:38,211 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:38,212 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:38,213 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:38,213 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] (7139312538, 1, 0)
2025-03-21 14:47:38,213 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:38,213 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:38,213 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:38,215 - sqlalchemy.engine.Engine - INFO - [cached since 0.001616s ago] (7139312538, 1, 0)
2025-03-21 14:47:38,216 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:38,216 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:38,216 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:38,217 - sqlalchemy.engine.Engine - INFO - [cached since 0.00361s ago] (7139312538, 1, 0)
2025-03-21 14:47:38,217 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:38,217 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:38,218 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:38,218 - sqlalchemy.engine.Engine - INFO - [cached since 0.005166s ago] (7139312538, 1, 0)
2025-03-21 14:47:38,219 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:38,219 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:38,220 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:38,220 - sqlalchemy.engine.Engine - INFO - [cached since 0.006862s ago] (7139312538, 1, 0)
2025-03-21 14:47:38,222 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (tg_id, username, first_name, is_premium, premium_end_date, crystals, language, blocked, last_gift, created_at, updated_at, coins, premium_until) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-03-21 14:47:38,223 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] (7139312538, 'nowoyaz', "O'Brien", 0, None, 100, 'ru', 0, None, '2025-03-21 14:47:38.220032', '2025-03-21 12:47:38.222040', 0, None)
2025-03-21 14:47:38,224 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:47:39,248 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:39,249 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:39,250 - sqlalchemy.engine.Engine - INFO - [cached since 1.043s ago] (7139312538, 1, 0)
2025-03-21 14:47:39,251 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:39,251 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:39,252 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:39,252 - sqlalchemy.engine.Engine - INFO - [cached since 1.045s ago] (7139312538, 1, 0)
2025-03-21 14:47:39,252 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:39,253 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:39,253 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:39,254 - sqlalchemy.engine.Engine - INFO - [cached since 1.042s ago] (7139312538, 1, 0)
2025-03-21 14:47:39,255 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:41,183 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:41,185 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:41,185 - sqlalchemy.engine.Engine - INFO - [cached since 2.978s ago] (7139312538, 1, 0)
2025-03-21 14:47:41,185 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:41,188 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:41,188 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:41,188 - sqlalchemy.engine.Engine - INFO - [cached since 2.981s ago] (7139312538, 1, 0)
2025-03-21 14:47:41,189 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:41,190 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:41,191 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:41,191 - sqlalchemy.engine.Engine - INFO - [cached since 2.979s ago] (7139312538, 1, 0)
2025-03-21 14:47:41,192 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:41,193 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:41,193 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:41,193 - sqlalchemy.engine.Engine - INFO - [cached since 2.981s ago] (7139312538, 1, 0)
2025-03-21 14:47:41,194 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:41,194 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:41,194 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:41,194 - sqlalchemy.engine.Engine - INFO - [cached since 2.982s ago] (7139312538, 1, 0)
2025-03-21 14:47:41,197 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:41,198 - sqlalchemy.engine.Engine - INFO - [generated in 0.00133s] (1, 'premium', 1, 0)
2025-03-21 14:47:41,199 - sqlalchemy.engine.Engine - INFO - INSERT INTO user_visited_sections (user_id, section, visited_at) VALUES (?, ?, ?)
2025-03-21 14:47:41,199 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] (1, 'premium', '2025-03-21 12:47:41.199939')
2025-03-21 14:47:41,201 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:47:41,206 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:41,208 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
2025-03-21 14:47:41,209 - sqlalchemy.engine.Engine - INFO - [generated in 0.00107s] (1,)
2025-03-21 14:47:41,210 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.section AS user_visited_sections_section 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section IN (?, ?, ?, ?, ?, ?)
2025-03-21 14:47:41,211 - sqlalchemy.engine.Engine - INFO - [generated in 0.00065s] (1, 'search_team_menu', 'search_club_menu', 'crystals', 'premium', 'additional', 'gift')
2025-03-21 14:47:41,212 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:43,554 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:43,555 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:43,555 - sqlalchemy.engine.Engine - INFO - [cached since 5.349s ago] (7139312538, 1, 0)
2025-03-21 14:47:43,556 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:43,557 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:43,558 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:43,558 - sqlalchemy.engine.Engine - INFO - [cached since 5.352s ago] (7139312538, 1, 0)
2025-03-21 14:47:43,559 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:43,559 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:43,560 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:43,560 - sqlalchemy.engine.Engine - INFO - [cached since 5.348s ago] (7139312538, 1, 0)
2025-03-21 14:47:43,560 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:43,561 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:43,561 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:43,561 - sqlalchemy.engine.Engine - INFO - [cached since 5.349s ago] (7139312538, 1, 0)
2025-03-21 14:47:43,562 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:44,657 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:44,657 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:44,658 - sqlalchemy.engine.Engine - INFO - [cached since 6.45s ago] (7139312538, 1, 0)
2025-03-21 14:47:44,659 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:44,661 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:44,662 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:44,662 - sqlalchemy.engine.Engine - INFO - [cached since 6.455s ago] (7139312538, 1, 0)
2025-03-21 14:47:44,663 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:44,664 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:44,665 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:44,665 - sqlalchemy.engine.Engine - INFO - [cached since 6.452s ago] (7139312538, 1, 0)
2025-03-21 14:47:44,667 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:44,743 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:44,745 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:44,745 - sqlalchemy.engine.Engine - INFO - [cached since 6.532s ago] (7139312538, 1, 0)
2025-03-21 14:47:44,747 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:44,795 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:44,798 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes
2025-03-21 14:47:44,798 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] ()
2025-03-21 14:47:44,800 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:45,590 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:45,590 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:45,591 - sqlalchemy.engine.Engine - INFO - [cached since 7.384s ago] (7139312538, 1, 0)
2025-03-21 14:47:45,592 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:45,597 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:45,598 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:45,598 - sqlalchemy.engine.Engine - INFO - [cached since 7.391s ago] (7139312538, 1, 0)
2025-03-21 14:47:45,598 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:45,600 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:45,601 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:45,602 - sqlalchemy.engine.Engine - INFO - [cached since 7.389s ago] (7139312538, 1, 0)
2025-03-21 14:47:45,603 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:46,448 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:46,449 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:46,449 - sqlalchemy.engine.Engine - INFO - [cached since 8.242s ago] (7139312538, 1, 0)
2025-03-21 14:47:46,450 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:46,451 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:46,451 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:46,451 - sqlalchemy.engine.Engine - INFO - [cached since 8.244s ago] (7139312538, 1, 0)
2025-03-21 14:47:46,452 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:46,452 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:46,452 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:46,452 - sqlalchemy.engine.Engine - INFO - [cached since 8.24s ago] (7139312538, 1, 0)
2025-03-21 14:47:46,453 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:46,453 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:46,453 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:46,454 - sqlalchemy.engine.Engine - INFO - [cached since 8.241s ago] (7139312538, 1, 0)
2025-03-21 14:47:46,455 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:47,306 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:47,307 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:47,308 - sqlalchemy.engine.Engine - INFO - [cached since 9.1s ago] (7139312538, 1, 0)
2025-03-21 14:47:47,309 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:47,311 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:47,311 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:47,311 - sqlalchemy.engine.Engine - INFO - [cached since 9.104s ago] (7139312538, 1, 0)
2025-03-21 14:47:47,312 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:47,312 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:47,312 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:47,312 - sqlalchemy.engine.Engine - INFO - [cached since 9.1s ago] (7139312538, 1, 0)
2025-03-21 14:47:47,313 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:48,147 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:48,147 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:48,147 - sqlalchemy.engine.Engine - INFO - [cached since 9.94s ago] (7139312538, 1, 0)
2025-03-21 14:47:48,148 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:48,149 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:48,150 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:48,150 - sqlalchemy.engine.Engine - INFO - [cached since 9.943s ago] (7139312538, 1, 0)
2025-03-21 14:47:48,151 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:48,152 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:48,153 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:48,153 - sqlalchemy.engine.Engine - INFO - [cached since 9.941s ago] (7139312538, 1, 0)
2025-03-21 14:47:48,153 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:48,888 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:48,889 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:48,889 - sqlalchemy.engine.Engine - INFO - [cached since 10.68s ago] (7139312538, 1, 0)
2025-03-21 14:47:48,890 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:48,891 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:48,892 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:48,892 - sqlalchemy.engine.Engine - INFO - [cached since 10.69s ago] (7139312538, 1, 0)
2025-03-21 14:47:48,894 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:48,894 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:48,895 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:48,895 - sqlalchemy.engine.Engine - INFO - [cached since 10.68s ago] (7139312538, 1, 0)
2025-03-21 14:47:48,896 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:48,964 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:48,965 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:48,965 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] ('TEST', 1, 0)
2025-03-21 14:47:48,967 - sqlalchemy.engine.Engine - INFO - INSERT INTO promo_codes (code, duration_days, max_uses, uses_count, is_active, created_at, expires_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-03-21 14:47:48,968 - sqlalchemy.engine.Engine - INFO - [generated in 0.00135s] ('TEST', 7, 5, 0, 1, '2025-03-21 12:47:48.967735', '2025-03-28 12:47:48.964241')
2025-03-21 14:47:48,971 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:47:48,976 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:48,977 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id, promo_codes.code, promo_codes.duration_days, promo_codes.max_uses, promo_codes.uses_count, promo_codes.is_active, promo_codes.created_at, promo_codes.expires_at 
FROM promo_codes 
WHERE promo_codes.id = ?
2025-03-21 14:47:48,977 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] (1,)
2025-03-21 14:47:48,979 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:50,024 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:50,025 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:50,026 - sqlalchemy.engine.Engine - INFO - [cached since 11.82s ago] (7139312538, 1, 0)
2025-03-21 14:47:50,026 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:50,029 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:50,029 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:50,029 - sqlalchemy.engine.Engine - INFO - [cached since 11.82s ago] (7139312538, 1, 0)
2025-03-21 14:47:50,029 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:50,030 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:50,030 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:50,031 - sqlalchemy.engine.Engine - INFO - [cached since 11.82s ago] (7139312538, 1, 0)
2025-03-21 14:47:50,031 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:50,741 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:50,742 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:50,742 - sqlalchemy.engine.Engine - INFO - [cached since 12.53s ago] (7139312538, 1, 0)
2025-03-21 14:47:50,743 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:50,744 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:50,744 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:50,745 - sqlalchemy.engine.Engine - INFO - [cached since 12.54s ago] (7139312538, 1, 0)
2025-03-21 14:47:50,745 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:50,746 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:50,746 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:50,747 - sqlalchemy.engine.Engine - INFO - [cached since 12.53s ago] (7139312538, 1, 0)
2025-03-21 14:47:50,747 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:50,795 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:50,796 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:50,798 - sqlalchemy.engine.Engine - INFO - [cached since 12.58s ago] (7139312538, 1, 0)
2025-03-21 14:47:50,801 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:50,847 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:50,847 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes
2025-03-21 14:47:50,848 - sqlalchemy.engine.Engine - INFO - [cached since 6.051s ago] ()
2025-03-21 14:47:50,848 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:53,269 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:53,270 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:53,270 - sqlalchemy.engine.Engine - INFO - [cached since 15.06s ago] (7139312538, 1, 0)
2025-03-21 14:47:53,272 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:53,274 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:53,274 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:53,275 - sqlalchemy.engine.Engine - INFO - [cached since 15.07s ago] (7139312538, 1, 0)
2025-03-21 14:47:53,275 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:53,275 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:53,277 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:53,277 - sqlalchemy.engine.Engine - INFO - [cached since 15.06s ago] (7139312538, 1, 0)
2025-03-21 14:47:53,278 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:53,797 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:53,798 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:53,798 - sqlalchemy.engine.Engine - INFO - [cached since 15.59s ago] (7139312538, 1, 0)
2025-03-21 14:47:53,799 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:53,800 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:53,800 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:53,801 - sqlalchemy.engine.Engine - INFO - [cached since 15.59s ago] (7139312538, 1, 0)
2025-03-21 14:47:53,801 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:53,802 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:53,802 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:53,802 - sqlalchemy.engine.Engine - INFO - [cached since 15.59s ago] (7139312538, 1, 0)
2025-03-21 14:47:53,803 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:53,803 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:53,803 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:53,803 - sqlalchemy.engine.Engine - INFO - [cached since 15.59s ago] (7139312538, 1, 0)
2025-03-21 14:47:53,805 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:55,012 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:55,013 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:55,013 - sqlalchemy.engine.Engine - INFO - [cached since 16.81s ago] (7139312538, 1, 0)
2025-03-21 14:47:55,015 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:55,016 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:55,016 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:55,017 - sqlalchemy.engine.Engine - INFO - [cached since 16.81s ago] (7139312538, 1, 0)
2025-03-21 14:47:55,019 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:55,019 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:55,020 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:55,020 - sqlalchemy.engine.Engine - INFO - [cached since 16.81s ago] (7139312538, 1, 0)
2025-03-21 14:47:55,021 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:56,271 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:56,272 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:56,272 - sqlalchemy.engine.Engine - INFO - [cached since 18.07s ago] (7139312538, 1, 0)
2025-03-21 14:47:56,273 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:56,276 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:56,277 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:56,277 - sqlalchemy.engine.Engine - INFO - [cached since 18.07s ago] (7139312538, 1, 0)
2025-03-21 14:47:56,278 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:56,278 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:56,278 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:56,279 - sqlalchemy.engine.Engine - INFO - [cached since 18.07s ago] (7139312538, 1, 0)
2025-03-21 14:47:56,280 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:57,039 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:57,039 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:57,040 - sqlalchemy.engine.Engine - INFO - [cached since 18.83s ago] (7139312538, 1, 0)
2025-03-21 14:47:57,041 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:57,042 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:57,042 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:57,043 - sqlalchemy.engine.Engine - INFO - [cached since 18.84s ago] (7139312538, 1, 0)
2025-03-21 14:47:57,043 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:57,044 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:57,045 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:57,045 - sqlalchemy.engine.Engine - INFO - [cached since 18.83s ago] (7139312538, 1, 0)
2025-03-21 14:47:57,046 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:47:57,207 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:57,207 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:47:57,208 - sqlalchemy.engine.Engine - INFO - [cached since 8.243s ago] ('TEST2', 1, 0)
2025-03-21 14:47:57,209 - sqlalchemy.engine.Engine - INFO - INSERT INTO promo_codes (code, duration_days, max_uses, uses_count, is_active, created_at, expires_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-03-21 14:47:57,210 - sqlalchemy.engine.Engine - INFO - [cached since 8.243s ago] ('TEST2', 7, 5, 0, 1, '2025-03-21 12:47:57.209629', '2025-03-28 12:47:57.206437')
2025-03-21 14:47:57,212 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:47:57,217 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:47:57,218 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id, promo_codes.code, promo_codes.duration_days, promo_codes.max_uses, promo_codes.uses_count, promo_codes.is_active, promo_codes.created_at, promo_codes.expires_at 
FROM promo_codes 
WHERE promo_codes.id = ?
2025-03-21 14:47:57,219 - sqlalchemy.engine.Engine - INFO - [cached since 8.242s ago] (2,)
2025-03-21 14:47:57,220 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:00,014 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:00,015 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:00,016 - sqlalchemy.engine.Engine - INFO - [cached since 21.81s ago] (7139312538, 1, 0)
2025-03-21 14:48:00,017 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:00,019 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:00,019 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:00,020 - sqlalchemy.engine.Engine - INFO - [cached since 21.81s ago] (7139312538, 1, 0)
2025-03-21 14:48:00,020 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:00,021 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:00,021 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:00,021 - sqlalchemy.engine.Engine - INFO - [cached since 21.81s ago] (7139312538, 1, 0)
2025-03-21 14:48:00,023 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:00,850 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:00,851 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:00,852 - sqlalchemy.engine.Engine - INFO - [cached since 22.64s ago] (7139312538, 1, 0)
2025-03-21 14:48:00,853 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:00,853 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:00,854 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:00,855 - sqlalchemy.engine.Engine - INFO - [cached since 22.65s ago] (7139312538, 1, 0)
2025-03-21 14:48:00,856 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:00,857 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:00,858 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:00,858 - sqlalchemy.engine.Engine - INFO - [cached since 22.65s ago] (7139312538, 1, 0)
2025-03-21 14:48:00,858 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:00,859 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:00,859 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:00,859 - sqlalchemy.engine.Engine - INFO - [cached since 22.65s ago] (7139312538, 1, 0)
2025-03-21 14:48:00,860 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:00,860 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:00,861 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:00,861 - sqlalchemy.engine.Engine - INFO - [cached since 11.9s ago] ('TEST', 1, 0)
2025-03-21 14:48:00,862 - sqlalchemy.engine.Engine - INFO - SELECT promo_uses.id AS promo_uses_id, promo_uses.promo_id AS promo_uses_promo_id, promo_uses.user_tg_id AS promo_uses_user_tg_id, promo_uses.used_at AS promo_uses_used_at 
FROM promo_uses 
WHERE promo_uses.promo_id = ? AND promo_uses.user_tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:00,862 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] (1, 7139312538, 1, 0)
2025-03-21 14:48:00,863 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:00,863 - sqlalchemy.engine.Engine - INFO - [cached since 22.65s ago] (7139312538, 1, 0)
2025-03-21 14:48:00,868 - sqlalchemy.engine.Engine - INFO - UPDATE promo_codes SET uses_count=? WHERE promo_codes.id = ?
2025-03-21 14:48:00,868 - sqlalchemy.engine.Engine - INFO - [generated in 0.00045s] (1, 1)
2025-03-21 14:48:00,870 - sqlalchemy.engine.Engine - INFO - INSERT INTO promo_uses (promo_id, user_tg_id, used_at) VALUES (?, ?, ?)
2025-03-21 14:48:00,871 - sqlalchemy.engine.Engine - INFO - [generated in 0.00085s] (1, 7139312538, '2025-03-21 12:48:00.870092')
2025-03-21 14:48:00,873 - sqlalchemy.engine.Engine - INFO - UPDATE users SET is_premium=?, premium_end_date=?, updated_at=?, premium_until=? WHERE users.id = ?
2025-03-21 14:48:00,873 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] (1, '2025-03-28 14:48:00.865070', '2025-03-21 12:48:00.872090', '2025-03-28 14:48:00.865070', 1)
2025-03-21 14:48:00,875 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:48:00,877 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:00,878 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.id = ?
2025-03-21 14:48:00,879 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] (1,)
2025-03-21 14:48:00,879 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:00,881 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:00,881 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:00,882 - sqlalchemy.engine.Engine - INFO - [cached since 22.67s ago] (7139312538, 1, 0)
2025-03-21 14:48:00,883 - sqlalchemy.engine.Engine - INFO - SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements 
WHERE achievements."key" = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:00,883 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] ('legend', 1, 0)
2025-03-21 14:48:00,888 - sqlalchemy.engine.Engine - INFO - SELECT user_achievements.id AS user_achievements_id, user_achievements.user_id AS user_achievements_user_id, user_achievements.achievement_id AS user_achievements_achievement_id, user_achievements.achieved_at AS user_achievements_achieved_at 
FROM user_achievements 
WHERE user_achievements.user_id = ? AND user_achievements.achievement_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:00,888 - sqlalchemy.engine.Engine - INFO - [generated in 0.00071s] (1, 5, 1, 0)
2025-03-21 14:48:00,889 - sqlalchemy.engine.Engine - INFO - INSERT INTO user_achievements (user_id, achievement_id, achieved_at) VALUES (?, ?, ?)
2025-03-21 14:48:00,890 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] (1, 5, '2025-03-21 12:48:00.889426')
2025-03-21 14:48:00,891 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:48:00,893 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-101' coro=<Dispatcher._process_polling_updates() done, defined at C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py:407> exception=KeyError('code')>
Traceback (most recent call last):
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 415, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 235, in process_updates
    return await asyncio.gather(*tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 256, in process_update
    return await self.message_handlers.notify(update.message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\handlers\premium.py", line 142, in process_promo_code
    user_locale.get("promo_code_success", "").format(days=days, date=end_date),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyError: 'code'
2025-03-21 14:48:07,007 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:07,007 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:07,008 - sqlalchemy.engine.Engine - INFO - [cached since 28.8s ago] (7139312538, 1, 0)
2025-03-21 14:48:07,009 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:07,010 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:07,011 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:07,012 - sqlalchemy.engine.Engine - INFO - [cached since 28.8s ago] (7139312538, 1, 0)
2025-03-21 14:48:07,012 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:07,013 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:07,013 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:07,013 - sqlalchemy.engine.Engine - INFO - [cached since 28.8s ago] (7139312538, 1, 0)
2025-03-21 14:48:07,014 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:11,829 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:11,830 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:11,830 - sqlalchemy.engine.Engine - INFO - [cached since 33.62s ago] (7139312538, 1, 0)
2025-03-21 14:48:11,831 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:11,832 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:11,832 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:11,832 - sqlalchemy.engine.Engine - INFO - [cached since 33.62s ago] (7139312538, 1, 0)
2025-03-21 14:48:11,833 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:11,833 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:11,833 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:11,833 - sqlalchemy.engine.Engine - INFO - [cached since 33.62s ago] (7139312538, 1, 0)
2025-03-21 14:48:11,834 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:11,835 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:11,835 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:11,835 - sqlalchemy.engine.Engine - INFO - [cached since 33.62s ago] (7139312538, 1, 0)
2025-03-21 14:48:11,836 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:11,837 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:11,837 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:11,837 - sqlalchemy.engine.Engine - INFO - [cached since 33.62s ago] (7139312538, 1, 0)
2025-03-21 14:48:11,838 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:11,838 - sqlalchemy.engine.Engine - INFO - [cached since 30.64s ago] (1, 'premium', 1, 0)
2025-03-21 14:48:11,839 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:14,191 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:14,192 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:14,193 - sqlalchemy.engine.Engine - INFO - [cached since 35.99s ago] (7139312538, 1, 0)
2025-03-21 14:48:14,194 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:14,195 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:14,195 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:14,195 - sqlalchemy.engine.Engine - INFO - [cached since 35.99s ago] (7139312538, 1, 0)
2025-03-21 14:48:14,195 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:14,197 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:14,198 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:14,198 - sqlalchemy.engine.Engine - INFO - [cached since 35.99s ago] (7139312538, 1, 0)
2025-03-21 14:48:14,199 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:14,199 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:14,199 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:14,200 - sqlalchemy.engine.Engine - INFO - [cached since 35.99s ago] (7139312538, 1, 0)
2025-03-21 14:48:14,200 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:14,201 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:14,201 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:14,201 - sqlalchemy.engine.Engine - INFO - [cached since 35.99s ago] (7139312538, 1, 0)
2025-03-21 14:48:14,201 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:14,202 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:14,202 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:14,202 - sqlalchemy.engine.Engine - INFO - [cached since 35.99s ago] (7139312538, 1, 0)
2025-03-21 14:48:14,203 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:15,082 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:15,082 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:15,083 - sqlalchemy.engine.Engine - INFO - [cached since 36.88s ago] (7139312538, 1, 0)
2025-03-21 14:48:15,084 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:15,084 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:15,085 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:15,085 - sqlalchemy.engine.Engine - INFO - [cached since 36.88s ago] (7139312538, 1, 0)
2025-03-21 14:48:15,086 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:15,088 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:15,089 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:15,089 - sqlalchemy.engine.Engine - INFO - [cached since 36.88s ago] (7139312538, 1, 0)
2025-03-21 14:48:15,091 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:16,203 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:16,204 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:16,205 - sqlalchemy.engine.Engine - INFO - [cached since 38s ago] (7139312538, 1, 0)
2025-03-21 14:48:16,206 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:16,207 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:16,207 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:16,208 - sqlalchemy.engine.Engine - INFO - [cached since 38s ago] (7139312538, 1, 0)
2025-03-21 14:48:16,208 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:16,208 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:16,209 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:16,209 - sqlalchemy.engine.Engine - INFO - [cached since 38s ago] (7139312538, 1, 0)
2025-03-21 14:48:16,210 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:16,211 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:16,212 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:16,212 - sqlalchemy.engine.Engine - INFO - [cached since 38s ago] (7139312538, 1, 0)
2025-03-21 14:48:16,213 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:16,215 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:16,215 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:16,215 - sqlalchemy.engine.Engine - INFO - [cached since 38s ago] (7139312538, 1, 0)
2025-03-21 14:48:16,216 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:16,216 - sqlalchemy.engine.Engine - INFO - [cached since 35.02s ago] (1, 'premium', 1, 0)
2025-03-21 14:48:16,216 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:17,429 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:17,429 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:17,430 - sqlalchemy.engine.Engine - INFO - [cached since 39.22s ago] (7139312538, 1, 0)
2025-03-21 14:48:17,431 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:17,432 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:17,433 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:17,435 - sqlalchemy.engine.Engine - INFO - [cached since 39.23s ago] (7139312538, 1, 0)
2025-03-21 14:48:17,435 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:17,436 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:17,438 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:17,438 - sqlalchemy.engine.Engine - INFO - [cached since 39.23s ago] (7139312538, 1, 0)
2025-03-21 14:48:17,440 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:18,517 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:18,518 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:18,518 - sqlalchemy.engine.Engine - INFO - [cached since 40.31s ago] (7139312538, 1, 0)
2025-03-21 14:48:18,520 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:18,521 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:18,522 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:18,522 - sqlalchemy.engine.Engine - INFO - [cached since 40.32s ago] (7139312538, 1, 0)
2025-03-21 14:48:18,525 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:18,525 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:18,525 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:18,525 - sqlalchemy.engine.Engine - INFO - [cached since 40.31s ago] (7139312538, 1, 0)
2025-03-21 14:48:18,526 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:18,527 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:18,527 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:18,527 - sqlalchemy.engine.Engine - INFO - [cached since 40.31s ago] (7139312538, 1, 0)
2025-03-21 14:48:18,528 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:18,529 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:18,529 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:18,529 - sqlalchemy.engine.Engine - INFO - [cached since 29.57s ago] ('TST', 1, 0)
2025-03-21 14:48:18,530 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:20,256 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:20,256 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:20,257 - sqlalchemy.engine.Engine - INFO - [cached since 42.05s ago] (7139312538, 1, 0)
2025-03-21 14:48:20,258 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:20,259 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:20,260 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:20,260 - sqlalchemy.engine.Engine - INFO - [cached since 42.05s ago] (7139312538, 1, 0)
2025-03-21 14:48:20,261 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:20,261 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:20,262 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:20,262 - sqlalchemy.engine.Engine - INFO - [cached since 42.05s ago] (7139312538, 1, 0)
2025-03-21 14:48:20,263 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:21,192 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:21,192 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:21,193 - sqlalchemy.engine.Engine - INFO - [cached since 42.99s ago] (7139312538, 1, 0)
2025-03-21 14:48:21,193 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:21,195 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:21,195 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:21,195 - sqlalchemy.engine.Engine - INFO - [cached since 42.99s ago] (7139312538, 1, 0)
2025-03-21 14:48:21,196 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:21,197 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:21,198 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:21,198 - sqlalchemy.engine.Engine - INFO - [cached since 42.98s ago] (7139312538, 1, 0)
2025-03-21 14:48:21,199 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:21,201 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:21,201 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:21,201 - sqlalchemy.engine.Engine - INFO - [cached since 42.99s ago] (7139312538, 1, 0)
2025-03-21 14:48:21,202 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:21,202 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:21,202 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:21,203 - sqlalchemy.engine.Engine - INFO - [cached since 42.99s ago] (7139312538, 1, 0)
2025-03-21 14:48:21,204 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:21,205 - sqlalchemy.engine.Engine - INFO - [cached since 40.01s ago] (1, 'premium', 1, 0)
2025-03-21 14:48:21,205 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:22,534 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:22,534 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:22,535 - sqlalchemy.engine.Engine - INFO - [cached since 44.33s ago] (7139312538, 1, 0)
2025-03-21 14:48:22,536 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:22,537 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:22,538 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:22,539 - sqlalchemy.engine.Engine - INFO - [cached since 44.33s ago] (7139312538, 1, 0)
2025-03-21 14:48:22,540 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:22,540 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:22,541 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:22,541 - sqlalchemy.engine.Engine - INFO - [cached since 44.33s ago] (7139312538, 1, 0)
2025-03-21 14:48:22,541 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:23,520 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:23,521 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:23,521 - sqlalchemy.engine.Engine - INFO - [cached since 45.31s ago] (7139312538, 1, 0)
2025-03-21 14:48:23,522 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:23,523 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:23,525 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:23,525 - sqlalchemy.engine.Engine - INFO - [cached since 45.32s ago] (7139312538, 1, 0)
2025-03-21 14:48:23,525 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:23,526 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:23,526 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:23,526 - sqlalchemy.engine.Engine - INFO - [cached since 45.31s ago] (7139312538, 1, 0)
2025-03-21 14:48:23,527 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:23,527 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:23,527 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:23,528 - sqlalchemy.engine.Engine - INFO - [cached since 45.31s ago] (7139312538, 1, 0)
2025-03-21 14:48:23,528 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:23,529 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:23,529 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:23,530 - sqlalchemy.engine.Engine - INFO - [cached since 34.57s ago] ('TEST', 1, 0)
2025-03-21 14:48:23,531 - sqlalchemy.engine.Engine - INFO - SELECT promo_uses.id AS promo_uses_id, promo_uses.promo_id AS promo_uses_promo_id, promo_uses.user_tg_id AS promo_uses_user_tg_id, promo_uses.used_at AS promo_uses_used_at 
FROM promo_uses 
WHERE promo_uses.promo_id = ? AND promo_uses.user_tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:23,531 - sqlalchemy.engine.Engine - INFO - [cached since 22.67s ago] (1, 7139312538, 1, 0)
2025-03-21 14:48:23,531 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:26,049 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:26,049 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:26,050 - sqlalchemy.engine.Engine - INFO - [cached since 47.84s ago] (7139312538, 1, 0)
2025-03-21 14:48:26,051 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:26,053 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:26,055 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:26,055 - sqlalchemy.engine.Engine - INFO - [cached since 47.85s ago] (7139312538, 1, 0)
2025-03-21 14:48:26,056 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:26,056 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:26,057 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:26,057 - sqlalchemy.engine.Engine - INFO - [cached since 47.84s ago] (7139312538, 1, 0)
2025-03-21 14:48:26,059 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:27,157 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:27,158 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:27,159 - sqlalchemy.engine.Engine - INFO - [cached since 48.95s ago] (7139312538, 1, 0)
2025-03-21 14:48:27,160 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:27,161 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:27,162 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:27,163 - sqlalchemy.engine.Engine - INFO - [cached since 48.96s ago] (7139312538, 1, 0)
2025-03-21 14:48:27,164 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:27,164 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:27,165 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:27,165 - sqlalchemy.engine.Engine - INFO - [cached since 48.95s ago] (7139312538, 1, 0)
2025-03-21 14:48:27,165 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:27,166 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:27,166 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:27,167 - sqlalchemy.engine.Engine - INFO - [cached since 48.95s ago] (7139312538, 1, 0)
2025-03-21 14:48:27,167 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:27,168 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:27,169 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:27,169 - sqlalchemy.engine.Engine - INFO - [cached since 48.96s ago] (7139312538, 1, 0)
2025-03-21 14:48:27,170 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:27,170 - sqlalchemy.engine.Engine - INFO - [cached since 45.97s ago] (1, 'premium', 1, 0)
2025-03-21 14:48:27,171 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:28,437 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:28,437 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:28,438 - sqlalchemy.engine.Engine - INFO - [cached since 50.23s ago] (7139312538, 1, 0)
2025-03-21 14:48:28,439 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:28,441 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:28,441 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:28,442 - sqlalchemy.engine.Engine - INFO - [cached since 50.23s ago] (7139312538, 1, 0)
2025-03-21 14:48:28,443 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:28,445 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:28,446 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:28,446 - sqlalchemy.engine.Engine - INFO - [cached since 50.23s ago] (7139312538, 1, 0)
2025-03-21 14:48:28,449 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:29,578 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:29,579 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:29,579 - sqlalchemy.engine.Engine - INFO - [cached since 51.37s ago] (7139312538, 1, 0)
2025-03-21 14:48:29,580 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:29,581 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:29,581 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:29,582 - sqlalchemy.engine.Engine - INFO - [cached since 51.37s ago] (7139312538, 1, 0)
2025-03-21 14:48:29,582 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:29,583 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:29,583 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:29,583 - sqlalchemy.engine.Engine - INFO - [cached since 51.37s ago] (7139312538, 1, 0)
2025-03-21 14:48:29,583 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:29,583 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:29,585 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:29,586 - sqlalchemy.engine.Engine - INFO - [cached since 51.37s ago] (7139312538, 1, 0)
2025-03-21 14:48:29,587 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:29,587 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:29,588 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:29,588 - sqlalchemy.engine.Engine - INFO - [cached since 40.62s ago] ('TEST2', 1, 0)
2025-03-21 14:48:29,588 - sqlalchemy.engine.Engine - INFO - SELECT promo_uses.id AS promo_uses_id, promo_uses.promo_id AS promo_uses_promo_id, promo_uses.user_tg_id AS promo_uses_user_tg_id, promo_uses.used_at AS promo_uses_used_at 
FROM promo_uses 
WHERE promo_uses.promo_id = ? AND promo_uses.user_tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:29,589 - sqlalchemy.engine.Engine - INFO - [cached since 28.73s ago] (2, 7139312538, 1, 0)
2025-03-21 14:48:29,589 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:29,589 - sqlalchemy.engine.Engine - INFO - [cached since 51.38s ago] (7139312538, 1, 0)
2025-03-21 14:48:29,590 - sqlalchemy.engine.Engine - INFO - UPDATE promo_codes SET uses_count=? WHERE promo_codes.id = ?
2025-03-21 14:48:29,590 - sqlalchemy.engine.Engine - INFO - [cached since 28.72s ago] (1, 2)
2025-03-21 14:48:29,592 - sqlalchemy.engine.Engine - INFO - INSERT INTO promo_uses (promo_id, user_tg_id, used_at) VALUES (?, ?, ?)
2025-03-21 14:48:29,592 - sqlalchemy.engine.Engine - INFO - [cached since 28.72s ago] (2, 7139312538, '2025-03-21 12:48:29.591850')
2025-03-21 14:48:29,595 - sqlalchemy.engine.Engine - INFO - UPDATE users SET premium_end_date=?, updated_at=?, premium_until=? WHERE users.id = ?
2025-03-21 14:48:29,596 - sqlalchemy.engine.Engine - INFO - [generated in 0.00147s] ('2025-04-04 14:48:00.865070', '2025-03-21 12:48:29.593846', '2025-04-04 14:48:00.865070', 1)
2025-03-21 14:48:29,596 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:48:29,599 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:29,600 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.id = ?
2025-03-21 14:48:29,600 - sqlalchemy.engine.Engine - INFO - [cached since 28.72s ago] (2,)
2025-03-21 14:48:29,601 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:29,601 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:29,601 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:29,602 - sqlalchemy.engine.Engine - INFO - [cached since 51.39s ago] (7139312538, 1, 0)
2025-03-21 14:48:29,602 - sqlalchemy.engine.Engine - INFO - SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements 
WHERE achievements."key" = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:29,602 - sqlalchemy.engine.Engine - INFO - [cached since 28.72s ago] ('legend', 1, 0)
2025-03-21 14:48:29,603 - sqlalchemy.engine.Engine - INFO - SELECT user_achievements.id AS user_achievements_id, user_achievements.user_id AS user_achievements_user_id, user_achievements.achievement_id AS user_achievements_achievement_id, user_achievements.achieved_at AS user_achievements_achieved_at 
FROM user_achievements 
WHERE user_achievements.user_id = ? AND user_achievements.achievement_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:29,603 - sqlalchemy.engine.Engine - INFO - [cached since 28.72s ago] (1, 5, 1, 0)
2025-03-21 14:48:29,603 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:29,605 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-172' coro=<Dispatcher._process_polling_updates() done, defined at C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py:407> exception=KeyError('code')>
Traceback (most recent call last):
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 415, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 235, in process_updates
    return await asyncio.gather(*tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 256, in process_update
    return await self.message_handlers.notify(update.message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\handlers\premium.py", line 142, in process_promo_code
    user_locale.get("promo_code_success", "").format(days=days, date=end_date),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyError: 'code'
2025-03-21 14:48:43,843 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:43,844 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:43,844 - sqlalchemy.engine.Engine - INFO - [cached since 65.64s ago] (7139312538, 1, 0)
2025-03-21 14:48:43,845 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:47,986 - aiogram.dispatcher.dispatcher - INFO - Stop polling...
2025-03-21 14:48:47,986 - aiogram - WARNING - Goodbye!
2025-03-21 14:48:49,625 - __main__ - INFO - Запуск бота...
2025-03-21 14:48:49,903 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:49,904 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-03-21 14:48:49,904 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:48:49,906 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referrals")
2025-03-21 14:48:49,906 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:48:49,907 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("announcements")
2025-03-21 14:48:49,908 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:48:49,908 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("reports")
2025-03-21 14:48:49,909 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:48:49,910 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("favorites")
2025-03-21 14:48:49,910 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:48:49,910 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("crystal_transactions")
2025-03-21 14:48:49,910 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:48:49,911 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("premium_prices")
2025-03-21 14:48:49,911 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:48:49,911 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sponsors")
2025-03-21 14:48:49,911 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:48:49,912 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_sponsor_subscriptions")
2025-03-21 14:48:49,912 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:48:49,912 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_codes")
2025-03-21 14:48:49,912 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:48:49,913 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_uses")
2025-03-21 14:48:49,913 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:48:49,913 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-03-21 14:48:49,913 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:48:49,914 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_achievements")
2025-03-21 14:48:49,914 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:48:49,914 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_visited_sections")
2025-03-21 14:48:49,914 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:48:49,914 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_secret_purchases")
2025-03-21 14:48:49,916 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:48:49,916 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("bot_settings")
2025-03-21 14:48:49,916 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:48:49,916 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:48:49,934 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:49,937 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:49,938 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] (30, 1, 0)
2025-03-21 14:48:49,939 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:49,940 - sqlalchemy.engine.Engine - INFO - [cached since 0.002139s ago] (180, 1, 0)
2025-03-21 14:48:49,940 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:49,940 - sqlalchemy.engine.Engine - INFO - [cached since 0.003069s ago] (365, 1, 0)
2025-03-21 14:48:49,941 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:49,941 - sqlalchemy.engine.Engine - INFO - [cached since 0.004017s ago] (36500, 1, 0)
2025-03-21 14:48:49,942 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:48:49,956 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:49,962 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements) AS anon_1
2025-03-21 14:48:49,963 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] ()
2025-03-21 14:48:49,964 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:49,967 - root - INFO - Achievements handlers registered successfully
2025-03-21 14:48:50,105 - aiogram - INFO - Bot: Бубсер Поиск Бот [@Bubser_PoiskBot]
2025-03-21 14:48:50,187 - aiogram - WARNING - Updates were skipped successfully.
2025-03-21 14:48:50,187 - __main__ - INFO - Бот успешно запущен!
2025-03-21 14:48:50,188 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:50,190 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.tg_id, users.username, users.first_name, users.is_premium, users.premium_end_date, users.crystals, users.language, users.blocked, users.last_gift, users.created_at, users.updated_at, users.coins, users.premium_until 
FROM users 
WHERE users.is_premium = 1 AND users.premium_end_date <= ?
2025-03-21 14:48:50,190 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] ('2025-03-21 14:48:50.188422',)
2025-03-21 14:48:50,191 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:48:50,191 - aiogram.dispatcher.dispatcher - INFO - Start polling.
2025-03-21 14:48:52,519 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:52,520 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:52,521 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] (7139312538, 1, 0)
2025-03-21 14:48:52,522 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:52,523 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:52,523 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:52,523 - sqlalchemy.engine.Engine - INFO - [cached since 0.00323s ago] (7139312538, 1, 0)
2025-03-21 14:48:52,524 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:52,524 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:52,526 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:52,526 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] (7139312538, 1, 0)
2025-03-21 14:48:52,527 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:52,527 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:52,529 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:52,529 - sqlalchemy.engine.Engine - INFO - [cached since 0.003152s ago] (7139312538, 1, 0)
2025-03-21 14:48:52,530 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:52,530 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:52,531 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:52,531 - sqlalchemy.engine.Engine - INFO - [cached since 0.005527s ago] (7139312538, 1, 0)
2025-03-21 14:48:52,532 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:52,533 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:52,533 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:52,533 - sqlalchemy.engine.Engine - INFO - [cached since 0.007909s ago] (7139312538, 1, 0)
2025-03-21 14:48:52,534 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:53,483 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:53,485 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:53,486 - sqlalchemy.engine.Engine - INFO - [cached since 0.9648s ago] (7139312538, 1, 0)
2025-03-21 14:48:53,487 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:53,488 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:53,488 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:53,488 - sqlalchemy.engine.Engine - INFO - [cached since 0.9676s ago] (7139312538, 1, 0)
2025-03-21 14:48:53,489 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:53,489 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:53,489 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:53,490 - sqlalchemy.engine.Engine - INFO - [cached since 0.9633s ago] (7139312538, 1, 0)
2025-03-21 14:48:53,491 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:54,270 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:54,271 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:54,272 - sqlalchemy.engine.Engine - INFO - [cached since 1.752s ago] (7139312538, 1, 0)
2025-03-21 14:48:54,273 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:54,275 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:54,276 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:54,276 - sqlalchemy.engine.Engine - INFO - [cached since 1.756s ago] (7139312538, 1, 0)
2025-03-21 14:48:54,278 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:54,278 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:54,279 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:54,279 - sqlalchemy.engine.Engine - INFO - [cached since 1.753s ago] (7139312538, 1, 0)
2025-03-21 14:48:54,280 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:54,281 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:54,281 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:54,281 - sqlalchemy.engine.Engine - INFO - [cached since 1.755s ago] (7139312538, 1, 0)
2025-03-21 14:48:54,282 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:54,283 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:54,283 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:54,283 - sqlalchemy.engine.Engine - INFO - [cached since 1.758s ago] (7139312538, 1, 0)
2025-03-21 14:48:54,285 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:54,285 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] (1, 'premium', 1, 0)
2025-03-21 14:48:54,285 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:55,370 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:55,371 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:55,371 - sqlalchemy.engine.Engine - INFO - [cached since 2.851s ago] (7139312538, 1, 0)
2025-03-21 14:48:55,373 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:55,375 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:55,376 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:55,376 - sqlalchemy.engine.Engine - INFO - [cached since 2.856s ago] (7139312538, 1, 0)
2025-03-21 14:48:55,376 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:55,377 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:55,377 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:55,378 - sqlalchemy.engine.Engine - INFO - [cached since 2.852s ago] (7139312538, 1, 0)
2025-03-21 14:48:55,380 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:56,593 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:56,621 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:56,622 - sqlalchemy.engine.Engine - INFO - [cached since 4.102s ago] (7139312538, 1, 0)
2025-03-21 14:48:56,623 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:56,625 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:56,625 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:56,626 - sqlalchemy.engine.Engine - INFO - [cached since 4.105s ago] (7139312538, 1, 0)
2025-03-21 14:48:56,626 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:56,628 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:56,629 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:56,629 - sqlalchemy.engine.Engine - INFO - [cached since 4.103s ago] (7139312538, 1, 0)
2025-03-21 14:48:56,630 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:56,631 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:56,632 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:56,633 - sqlalchemy.engine.Engine - INFO - [cached since 4.106s ago] (7139312538, 1, 0)
2025-03-21 14:48:56,634 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:56,635 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:56,647 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:56,648 - sqlalchemy.engine.Engine - INFO - [generated in 0.00100s] ('TEST', 1, 0)
2025-03-21 14:48:56,652 - sqlalchemy.engine.Engine - INFO - SELECT promo_uses.id AS promo_uses_id, promo_uses.promo_id AS promo_uses_promo_id, promo_uses.user_tg_id AS promo_uses_user_tg_id, promo_uses.used_at AS promo_uses_used_at 
FROM promo_uses 
WHERE promo_uses.promo_id = ? AND promo_uses.user_tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:56,652 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] (1, 7139312538, 1, 0)
2025-03-21 14:48:56,653 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:57,779 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:57,780 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:57,780 - sqlalchemy.engine.Engine - INFO - [cached since 5.259s ago] (7139312538, 1, 0)
2025-03-21 14:48:57,781 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:57,782 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:57,782 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:57,783 - sqlalchemy.engine.Engine - INFO - [cached since 5.262s ago] (7139312538, 1, 0)
2025-03-21 14:48:57,784 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:57,784 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:57,785 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:57,785 - sqlalchemy.engine.Engine - INFO - [cached since 5.259s ago] (7139312538, 1, 0)
2025-03-21 14:48:57,786 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:58,571 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:58,572 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:58,572 - sqlalchemy.engine.Engine - INFO - [cached since 6.052s ago] (7139312538, 1, 0)
2025-03-21 14:48:58,573 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:58,577 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:58,577 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:58,577 - sqlalchemy.engine.Engine - INFO - [cached since 6.057s ago] (7139312538, 1, 0)
2025-03-21 14:48:58,578 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:58,578 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:58,579 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:58,579 - sqlalchemy.engine.Engine - INFO - [cached since 6.053s ago] (7139312538, 1, 0)
2025-03-21 14:48:58,580 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:58,583 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:58,584 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:58,584 - sqlalchemy.engine.Engine - INFO - [cached since 6.058s ago] (7139312538, 1, 0)
2025-03-21 14:48:58,585 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:48:58,586 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:48:58,588 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:58,588 - sqlalchemy.engine.Engine - INFO - [cached since 6.062s ago] (7139312538, 1, 0)
2025-03-21 14:48:58,591 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:48:58,591 - sqlalchemy.engine.Engine - INFO - [cached since 4.306s ago] (1, 'premium', 1, 0)
2025-03-21 14:48:58,592 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:00,187 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:00,189 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:00,190 - sqlalchemy.engine.Engine - INFO - [cached since 7.669s ago] (7139312538, 1, 0)
2025-03-21 14:49:00,191 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:00,194 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:00,195 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:00,196 - sqlalchemy.engine.Engine - INFO - [cached since 7.675s ago] (7139312538, 1, 0)
2025-03-21 14:49:00,196 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:00,197 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:00,197 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:00,197 - sqlalchemy.engine.Engine - INFO - [cached since 7.671s ago] (7139312538, 1, 0)
2025-03-21 14:49:00,200 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:01,138 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:01,139 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:01,140 - sqlalchemy.engine.Engine - INFO - [cached since 8.619s ago] (7139312538, 1, 0)
2025-03-21 14:49:01,141 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:01,142 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:01,143 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:01,143 - sqlalchemy.engine.Engine - INFO - [cached since 8.623s ago] (7139312538, 1, 0)
2025-03-21 14:49:01,146 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:01,147 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:01,147 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:01,147 - sqlalchemy.engine.Engine - INFO - [cached since 8.621s ago] (7139312538, 1, 0)
2025-03-21 14:49:01,148 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:01,149 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:01,149 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:01,150 - sqlalchemy.engine.Engine - INFO - [cached since 8.623s ago] (7139312538, 1, 0)
2025-03-21 14:49:01,152 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:01,152 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:01,153 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:01,153 - sqlalchemy.engine.Engine - INFO - [cached since 4.505s ago] ('TEST2', 1, 0)
2025-03-21 14:49:01,155 - sqlalchemy.engine.Engine - INFO - SELECT promo_uses.id AS promo_uses_id, promo_uses.promo_id AS promo_uses_promo_id, promo_uses.user_tg_id AS promo_uses_user_tg_id, promo_uses.used_at AS promo_uses_used_at 
FROM promo_uses 
WHERE promo_uses.promo_id = ? AND promo_uses.user_tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:01,155 - sqlalchemy.engine.Engine - INFO - [cached since 4.503s ago] (2, 7139312538, 1, 0)
2025-03-21 14:49:01,155 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:05,942 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:05,943 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:05,943 - sqlalchemy.engine.Engine - INFO - [cached since 13.42s ago] (7139312538, 1, 0)
2025-03-21 14:49:05,943 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:05,946 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:05,946 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:05,947 - sqlalchemy.engine.Engine - INFO - [cached since 13.43s ago] (7139312538, 1, 0)
2025-03-21 14:49:05,947 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:05,947 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:05,948 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:05,948 - sqlalchemy.engine.Engine - INFO - [cached since 13.42s ago] (7139312538, 1, 0)
2025-03-21 14:49:05,948 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:05,949 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:05,950 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:05,950 - sqlalchemy.engine.Engine - INFO - [cached since 13.42s ago] (7139312538, 1, 0)
2025-03-21 14:49:05,951 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:08,211 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:08,211 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:08,212 - sqlalchemy.engine.Engine - INFO - [cached since 15.69s ago] (7139312538, 1, 0)
2025-03-21 14:49:08,213 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:08,213 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:08,214 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:08,214 - sqlalchemy.engine.Engine - INFO - [cached since 15.69s ago] (7139312538, 1, 0)
2025-03-21 14:49:08,214 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:08,215 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:08,215 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:08,215 - sqlalchemy.engine.Engine - INFO - [cached since 15.69s ago] (7139312538, 1, 0)
2025-03-21 14:49:08,216 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:08,327 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:08,328 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:08,329 - sqlalchemy.engine.Engine - INFO - [cached since 15.8s ago] (7139312538, 1, 0)
2025-03-21 14:49:08,331 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:08,417 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:08,418 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes
2025-03-21 14:49:08,418 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ()
2025-03-21 14:49:08,419 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:11,202 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:11,203 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:11,203 - sqlalchemy.engine.Engine - INFO - [cached since 18.68s ago] (7139312538, 1, 0)
2025-03-21 14:49:11,204 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:11,206 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:11,207 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:11,207 - sqlalchemy.engine.Engine - INFO - [cached since 18.69s ago] (7139312538, 1, 0)
2025-03-21 14:49:11,208 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:11,209 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:11,209 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:11,209 - sqlalchemy.engine.Engine - INFO - [cached since 18.68s ago] (7139312538, 1, 0)
2025-03-21 14:49:11,211 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:11,214 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:11,214 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:11,215 - sqlalchemy.engine.Engine - INFO - [cached since 18.69s ago] (7139312538, 1, 0)
2025-03-21 14:49:11,215 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:11,218 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:11,218 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:11,218 - sqlalchemy.engine.Engine - INFO - [cached since 18.69s ago] (7139312538, 1, 0)
2025-03-21 14:49:11,219 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:11,221 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:11,221 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:11,222 - sqlalchemy.engine.Engine - INFO - [cached since 18.7s ago] (7139312538, 1, 0)
2025-03-21 14:49:11,223 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:12,131 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:12,132 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:12,132 - sqlalchemy.engine.Engine - INFO - [cached since 19.61s ago] (7139312538, 1, 0)
2025-03-21 14:49:12,133 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:12,134 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:12,134 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:12,134 - sqlalchemy.engine.Engine - INFO - [cached since 19.61s ago] (7139312538, 1, 0)
2025-03-21 14:49:12,135 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:12,135 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:12,135 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:12,136 - sqlalchemy.engine.Engine - INFO - [cached since 19.61s ago] (7139312538, 1, 0)
2025-03-21 14:49:12,138 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:13,400 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:13,401 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:13,402 - sqlalchemy.engine.Engine - INFO - [cached since 20.88s ago] (7139312538, 1, 0)
2025-03-21 14:49:13,402 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:13,404 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:13,405 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:13,405 - sqlalchemy.engine.Engine - INFO - [cached since 20.88s ago] (7139312538, 1, 0)
2025-03-21 14:49:13,405 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:13,406 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:13,406 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:13,406 - sqlalchemy.engine.Engine - INFO - [cached since 20.88s ago] (7139312538, 1, 0)
2025-03-21 14:49:13,408 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:13,410 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:13,410 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:13,410 - sqlalchemy.engine.Engine - INFO - [cached since 20.88s ago] (7139312538, 1, 0)
2025-03-21 14:49:13,411 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:13,411 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:13,411 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:13,411 - sqlalchemy.engine.Engine - INFO - [cached since 20.89s ago] (7139312538, 1, 0)
2025-03-21 14:49:13,412 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:13,412 - sqlalchemy.engine.Engine - INFO - [cached since 19.13s ago] (1, 'premium', 1, 0)
2025-03-21 14:49:13,412 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:14,183 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:14,183 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:14,185 - sqlalchemy.engine.Engine - INFO - [cached since 21.66s ago] (7139312538, 1, 0)
2025-03-21 14:49:14,186 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:14,189 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:14,191 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:14,191 - sqlalchemy.engine.Engine - INFO - [cached since 21.67s ago] (7139312538, 1, 0)
2025-03-21 14:49:14,192 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:14,194 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:14,195 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:14,195 - sqlalchemy.engine.Engine - INFO - [cached since 21.67s ago] (7139312538, 1, 0)
2025-03-21 14:49:14,196 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:14,960 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:14,961 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:14,961 - sqlalchemy.engine.Engine - INFO - [cached since 22.44s ago] (7139312538, 1, 0)
2025-03-21 14:49:14,962 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:14,963 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:14,963 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:14,963 - sqlalchemy.engine.Engine - INFO - [cached since 22.44s ago] (7139312538, 1, 0)
2025-03-21 14:49:14,965 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:14,965 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:14,965 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:14,965 - sqlalchemy.engine.Engine - INFO - [cached since 22.44s ago] (7139312538, 1, 0)
2025-03-21 14:49:14,966 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:14,966 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:14,967 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:14,967 - sqlalchemy.engine.Engine - INFO - [cached since 22.44s ago] (7139312538, 1, 0)
2025-03-21 14:49:14,968 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:14,968 - sqlalchemy.engine.Engine - INFO - [cached since 20.68s ago] (1, 'crystals', 1, 0)
2025-03-21 14:49:14,970 - sqlalchemy.engine.Engine - INFO - INSERT INTO user_visited_sections (user_id, section, visited_at) VALUES (?, ?, ?)
2025-03-21 14:49:14,970 - sqlalchemy.engine.Engine - INFO - [generated in 0.00083s] (1, 'crystals', '2025-03-21 12:49:14.970499')
2025-03-21 14:49:14,973 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:49:14,974 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:14,977 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
2025-03-21 14:49:14,978 - sqlalchemy.engine.Engine - INFO - [generated in 0.00088s] (1,)
2025-03-21 14:49:14,981 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.section AS user_visited_sections_section 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section IN (?, ?, ?, ?, ?, ?)
2025-03-21 14:49:14,982 - sqlalchemy.engine.Engine - INFO - [generated in 0.00091s] (1, 'search_team_menu', 'search_club_menu', 'crystals', 'premium', 'additional', 'gift')
2025-03-21 14:49:14,983 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:14,983 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:14,984 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:14,985 - sqlalchemy.engine.Engine - INFO - [cached since 22.46s ago] (7139312538, 1, 0)
2025-03-21 14:49:14,985 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:15,129 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:15,130 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:15,131 - sqlalchemy.engine.Engine - INFO - [cached since 22.61s ago] (7139312538, 1, 0)
2025-03-21 14:49:15,132 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:15,886 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:15,886 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:15,887 - sqlalchemy.engine.Engine - INFO - [cached since 23.37s ago] (7139312538, 1, 0)
2025-03-21 14:49:15,887 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:15,888 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:15,889 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:15,890 - sqlalchemy.engine.Engine - INFO - [cached since 23.37s ago] (7139312538, 1, 0)
2025-03-21 14:49:15,890 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:15,890 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:15,891 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:15,891 - sqlalchemy.engine.Engine - INFO - [cached since 23.36s ago] (7139312538, 1, 0)
2025-03-21 14:49:15,892 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:16,635 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:16,635 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:16,636 - sqlalchemy.engine.Engine - INFO - [cached since 24.12s ago] (7139312538, 1, 0)
2025-03-21 14:49:16,637 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:16,639 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:16,640 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:16,641 - sqlalchemy.engine.Engine - INFO - [cached since 24.12s ago] (7139312538, 1, 0)
2025-03-21 14:49:16,642 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:16,642 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:16,643 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:16,643 - sqlalchemy.engine.Engine - INFO - [cached since 24.12s ago] (7139312538, 1, 0)
2025-03-21 14:49:16,645 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:16,697 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:16,697 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:16,698 - sqlalchemy.engine.Engine - INFO - [cached since 24.17s ago] (7139312538, 1, 0)
2025-03-21 14:49:16,701 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:16,703 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:16,703 - sqlalchemy.engine.Engine - INFO - [cached since 24.18s ago] (7139312538, 1, 0)
2025-03-21 14:49:16,708 - sqlalchemy.engine.Engine - INFO - SELECT user_achievements.id AS user_achievements_id, user_achievements.user_id AS user_achievements_user_id, user_achievements.achievement_id AS user_achievements_achievement_id, user_achievements.achieved_at AS user_achievements_achieved_at, achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM user_achievements JOIN achievements ON user_achievements.achievement_id = achievements.id 
WHERE user_achievements.user_id = ?
2025-03-21 14:49:16,709 - sqlalchemy.engine.Engine - INFO - [generated in 0.00101s] (1,)
2025-03-21 14:49:16,713 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:16,715 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:16,716 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:16,717 - sqlalchemy.engine.Engine - INFO - [cached since 24.19s ago] (7139312538, 1, 0)
2025-03-21 14:49:16,717 - utils.helpers - ERROR - Error checking premium status: can't compare offset-naive and offset-aware datetimes
2025-03-21 14:49:16,717 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:16,718 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:57,665 - aiogram.dispatcher.dispatcher - INFO - Stop polling...
2025-03-21 14:49:57,665 - aiogram - WARNING - Goodbye!
2025-03-21 14:49:58,848 - __main__ - INFO - Запуск бота...
2025-03-21 14:49:59,167 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:59,167 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-03-21 14:49:59,167 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:49:59,169 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referrals")
2025-03-21 14:49:59,169 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:49:59,169 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("announcements")
2025-03-21 14:49:59,169 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:49:59,169 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("reports")
2025-03-21 14:49:59,170 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:49:59,170 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("favorites")
2025-03-21 14:49:59,170 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:49:59,170 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("crystal_transactions")
2025-03-21 14:49:59,170 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:49:59,171 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("premium_prices")
2025-03-21 14:49:59,171 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:49:59,171 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sponsors")
2025-03-21 14:49:59,171 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:49:59,172 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_sponsor_subscriptions")
2025-03-21 14:49:59,172 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:49:59,172 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_codes")
2025-03-21 14:49:59,172 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:49:59,173 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_uses")
2025-03-21 14:49:59,173 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:49:59,173 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-03-21 14:49:59,173 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:49:59,173 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_achievements")
2025-03-21 14:49:59,175 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:49:59,176 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_visited_sections")
2025-03-21 14:49:59,176 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:49:59,176 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_secret_purchases")
2025-03-21 14:49:59,177 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:49:59,177 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("bot_settings")
2025-03-21 14:49:59,177 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:49:59,178 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:49:59,205 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:59,210 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:59,211 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] (30, 1, 0)
2025-03-21 14:49:59,212 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:59,213 - sqlalchemy.engine.Engine - INFO - [cached since 0.002289s ago] (180, 1, 0)
2025-03-21 14:49:59,213 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:59,213 - sqlalchemy.engine.Engine - INFO - [cached since 0.003322s ago] (365, 1, 0)
2025-03-21 14:49:59,214 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:49:59,216 - sqlalchemy.engine.Engine - INFO - [cached since 0.005847s ago] (36500, 1, 0)
2025-03-21 14:49:59,216 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:49:59,232 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:59,237 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements) AS anon_1
2025-03-21 14:49:59,237 - sqlalchemy.engine.Engine - INFO - [generated in 0.00121s] ()
2025-03-21 14:49:59,238 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:49:59,241 - root - INFO - Achievements handlers registered successfully
2025-03-21 14:49:59,404 - aiogram - INFO - Bot: Бубсер Поиск Бот [@Bubser_PoiskBot]
2025-03-21 14:49:59,483 - aiogram - WARNING - Updates were skipped successfully.
2025-03-21 14:49:59,483 - __main__ - INFO - Бот успешно запущен!
2025-03-21 14:49:59,485 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:49:59,488 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.tg_id, users.username, users.first_name, users.is_premium, users.premium_end_date, users.crystals, users.language, users.blocked, users.last_gift, users.created_at, users.updated_at, users.coins, users.premium_until 
FROM users 
WHERE users.is_premium = 1 AND users.premium_end_date <= ?
2025-03-21 14:49:59,488 - sqlalchemy.engine.Engine - INFO - [generated in 0.00039s] ('2025-03-21 14:49:59.483601',)
2025-03-21 14:49:59,489 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:49:59,489 - aiogram.dispatcher.dispatcher - INFO - Start polling.
2025-03-21 14:50:04,452 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:04,453 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:04,455 - sqlalchemy.engine.Engine - INFO - [generated in 0.00080s] (8053357241, 1, 0)
2025-03-21 14:50:04,456 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:04,457 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:04,457 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:04,458 - sqlalchemy.engine.Engine - INFO - [cached since 0.00468s ago] (8053357241, 1, 0)
2025-03-21 14:50:04,460 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:04,461 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:04,465 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:04,466 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] (8053357241, 1, 0)
2025-03-21 14:50:04,466 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:04,467 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:04,467 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:04,467 - sqlalchemy.engine.Engine - INFO - [cached since 0.00296s ago] (8053357241, 1, 0)
2025-03-21 14:50:04,470 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:04,470 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:04,471 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:04,472 - sqlalchemy.engine.Engine - INFO - [cached since 0.008181s ago] (8053357241, 1, 0)
2025-03-21 14:50:04,473 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:04,473 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:04,473 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:04,475 - sqlalchemy.engine.Engine - INFO - [cached since 0.01033s ago] (8053357241, 1, 0)
2025-03-21 14:50:04,477 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:04,477 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:04,478 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:04,478 - sqlalchemy.engine.Engine - INFO - [cached since 0.01363s ago] (8053357241, 1, 0)
2025-03-21 14:50:04,484 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (tg_id, username, first_name, is_premium, premium_end_date, crystals, language, blocked, last_gift, created_at, updated_at, coins, premium_until) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-03-21 14:50:04,485 - sqlalchemy.engine.Engine - INFO - [generated in 0.00124s] (8053357241, 'maksmaksimov12', 'Maks', 0, None, 100, 'ru', 0, None, '2025-03-21 14:50:04.480486', '2025-03-21 12:50:04.484482', 0, None)
2025-03-21 14:50:04,491 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:50:05,931 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:05,931 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:05,932 - sqlalchemy.engine.Engine - INFO - [cached since 1.479s ago] (8053357241, 1, 0)
2025-03-21 14:50:05,933 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:05,933 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:05,936 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:05,936 - sqlalchemy.engine.Engine - INFO - [cached since 1.483s ago] (8053357241, 1, 0)
2025-03-21 14:50:05,936 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:05,936 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:05,938 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:05,938 - sqlalchemy.engine.Engine - INFO - [cached since 1.473s ago] (8053357241, 1, 0)
2025-03-21 14:50:05,939 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:06,907 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:06,909 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:06,910 - sqlalchemy.engine.Engine - INFO - [cached since 2.456s ago] (8053357241, 1, 0)
2025-03-21 14:50:06,911 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:06,912 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:06,912 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:06,912 - sqlalchemy.engine.Engine - INFO - [cached since 2.459s ago] (8053357241, 1, 0)
2025-03-21 14:50:06,913 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:06,914 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:06,914 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:06,915 - sqlalchemy.engine.Engine - INFO - [cached since 2.45s ago] (8053357241, 1, 0)
2025-03-21 14:50:06,915 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:06,915 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:06,916 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:06,916 - sqlalchemy.engine.Engine - INFO - [cached since 2.452s ago] (8053357241, 1, 0)
2025-03-21 14:50:06,917 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:06,917 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:06,917 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:06,918 - sqlalchemy.engine.Engine - INFO - [cached since 2.453s ago] (8053357241, 1, 0)
2025-03-21 14:50:06,919 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:06,920 - sqlalchemy.engine.Engine - INFO - [generated in 0.00065s] (2, 'premium', 1, 0)
2025-03-21 14:50:06,922 - sqlalchemy.engine.Engine - INFO - INSERT INTO user_visited_sections (user_id, section, visited_at) VALUES (?, ?, ?)
2025-03-21 14:50:06,922 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] (2, 'premium', '2025-03-21 12:50:06.922567')
2025-03-21 14:50:06,923 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:50:06,926 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:06,927 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
2025-03-21 14:50:06,928 - sqlalchemy.engine.Engine - INFO - [generated in 0.00112s] (2,)
2025-03-21 14:50:06,930 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.section AS user_visited_sections_section 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section IN (?, ?, ?, ?, ?, ?)
2025-03-21 14:50:06,931 - sqlalchemy.engine.Engine - INFO - [generated in 0.00076s] (2, 'search_team_menu', 'search_club_menu', 'crystals', 'premium', 'additional', 'gift')
2025-03-21 14:50:06,932 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:07,840 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:07,841 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:07,841 - sqlalchemy.engine.Engine - INFO - [cached since 3.388s ago] (8053357241, 1, 0)
2025-03-21 14:50:07,842 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:07,843 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:07,845 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:07,845 - sqlalchemy.engine.Engine - INFO - [cached since 3.392s ago] (8053357241, 1, 0)
2025-03-21 14:50:07,847 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:07,847 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:07,847 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:07,848 - sqlalchemy.engine.Engine - INFO - [cached since 3.382s ago] (8053357241, 1, 0)
2025-03-21 14:50:07,848 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:08,722 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:08,724 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:08,725 - sqlalchemy.engine.Engine - INFO - [cached since 4.271s ago] (8053357241, 1, 0)
2025-03-21 14:50:08,726 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:08,728 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:08,728 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:08,729 - sqlalchemy.engine.Engine - INFO - [cached since 4.276s ago] (8053357241, 1, 0)
2025-03-21 14:50:08,729 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:08,730 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:08,730 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:08,731 - sqlalchemy.engine.Engine - INFO - [cached since 4.266s ago] (8053357241, 1, 0)
2025-03-21 14:50:08,732 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:08,733 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:08,733 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:08,733 - sqlalchemy.engine.Engine - INFO - [cached since 4.269s ago] (8053357241, 1, 0)
2025-03-21 14:50:08,737 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:08,737 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:50:08,739 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:50:08,740 - sqlalchemy.engine.Engine - INFO - [generated in 0.00070s] (8053357241, 1, 0)
2025-03-21 14:50:08,741 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:50:08,742 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-31' coro=<Dispatcher._process_polling_updates() done, defined at C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py:407> exception=ValueError('not enough values to unpack (expected 3, got 2)')>
Traceback (most recent call last):
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 415, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 235, in process_updates
    return await asyncio.gather(*tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 256, in process_update
    return await self.message_handlers.notify(update.message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\handlers\premium.py", line 127, in process_promo_code
    success, msg, duration_days = use_promo_code(message.from_user.id, promo_code)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 3, got 2)
2025-03-21 14:51:27,721 - aiogram.dispatcher.dispatcher - INFO - Stop polling...
2025-03-21 14:51:27,721 - aiogram - WARNING - Goodbye!
2025-03-21 14:51:29,209 - __main__ - INFO - Запуск бота...
2025-03-21 14:51:29,487 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:29,488 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-03-21 14:51:29,489 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:51:29,490 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referrals")
2025-03-21 14:51:29,490 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:51:29,491 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("announcements")
2025-03-21 14:51:29,492 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:51:29,493 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("reports")
2025-03-21 14:51:29,493 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:51:29,495 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("favorites")
2025-03-21 14:51:29,495 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:51:29,496 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("crystal_transactions")
2025-03-21 14:51:29,496 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:51:29,497 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("premium_prices")
2025-03-21 14:51:29,497 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:51:29,497 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sponsors")
2025-03-21 14:51:29,497 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:51:29,497 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_sponsor_subscriptions")
2025-03-21 14:51:29,497 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:51:29,498 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_codes")
2025-03-21 14:51:29,498 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:51:29,498 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_uses")
2025-03-21 14:51:29,498 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:51:29,498 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-03-21 14:51:29,499 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:51:29,499 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_achievements")
2025-03-21 14:51:29,499 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:51:29,499 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_visited_sections")
2025-03-21 14:51:29,499 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:51:29,499 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_secret_purchases")
2025-03-21 14:51:29,500 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:51:29,500 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("bot_settings")
2025-03-21 14:51:29,500 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:51:29,500 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:51:29,530 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:29,533 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:29,533 - sqlalchemy.engine.Engine - INFO - [generated in 0.00045s] (30, 1, 0)
2025-03-21 14:51:29,533 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:29,535 - sqlalchemy.engine.Engine - INFO - [cached since 0.001684s ago] (180, 1, 0)
2025-03-21 14:51:29,536 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:29,536 - sqlalchemy.engine.Engine - INFO - [cached since 0.003513s ago] (365, 1, 0)
2025-03-21 14:51:29,538 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:29,538 - sqlalchemy.engine.Engine - INFO - [cached since 0.005521s ago] (36500, 1, 0)
2025-03-21 14:51:29,539 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:51:29,561 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:29,567 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements) AS anon_1
2025-03-21 14:51:29,567 - sqlalchemy.engine.Engine - INFO - [generated in 0.00072s] ()
2025-03-21 14:51:29,571 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:29,573 - root - INFO - Achievements handlers registered successfully
2025-03-21 14:51:29,708 - aiogram - INFO - Bot: Бубсер Поиск Бот [@Bubser_PoiskBot]
2025-03-21 14:51:29,790 - aiogram - WARNING - Updates were skipped successfully.
2025-03-21 14:51:29,790 - __main__ - INFO - Бот успешно запущен!
2025-03-21 14:51:29,790 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:29,793 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.tg_id, users.username, users.first_name, users.is_premium, users.premium_end_date, users.crystals, users.language, users.blocked, users.last_gift, users.created_at, users.updated_at, users.coins, users.premium_until 
FROM users 
WHERE users.is_premium = 1 AND users.premium_end_date <= ?
2025-03-21 14:51:29,795 - sqlalchemy.engine.Engine - INFO - [generated in 0.00139s] ('2025-03-21 14:51:29.790536',)
2025-03-21 14:51:29,796 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:51:29,797 - aiogram.dispatcher.dispatcher - INFO - Start polling.
2025-03-21 14:51:30,717 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:30,720 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:30,721 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] (8053357241, 1, 0)
2025-03-21 14:51:30,721 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:30,723 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:30,724 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:30,725 - sqlalchemy.engine.Engine - INFO - [cached since 0.004549s ago] (8053357241, 1, 0)
2025-03-21 14:51:30,725 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:30,726 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:30,727 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:30,727 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] (8053357241, 1, 0)
2025-03-21 14:51:30,728 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:30,729 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:30,729 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:30,729 - sqlalchemy.engine.Engine - INFO - [cached since 0.00242s ago] (8053357241, 1, 0)
2025-03-21 14:51:30,730 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:30,732 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:30,732 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:30,733 - sqlalchemy.engine.Engine - INFO - [cached since 0.005795s ago] (8053357241, 1, 0)
2025-03-21 14:51:30,733 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:30,733 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:30,733 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:30,735 - sqlalchemy.engine.Engine - INFO - [cached since 0.007166s ago] (8053357241, 1, 0)
2025-03-21 14:51:30,735 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:31,696 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:31,696 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:31,697 - sqlalchemy.engine.Engine - INFO - [cached since 0.9762s ago] (8053357241, 1, 0)
2025-03-21 14:51:31,698 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:31,698 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:31,699 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:31,699 - sqlalchemy.engine.Engine - INFO - [cached since 0.9786s ago] (8053357241, 1, 0)
2025-03-21 14:51:31,699 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:31,700 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:31,700 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:31,701 - sqlalchemy.engine.Engine - INFO - [cached since 0.9734s ago] (8053357241, 1, 0)
2025-03-21 14:51:31,702 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:33,003 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:33,004 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:33,005 - sqlalchemy.engine.Engine - INFO - [cached since 2.285s ago] (8053357241, 1, 0)
2025-03-21 14:51:33,006 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:33,007 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:33,008 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:33,008 - sqlalchemy.engine.Engine - INFO - [cached since 2.288s ago] (8053357241, 1, 0)
2025-03-21 14:51:33,009 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:33,011 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:33,011 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:33,011 - sqlalchemy.engine.Engine - INFO - [cached since 2.284s ago] (8053357241, 1, 0)
2025-03-21 14:51:33,012 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:33,013 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:33,013 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:33,013 - sqlalchemy.engine.Engine - INFO - [cached since 2.286s ago] (8053357241, 1, 0)
2025-03-21 14:51:33,014 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:33,014 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:33,015 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:33,015 - sqlalchemy.engine.Engine - INFO - [cached since 2.288s ago] (8053357241, 1, 0)
2025-03-21 14:51:33,019 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:33,020 - sqlalchemy.engine.Engine - INFO - [generated in 0.00055s] (2, 'premium', 1, 0)
2025-03-21 14:51:33,021 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:33,858 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:33,858 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:33,858 - sqlalchemy.engine.Engine - INFO - [cached since 3.138s ago] (8053357241, 1, 0)
2025-03-21 14:51:33,860 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:33,860 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:33,861 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:33,861 - sqlalchemy.engine.Engine - INFO - [cached since 3.141s ago] (8053357241, 1, 0)
2025-03-21 14:51:33,861 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:33,862 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:33,862 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:33,862 - sqlalchemy.engine.Engine - INFO - [cached since 3.135s ago] (8053357241, 1, 0)
2025-03-21 14:51:33,866 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:34,927 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:34,928 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:34,928 - sqlalchemy.engine.Engine - INFO - [cached since 4.208s ago] (8053357241, 1, 0)
2025-03-21 14:51:34,929 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:34,930 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:34,930 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:34,930 - sqlalchemy.engine.Engine - INFO - [cached since 4.21s ago] (8053357241, 1, 0)
2025-03-21 14:51:34,931 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:34,931 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:34,932 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:34,932 - sqlalchemy.engine.Engine - INFO - [cached since 4.205s ago] (8053357241, 1, 0)
2025-03-21 14:51:34,934 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:34,935 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:34,935 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:34,935 - sqlalchemy.engine.Engine - INFO - [cached since 4.209s ago] (8053357241, 1, 0)
2025-03-21 14:51:34,937 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:34,939 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:51:34,941 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:51:34,942 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] (8053357241, 1, 0)
2025-03-21 14:51:34,942 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:51:34,943 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-31' coro=<Dispatcher._process_polling_updates() done, defined at C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py:407> exception=KeyError(0)>
Traceback (most recent call last):
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 415, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 235, in process_updates
    return await asyncio.gather(*tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 256, in process_update
    return await self.message_handlers.notify(update.message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\handlers\premium.py", line 128, in process_promo_code
    success = result[0]
              ~~~~~~^^^
KeyError: 0
2025-03-21 14:52:57,153 - aiogram.dispatcher.dispatcher - INFO - Stop polling...
2025-03-21 14:52:57,153 - aiogram - WARNING - Goodbye!
2025-03-21 14:52:58,297 - __main__ - INFO - Запуск бота...
2025-03-21 14:52:58,567 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:52:58,568 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-03-21 14:52:58,568 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:52:58,570 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referrals")
2025-03-21 14:52:58,571 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:52:58,571 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("announcements")
2025-03-21 14:52:58,571 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:52:58,572 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("reports")
2025-03-21 14:52:58,572 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:52:58,573 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("favorites")
2025-03-21 14:52:58,573 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:52:58,574 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("crystal_transactions")
2025-03-21 14:52:58,574 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:52:58,574 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("premium_prices")
2025-03-21 14:52:58,574 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:52:58,574 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sponsors")
2025-03-21 14:52:58,575 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:52:58,575 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_sponsor_subscriptions")
2025-03-21 14:52:58,576 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:52:58,576 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_codes")
2025-03-21 14:52:58,577 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:52:58,577 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_uses")
2025-03-21 14:52:58,577 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:52:58,577 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-03-21 14:52:58,577 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:52:58,578 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_achievements")
2025-03-21 14:52:58,580 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:52:58,580 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_visited_sections")
2025-03-21 14:52:58,580 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:52:58,581 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_secret_purchases")
2025-03-21 14:52:58,581 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:52:58,583 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("bot_settings")
2025-03-21 14:52:58,583 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:52:58,583 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:52:58,605 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:52:58,608 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:52:58,609 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] (30, 1, 0)
2025-03-21 14:52:58,612 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:52:58,612 - sqlalchemy.engine.Engine - INFO - [cached since 0.004053s ago] (180, 1, 0)
2025-03-21 14:52:58,614 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:52:58,614 - sqlalchemy.engine.Engine - INFO - [cached since 0.006137s ago] (365, 1, 0)
2025-03-21 14:52:58,615 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:52:58,615 - sqlalchemy.engine.Engine - INFO - [cached since 0.007422s ago] (36500, 1, 0)
2025-03-21 14:52:58,616 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:52:58,629 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:52:58,632 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements) AS anon_1
2025-03-21 14:52:58,632 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] ()
2025-03-21 14:52:58,633 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:52:58,637 - root - INFO - Achievements handlers registered successfully
2025-03-21 14:52:58,779 - aiogram - INFO - Bot: Бубсер Поиск Бот [@Bubser_PoiskBot]
2025-03-21 14:52:58,857 - aiogram - WARNING - Updates were skipped successfully.
2025-03-21 14:52:58,858 - __main__ - INFO - Бот успешно запущен!
2025-03-21 14:52:58,858 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:52:58,861 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.tg_id, users.username, users.first_name, users.is_premium, users.premium_end_date, users.crystals, users.language, users.blocked, users.last_gift, users.created_at, users.updated_at, users.coins, users.premium_until 
FROM users 
WHERE users.is_premium = 1 AND users.premium_end_date <= ?
2025-03-21 14:52:58,861 - sqlalchemy.engine.Engine - INFO - [generated in 0.00062s] ('2025-03-21 14:52:58.858775',)
2025-03-21 14:52:58,863 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:52:58,863 - aiogram.dispatcher.dispatcher - INFO - Start polling.
2025-03-21 14:53:04,333 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:04,336 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:04,337 - sqlalchemy.engine.Engine - INFO - [generated in 0.00095s] (7115599761, 1, 0)
2025-03-21 14:53:04,340 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:04,340 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:04,341 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:04,341 - sqlalchemy.engine.Engine - INFO - [cached since 0.005062s ago] (7115599761, 1, 0)
2025-03-21 14:53:04,342 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:04,342 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:04,343 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:04,345 - sqlalchemy.engine.Engine - INFO - [generated in 0.00077s] (7115599761, 1, 0)
2025-03-21 14:53:04,346 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:04,347 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:04,347 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:04,348 - sqlalchemy.engine.Engine - INFO - [cached since 0.004245s ago] (7115599761, 1, 0)
2025-03-21 14:53:04,349 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:04,349 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:04,351 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:04,351 - sqlalchemy.engine.Engine - INFO - [cached since 0.007558s ago] (7115599761, 1, 0)
2025-03-21 14:53:04,353 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:04,354 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:04,355 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:04,355 - sqlalchemy.engine.Engine - INFO - [cached since 0.01152s ago] (7115599761, 1, 0)
2025-03-21 14:53:04,356 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:04,356 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:04,357 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:04,357 - sqlalchemy.engine.Engine - INFO - [cached since 0.01369s ago] (7115599761, 1, 0)
2025-03-21 14:53:04,359 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (tg_id, username, first_name, is_premium, premium_end_date, crystals, language, blocked, last_gift, created_at, updated_at, coins, premium_until) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-03-21 14:53:04,359 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] (7115599761, 'hhhsleep', 'zzzsleep', 0, None, 100, 'ru', 0, None, '2025-03-21 14:53:04.358688', '2025-03-21 12:53:04.359684', 0, None)
2025-03-21 14:53:04,362 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:53:05,532 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:05,533 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:05,533 - sqlalchemy.engine.Engine - INFO - [cached since 1.197s ago] (7115599761, 1, 0)
2025-03-21 14:53:05,534 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:05,535 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:05,535 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:05,536 - sqlalchemy.engine.Engine - INFO - [cached since 1.2s ago] (7115599761, 1, 0)
2025-03-21 14:53:05,536 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:05,537 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:05,538 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:05,538 - sqlalchemy.engine.Engine - INFO - [cached since 1.195s ago] (7115599761, 1, 0)
2025-03-21 14:53:05,539 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:06,743 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:06,743 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:06,743 - sqlalchemy.engine.Engine - INFO - [cached since 2.408s ago] (7115599761, 1, 0)
2025-03-21 14:53:06,745 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:06,746 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:06,747 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:06,747 - sqlalchemy.engine.Engine - INFO - [cached since 2.411s ago] (7115599761, 1, 0)
2025-03-21 14:53:06,748 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:06,749 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:06,749 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:06,750 - sqlalchemy.engine.Engine - INFO - [cached since 2.406s ago] (7115599761, 1, 0)
2025-03-21 14:53:06,751 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:06,803 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:06,804 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:06,805 - sqlalchemy.engine.Engine - INFO - [cached since 2.462s ago] (7115599761, 1, 0)
2025-03-21 14:53:06,811 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:06,812 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:06,812 - sqlalchemy.engine.Engine - INFO - [cached since 2.468s ago] (7115599761, 1, 0)
2025-03-21 14:53:06,814 - sqlalchemy.engine.Engine - INFO - SELECT user_achievements.id AS user_achievements_id, user_achievements.user_id AS user_achievements_user_id, user_achievements.achievement_id AS user_achievements_achievement_id, user_achievements.achieved_at AS user_achievements_achieved_at, achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM user_achievements JOIN achievements ON user_achievements.achievement_id = achievements.id 
WHERE user_achievements.user_id = ?
2025-03-21 14:53:06,814 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] (3,)
2025-03-21 14:53:06,815 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:06,817 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:06,818 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:06,818 - sqlalchemy.engine.Engine - INFO - [cached since 2.474s ago] (7115599761, 1, 0)
2025-03-21 14:53:06,819 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:06,819 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:08,116 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:08,116 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:08,116 - sqlalchemy.engine.Engine - INFO - [cached since 3.781s ago] (7115599761, 1, 0)
2025-03-21 14:53:08,118 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:08,119 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:08,120 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:08,120 - sqlalchemy.engine.Engine - INFO - [cached since 3.784s ago] (7115599761, 1, 0)
2025-03-21 14:53:08,121 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:08,122 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:08,122 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:08,122 - sqlalchemy.engine.Engine - INFO - [cached since 3.779s ago] (7115599761, 1, 0)
2025-03-21 14:53:08,123 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:08,124 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:08,124 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:08,125 - sqlalchemy.engine.Engine - INFO - [cached since 3.781s ago] (7115599761, 1, 0)
2025-03-21 14:53:08,125 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:08,125 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:08,125 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:08,126 - sqlalchemy.engine.Engine - INFO - [cached since 3.782s ago] (7115599761, 1, 0)
2025-03-21 14:53:08,127 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:08,128 - sqlalchemy.engine.Engine - INFO - [generated in 0.00087s] (3, 'premium', 1, 0)
2025-03-21 14:53:08,130 - sqlalchemy.engine.Engine - INFO - INSERT INTO user_visited_sections (user_id, section, visited_at) VALUES (?, ?, ?)
2025-03-21 14:53:08,131 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] (3, 'premium', '2025-03-21 12:53:08.130419')
2025-03-21 14:53:08,132 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:53:08,136 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:08,137 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
2025-03-21 14:53:08,138 - sqlalchemy.engine.Engine - INFO - [generated in 0.00088s] (3,)
2025-03-21 14:53:08,140 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.section AS user_visited_sections_section 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section IN (?, ?, ?, ?, ?, ?)
2025-03-21 14:53:08,140 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] (3, 'search_team_menu', 'search_club_menu', 'crystals', 'premium', 'additional', 'gift')
2025-03-21 14:53:08,141 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:09,222 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:09,222 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:09,223 - sqlalchemy.engine.Engine - INFO - [cached since 4.887s ago] (7115599761, 1, 0)
2025-03-21 14:53:09,224 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:09,226 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:09,227 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:09,227 - sqlalchemy.engine.Engine - INFO - [cached since 4.891s ago] (7115599761, 1, 0)
2025-03-21 14:53:09,229 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:09,230 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:09,232 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:09,232 - sqlalchemy.engine.Engine - INFO - [cached since 4.889s ago] (7115599761, 1, 0)
2025-03-21 14:53:09,233 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:10,157 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:10,157 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:10,158 - sqlalchemy.engine.Engine - INFO - [cached since 5.822s ago] (7115599761, 1, 0)
2025-03-21 14:53:10,159 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:10,160 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:10,160 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:10,160 - sqlalchemy.engine.Engine - INFO - [cached since 5.825s ago] (7115599761, 1, 0)
2025-03-21 14:53:10,161 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:10,162 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:10,162 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:10,162 - sqlalchemy.engine.Engine - INFO - [cached since 5.819s ago] (7115599761, 1, 0)
2025-03-21 14:53:10,163 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:10,163 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:10,163 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:10,163 - sqlalchemy.engine.Engine - INFO - [cached since 5.821s ago] (7115599761, 1, 0)
2025-03-21 14:53:10,165 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:10,165 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:10,166 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:10,167 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] (7115599761, 1, 0)
2025-03-21 14:53:10,167 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:16,908 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:16,909 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:16,910 - sqlalchemy.engine.Engine - INFO - [cached since 12.57s ago] (7139312538, 1, 0)
2025-03-21 14:53:16,911 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:16,913 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:16,913 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:16,913 - sqlalchemy.engine.Engine - INFO - [cached since 12.58s ago] (7139312538, 1, 0)
2025-03-21 14:53:16,916 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:16,917 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:16,917 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:16,917 - sqlalchemy.engine.Engine - INFO - [cached since 12.57s ago] (7139312538, 1, 0)
2025-03-21 14:53:16,918 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:16,918 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:16,919 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:16,919 - sqlalchemy.engine.Engine - INFO - [cached since 12.58s ago] (7139312538, 1, 0)
2025-03-21 14:53:16,920 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:19,302 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:19,303 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:19,305 - sqlalchemy.engine.Engine - INFO - [cached since 14.97s ago] (7139312538, 1, 0)
2025-03-21 14:53:19,306 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:19,307 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:19,309 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:19,310 - sqlalchemy.engine.Engine - INFO - [cached since 14.97s ago] (7139312538, 1, 0)
2025-03-21 14:53:19,311 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:19,312 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:19,313 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:19,313 - sqlalchemy.engine.Engine - INFO - [cached since 14.97s ago] (7139312538, 1, 0)
2025-03-21 14:53:19,314 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:19,467 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:19,468 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:19,468 - sqlalchemy.engine.Engine - INFO - [cached since 15.12s ago] (7139312538, 1, 0)
2025-03-21 14:53:19,471 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:19,584 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:19,585 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes
2025-03-21 14:53:19,585 - sqlalchemy.engine.Engine - INFO - [generated in 0.00109s] ()
2025-03-21 14:53:19,588 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:25,975 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:25,975 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:25,975 - sqlalchemy.engine.Engine - INFO - [cached since 21.64s ago] (7115599761, 1, 0)
2025-03-21 14:53:25,977 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:25,978 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:25,979 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:25,979 - sqlalchemy.engine.Engine - INFO - [cached since 21.64s ago] (7115599761, 1, 0)
2025-03-21 14:53:25,980 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:25,981 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:25,981 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:25,982 - sqlalchemy.engine.Engine - INFO - [cached since 21.64s ago] (7115599761, 1, 0)
2025-03-21 14:53:25,983 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:25,983 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:25,983 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:25,983 - sqlalchemy.engine.Engine - INFO - [cached since 21.64s ago] (7115599761, 1, 0)
2025-03-21 14:53:25,984 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:25,985 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:25,985 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:25,985 - sqlalchemy.engine.Engine - INFO - [cached since 21.64s ago] (7115599761, 1, 0)
2025-03-21 14:53:25,985 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:25,986 - sqlalchemy.engine.Engine - INFO - [cached since 17.86s ago] (3, 'premium', 1, 0)
2025-03-21 14:53:25,986 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:26,874 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:26,875 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:26,875 - sqlalchemy.engine.Engine - INFO - [cached since 22.54s ago] (7115599761, 1, 0)
2025-03-21 14:53:26,876 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:26,877 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:26,878 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:26,879 - sqlalchemy.engine.Engine - INFO - [cached since 22.54s ago] (7115599761, 1, 0)
2025-03-21 14:53:26,879 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:26,880 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:26,880 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:26,881 - sqlalchemy.engine.Engine - INFO - [cached since 22.54s ago] (7115599761, 1, 0)
2025-03-21 14:53:26,882 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:32,362 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:32,363 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:32,363 - sqlalchemy.engine.Engine - INFO - [cached since 28.03s ago] (7115599761, 1, 0)
2025-03-21 14:53:32,365 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:32,366 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:32,367 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:32,368 - sqlalchemy.engine.Engine - INFO - [cached since 28.03s ago] (7115599761, 1, 0)
2025-03-21 14:53:32,369 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:32,369 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:32,370 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:32,370 - sqlalchemy.engine.Engine - INFO - [cached since 28.03s ago] (7115599761, 1, 0)
2025-03-21 14:53:32,371 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:32,371 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:32,371 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:32,372 - sqlalchemy.engine.Engine - INFO - [cached since 28.03s ago] (7115599761, 1, 0)
2025-03-21 14:53:32,372 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:32,373 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:32,373 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:32,373 - sqlalchemy.engine.Engine - INFO - [cached since 22.21s ago] (7115599761, 1, 0)
2025-03-21 14:53:32,373 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:33,640 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:33,642 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:33,642 - sqlalchemy.engine.Engine - INFO - [cached since 29.31s ago] (7115599761, 1, 0)
2025-03-21 14:53:33,643 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:33,643 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:33,645 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:33,645 - sqlalchemy.engine.Engine - INFO - [cached since 29.31s ago] (7115599761, 1, 0)
2025-03-21 14:53:33,646 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:33,647 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:33,649 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:33,649 - sqlalchemy.engine.Engine - INFO - [cached since 29.31s ago] (7115599761, 1, 0)
2025-03-21 14:53:33,650 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:33,650 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:33,650 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:33,651 - sqlalchemy.engine.Engine - INFO - [cached since 29.31s ago] (7115599761, 1, 0)
2025-03-21 14:53:33,651 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:33,652 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:33,652 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:33,652 - sqlalchemy.engine.Engine - INFO - [cached since 29.31s ago] (7115599761, 1, 0)
2025-03-21 14:53:33,652 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:33,653 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:33,653 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:33,653 - sqlalchemy.engine.Engine - INFO - [cached since 29.31s ago] (7115599761, 1, 0)
2025-03-21 14:53:33,653 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:34,558 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:34,558 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:34,559 - sqlalchemy.engine.Engine - INFO - [cached since 30.22s ago] (7115599761, 1, 0)
2025-03-21 14:53:34,560 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:34,561 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:34,562 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:34,562 - sqlalchemy.engine.Engine - INFO - [cached since 30.23s ago] (7115599761, 1, 0)
2025-03-21 14:53:34,564 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:34,565 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:34,566 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:34,566 - sqlalchemy.engine.Engine - INFO - [cached since 30.22s ago] (7115599761, 1, 0)
2025-03-21 14:53:34,567 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:35,365 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:35,366 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:35,366 - sqlalchemy.engine.Engine - INFO - [cached since 31.03s ago] (7115599761, 1, 0)
2025-03-21 14:53:35,367 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:35,369 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:35,370 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:35,370 - sqlalchemy.engine.Engine - INFO - [cached since 31.03s ago] (7115599761, 1, 0)
2025-03-21 14:53:35,372 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:35,373 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:35,373 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:35,375 - sqlalchemy.engine.Engine - INFO - [cached since 31.03s ago] (7115599761, 1, 0)
2025-03-21 14:53:35,376 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:35,431 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:35,432 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:35,432 - sqlalchemy.engine.Engine - INFO - [cached since 31.09s ago] (7115599761, 1, 0)
2025-03-21 14:53:35,434 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:35,434 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:35,435 - sqlalchemy.engine.Engine - INFO - [cached since 31.09s ago] (7115599761, 1, 0)
2025-03-21 14:53:35,436 - sqlalchemy.engine.Engine - INFO - SELECT user_achievements.id AS user_achievements_id, user_achievements.user_id AS user_achievements_user_id, user_achievements.achievement_id AS user_achievements_achievement_id, user_achievements.achieved_at AS user_achievements_achieved_at, achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM user_achievements JOIN achievements ON user_achievements.achievement_id = achievements.id 
WHERE user_achievements.user_id = ?
2025-03-21 14:53:35,437 - sqlalchemy.engine.Engine - INFO - [cached since 28.62s ago] (3,)
2025-03-21 14:53:35,437 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:35,437 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:35,438 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:35,438 - sqlalchemy.engine.Engine - INFO - [cached since 31.09s ago] (7115599761, 1, 0)
2025-03-21 14:53:35,440 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:35,441 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:36,329 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:36,330 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:36,330 - sqlalchemy.engine.Engine - INFO - [cached since 31.99s ago] (7115599761, 1, 0)
2025-03-21 14:53:36,331 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:36,332 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:36,332 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:36,333 - sqlalchemy.engine.Engine - INFO - [cached since 32s ago] (7115599761, 1, 0)
2025-03-21 14:53:36,333 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:36,333 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:36,334 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:36,334 - sqlalchemy.engine.Engine - INFO - [cached since 31.99s ago] (7115599761, 1, 0)
2025-03-21 14:53:36,337 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:36,337 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:36,338 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:36,338 - sqlalchemy.engine.Engine - INFO - [cached since 31.99s ago] (7115599761, 1, 0)
2025-03-21 14:53:36,338 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:36,339 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:36,339 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:36,339 - sqlalchemy.engine.Engine - INFO - [cached since 32s ago] (7115599761, 1, 0)
2025-03-21 14:53:36,340 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:36,340 - sqlalchemy.engine.Engine - INFO - [cached since 28.21s ago] (3, 'premium', 1, 0)
2025-03-21 14:53:36,340 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:37,311 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:37,312 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:37,312 - sqlalchemy.engine.Engine - INFO - [cached since 32.98s ago] (7115599761, 1, 0)
2025-03-21 14:53:37,314 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:37,316 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:37,317 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:37,317 - sqlalchemy.engine.Engine - INFO - [cached since 32.98s ago] (7115599761, 1, 0)
2025-03-21 14:53:37,318 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:37,318 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:37,318 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:37,319 - sqlalchemy.engine.Engine - INFO - [cached since 32.98s ago] (7115599761, 1, 0)
2025-03-21 14:53:37,320 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:38,978 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:38,978 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:38,979 - sqlalchemy.engine.Engine - INFO - [cached since 34.64s ago] (7115599761, 1, 0)
2025-03-21 14:53:38,980 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:38,981 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:38,982 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:38,982 - sqlalchemy.engine.Engine - INFO - [cached since 34.65s ago] (7115599761, 1, 0)
2025-03-21 14:53:38,983 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:38,985 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:38,985 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:38,985 - sqlalchemy.engine.Engine - INFO - [cached since 34.64s ago] (7115599761, 1, 0)
2025-03-21 14:53:38,986 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:38,986 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:38,986 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:38,987 - sqlalchemy.engine.Engine - INFO - [cached since 34.64s ago] (7115599761, 1, 0)
2025-03-21 14:53:38,989 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:38,990 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:38,990 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:38,990 - sqlalchemy.engine.Engine - INFO - [cached since 28.82s ago] (7115599761, 1, 0)
2025-03-21 14:53:38,990 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:53:43,243 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:53:43,245 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:53:43,245 - sqlalchemy.engine.Engine - INFO - [cached since 38.91s ago] (7115599761, 1, 0)
2025-03-21 14:53:43,246 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:00,248 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:00,249 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:00,249 - sqlalchemy.engine.Engine - INFO - [cached since 55.91s ago] (7139312538, 1, 0)
2025-03-21 14:54:00,250 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:00,251 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:00,252 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:00,252 - sqlalchemy.engine.Engine - INFO - [cached since 55.92s ago] (7139312538, 1, 0)
2025-03-21 14:54:00,252 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:00,253 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:00,253 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:00,253 - sqlalchemy.engine.Engine - INFO - [cached since 55.91s ago] (7139312538, 1, 0)
2025-03-21 14:54:00,253 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:00,253 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:00,253 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:00,255 - sqlalchemy.engine.Engine - INFO - [cached since 55.91s ago] (7139312538, 1, 0)
2025-03-21 14:54:00,256 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:01,639 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:01,640 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:01,641 - sqlalchemy.engine.Engine - INFO - [cached since 57.31s ago] (7139312538, 1, 0)
2025-03-21 14:54:01,642 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:01,643 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:01,643 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:01,643 - sqlalchemy.engine.Engine - INFO - [cached since 57.31s ago] (7139312538, 1, 0)
2025-03-21 14:54:01,645 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:01,645 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:01,646 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:01,647 - sqlalchemy.engine.Engine - INFO - [cached since 57.3s ago] (7139312538, 1, 0)
2025-03-21 14:54:01,648 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:01,821 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:01,822 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:01,822 - sqlalchemy.engine.Engine - INFO - [cached since 57.48s ago] (7139312538, 1, 0)
2025-03-21 14:54:01,824 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:01,961 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:01,961 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes
2025-03-21 14:54:01,962 - sqlalchemy.engine.Engine - INFO - [cached since 42.38s ago] ()
2025-03-21 14:54:01,963 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:04,599 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:04,600 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:04,601 - sqlalchemy.engine.Engine - INFO - [cached since 60.26s ago] (7139312538, 1, 0)
2025-03-21 14:54:04,602 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:04,603 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:04,604 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:04,605 - sqlalchemy.engine.Engine - INFO - [cached since 60.27s ago] (7139312538, 1, 0)
2025-03-21 14:54:04,605 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:04,606 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:04,606 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:04,606 - sqlalchemy.engine.Engine - INFO - [cached since 60.26s ago] (7139312538, 1, 0)
2025-03-21 14:54:04,607 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:07,696 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:07,696 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:07,696 - sqlalchemy.engine.Engine - INFO - [cached since 63.36s ago] (7139312538, 1, 0)
2025-03-21 14:54:07,698 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:07,699 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:07,700 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:07,700 - sqlalchemy.engine.Engine - INFO - [cached since 63.36s ago] (7139312538, 1, 0)
2025-03-21 14:54:07,701 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:07,701 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:07,702 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:07,702 - sqlalchemy.engine.Engine - INFO - [cached since 63.36s ago] (7139312538, 1, 0)
2025-03-21 14:54:07,703 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:07,704 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:07,704 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:07,704 - sqlalchemy.engine.Engine - INFO - [cached since 63.36s ago] (7139312538, 1, 0)
2025-03-21 14:54:07,704 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:08,521 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:08,521 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:08,522 - sqlalchemy.engine.Engine - INFO - [cached since 64.19s ago] (7139312538, 1, 0)
2025-03-21 14:54:08,523 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:08,524 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:08,524 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:08,525 - sqlalchemy.engine.Engine - INFO - [cached since 64.19s ago] (7139312538, 1, 0)
2025-03-21 14:54:08,526 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:08,526 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:08,527 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:08,527 - sqlalchemy.engine.Engine - INFO - [cached since 64.18s ago] (7139312538, 1, 0)
2025-03-21 14:54:08,529 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:09,206 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:09,206 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:09,206 - sqlalchemy.engine.Engine - INFO - [cached since 64.87s ago] (7139312538, 1, 0)
2025-03-21 14:54:09,209 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:09,211 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:09,212 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:09,212 - sqlalchemy.engine.Engine - INFO - [cached since 64.88s ago] (7139312538, 1, 0)
2025-03-21 14:54:09,213 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:09,213 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:09,214 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:09,214 - sqlalchemy.engine.Engine - INFO - [cached since 64.87s ago] (7139312538, 1, 0)
2025-03-21 14:54:09,215 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:10,088 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:10,089 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:10,089 - sqlalchemy.engine.Engine - INFO - [cached since 65.75s ago] (7139312538, 1, 0)
2025-03-21 14:54:10,090 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:10,092 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:10,093 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:10,093 - sqlalchemy.engine.Engine - INFO - [cached since 65.76s ago] (7139312538, 1, 0)
2025-03-21 14:54:10,093 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:10,093 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:10,095 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:10,095 - sqlalchemy.engine.Engine - INFO - [cached since 65.75s ago] (7139312538, 1, 0)
2025-03-21 14:54:10,096 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:10,207 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:10,211 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:10,211 - sqlalchemy.engine.Engine - INFO - [generated in 0.00066s] ('TEST3', 1, 0)
2025-03-21 14:54:10,215 - sqlalchemy.engine.Engine - INFO - INSERT INTO promo_codes (code, duration_days, max_uses, uses_count, is_active, created_at, expires_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-03-21 14:54:10,215 - sqlalchemy.engine.Engine - INFO - [generated in 0.00071s] ('TEST3', 7, 5, 0, 1, '2025-03-21 12:54:10.215599', '2025-03-28 12:54:10.207615')
2025-03-21 14:54:10,218 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:54:10,224 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:10,225 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id, promo_codes.code, promo_codes.duration_days, promo_codes.max_uses, promo_codes.uses_count, promo_codes.is_active, promo_codes.created_at, promo_codes.expires_at 
FROM promo_codes 
WHERE promo_codes.id = ?
2025-03-21 14:54:10,226 - sqlalchemy.engine.Engine - INFO - [generated in 0.00062s] (3,)
2025-03-21 14:54:10,226 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:19,473 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:19,474 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:19,475 - sqlalchemy.engine.Engine - INFO - [cached since 75.14s ago] (7139312538, 1, 0)
2025-03-21 14:54:19,476 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:19,476 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:19,478 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:19,478 - sqlalchemy.engine.Engine - INFO - [cached since 75.14s ago] (7139312538, 1, 0)
2025-03-21 14:54:19,478 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:19,479 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:19,479 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:19,479 - sqlalchemy.engine.Engine - INFO - [cached since 75.14s ago] (7139312538, 1, 0)
2025-03-21 14:54:19,479 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:19,480 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:19,480 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:19,480 - sqlalchemy.engine.Engine - INFO - [cached since 75.14s ago] (7139312538, 1, 0)
2025-03-21 14:54:19,481 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:19,482 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:19,482 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:19,482 - sqlalchemy.engine.Engine - INFO - [cached since 75.14s ago] (7139312538, 1, 0)
2025-03-21 14:54:19,482 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:19,483 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:19,483 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:19,483 - sqlalchemy.engine.Engine - INFO - [cached since 75.14s ago] (7139312538, 1, 0)
2025-03-21 14:54:19,484 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:20,477 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:20,478 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:20,479 - sqlalchemy.engine.Engine - INFO - [cached since 76.14s ago] (7139312538, 1, 0)
2025-03-21 14:54:20,480 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:20,482 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:20,483 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:20,483 - sqlalchemy.engine.Engine - INFO - [cached since 76.15s ago] (7139312538, 1, 0)
2025-03-21 14:54:20,484 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:20,485 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:20,485 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:20,485 - sqlalchemy.engine.Engine - INFO - [cached since 76.14s ago] (7139312538, 1, 0)
2025-03-21 14:54:20,487 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:21,269 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:21,270 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:21,270 - sqlalchemy.engine.Engine - INFO - [cached since 76.93s ago] (7139312538, 1, 0)
2025-03-21 14:54:21,272 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:21,275 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:21,275 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:21,276 - sqlalchemy.engine.Engine - INFO - [cached since 76.94s ago] (7139312538, 1, 0)
2025-03-21 14:54:21,276 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:21,277 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:21,278 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:21,278 - sqlalchemy.engine.Engine - INFO - [cached since 76.93s ago] (7139312538, 1, 0)
2025-03-21 14:54:21,280 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:21,281 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:21,281 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:21,282 - sqlalchemy.engine.Engine - INFO - [cached since 76.94s ago] (7139312538, 1, 0)
2025-03-21 14:54:21,282 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:21,282 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:21,283 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:21,283 - sqlalchemy.engine.Engine - INFO - [cached since 76.94s ago] (7139312538, 1, 0)
2025-03-21 14:54:21,283 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:21,284 - sqlalchemy.engine.Engine - INFO - [cached since 73.16s ago] (1, 'premium', 1, 0)
2025-03-21 14:54:21,284 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:22,552 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:22,552 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:22,553 - sqlalchemy.engine.Engine - INFO - [cached since 78.22s ago] (7139312538, 1, 0)
2025-03-21 14:54:22,555 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:22,556 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:22,556 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:22,557 - sqlalchemy.engine.Engine - INFO - [cached since 78.22s ago] (7139312538, 1, 0)
2025-03-21 14:54:22,557 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:22,557 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:22,558 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:22,558 - sqlalchemy.engine.Engine - INFO - [cached since 78.21s ago] (7139312538, 1, 0)
2025-03-21 14:54:22,559 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:23,797 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:23,798 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:23,799 - sqlalchemy.engine.Engine - INFO - [cached since 79.46s ago] (7139312538, 1, 0)
2025-03-21 14:54:23,801 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:23,802 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:23,802 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:23,802 - sqlalchemy.engine.Engine - INFO - [cached since 79.47s ago] (7139312538, 1, 0)
2025-03-21 14:54:23,803 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:23,805 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:23,806 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:23,806 - sqlalchemy.engine.Engine - INFO - [cached since 79.46s ago] (7139312538, 1, 0)
2025-03-21 14:54:23,807 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:23,808 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:23,808 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:23,808 - sqlalchemy.engine.Engine - INFO - [cached since 79.47s ago] (7139312538, 1, 0)
2025-03-21 14:54:23,809 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:54:23,810 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:54:23,810 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:54:23,810 - sqlalchemy.engine.Engine - INFO - [cached since 73.64s ago] (7139312538, 1, 0)
2025-03-21 14:54:23,810 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:15,745 - aiogram.dispatcher.dispatcher - INFO - Stop polling...
2025-03-21 14:56:15,746 - aiogram - WARNING - Goodbye!
2025-03-21 14:56:16,891 - __main__ - INFO - Запуск бота...
2025-03-21 14:56:17,155 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:17,155 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-03-21 14:56:17,155 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:56:17,157 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referrals")
2025-03-21 14:56:17,157 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:56:17,158 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("announcements")
2025-03-21 14:56:17,158 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:56:17,159 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("reports")
2025-03-21 14:56:17,159 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:56:17,159 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("favorites")
2025-03-21 14:56:17,160 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:56:17,161 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("crystal_transactions")
2025-03-21 14:56:17,161 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:56:17,161 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("premium_prices")
2025-03-21 14:56:17,161 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:56:17,162 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sponsors")
2025-03-21 14:56:17,162 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:56:17,162 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_sponsor_subscriptions")
2025-03-21 14:56:17,162 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:56:17,163 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_codes")
2025-03-21 14:56:17,163 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:56:17,163 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_uses")
2025-03-21 14:56:17,163 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:56:17,164 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-03-21 14:56:17,165 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:56:17,165 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_achievements")
2025-03-21 14:56:17,165 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:56:17,165 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_visited_sections")
2025-03-21 14:56:17,165 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:56:17,166 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_secret_purchases")
2025-03-21 14:56:17,166 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:56:17,166 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("bot_settings")
2025-03-21 14:56:17,166 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:56:17,167 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:56:17,184 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:17,186 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:17,187 - sqlalchemy.engine.Engine - INFO - [generated in 0.00086s] (30, 1, 0)
2025-03-21 14:56:17,188 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:17,188 - sqlalchemy.engine.Engine - INFO - [cached since 0.002743s ago] (180, 1, 0)
2025-03-21 14:56:17,190 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:17,190 - sqlalchemy.engine.Engine - INFO - [cached since 0.003789s ago] (365, 1, 0)
2025-03-21 14:56:17,191 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:17,191 - sqlalchemy.engine.Engine - INFO - [cached since 0.004704s ago] (36500, 1, 0)
2025-03-21 14:56:17,192 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:56:17,203 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:17,208 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements) AS anon_1
2025-03-21 14:56:17,208 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] ()
2025-03-21 14:56:17,209 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:17,212 - root - INFO - Achievements handlers registered successfully
2025-03-21 14:56:17,348 - aiogram - INFO - Bot: Бубсер Поиск Бот [@Bubser_PoiskBot]
2025-03-21 14:56:17,432 - aiogram - WARNING - Updates were skipped successfully.
2025-03-21 14:56:17,432 - __main__ - INFO - Бот успешно запущен!
2025-03-21 14:56:17,433 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:17,435 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.tg_id, users.username, users.first_name, users.is_premium, users.premium_end_date, users.crystals, users.language, users.blocked, users.last_gift, users.created_at, users.updated_at, users.coins, users.premium_until 
FROM users 
WHERE users.is_premium = 1 AND users.premium_end_date <= ?
2025-03-21 14:56:17,436 - sqlalchemy.engine.Engine - INFO - [generated in 0.00114s] ('2025-03-21 14:56:17.432895',)
2025-03-21 14:56:17,438 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:56:17,439 - aiogram.dispatcher.dispatcher - INFO - Start polling.
2025-03-21 14:56:18,500 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:18,501 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:18,502 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] (7139312538, 1, 0)
2025-03-21 14:56:18,502 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:18,503 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:18,503 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:18,504 - sqlalchemy.engine.Engine - INFO - [cached since 0.002378s ago] (7139312538, 1, 0)
2025-03-21 14:56:18,504 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:18,505 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:18,506 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:18,507 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] (7139312538, 1, 0)
2025-03-21 14:56:18,507 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:18,508 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:18,508 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:18,509 - sqlalchemy.engine.Engine - INFO - [cached since 0.002378s ago] (7139312538, 1, 0)
2025-03-21 14:56:18,510 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:18,511 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:18,512 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:18,513 - sqlalchemy.engine.Engine - INFO - [cached since 0.006435s ago] (7139312538, 1, 0)
2025-03-21 14:56:18,513 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:18,515 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:18,515 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:18,516 - sqlalchemy.engine.Engine - INFO - [cached since 0.009006s ago] (7139312538, 1, 0)
2025-03-21 14:56:18,516 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:19,801 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:19,801 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:19,802 - sqlalchemy.engine.Engine - INFO - [cached since 1.3s ago] (7139312538, 1, 0)
2025-03-21 14:56:19,802 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:19,803 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:19,804 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:19,804 - sqlalchemy.engine.Engine - INFO - [cached since 1.303s ago] (7139312538, 1, 0)
2025-03-21 14:56:19,805 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:19,805 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:19,805 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:19,806 - sqlalchemy.engine.Engine - INFO - [cached since 1.3s ago] (7139312538, 1, 0)
2025-03-21 14:56:19,809 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:20,863 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:20,864 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:20,864 - sqlalchemy.engine.Engine - INFO - [cached since 2.363s ago] (7139312538, 1, 0)
2025-03-21 14:56:20,865 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:20,866 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:20,867 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:20,867 - sqlalchemy.engine.Engine - INFO - [cached since 2.367s ago] (7139312538, 1, 0)
2025-03-21 14:56:20,869 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:20,870 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:20,870 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:20,871 - sqlalchemy.engine.Engine - INFO - [cached since 2.365s ago] (7139312538, 1, 0)
2025-03-21 14:56:20,873 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:20,873 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:20,875 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:20,876 - sqlalchemy.engine.Engine - INFO - [cached since 2.37s ago] (7139312538, 1, 0)
2025-03-21 14:56:20,877 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:20,877 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:20,878 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:20,878 - sqlalchemy.engine.Engine - INFO - [cached since 2.372s ago] (7139312538, 1, 0)
2025-03-21 14:56:20,881 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:20,881 - sqlalchemy.engine.Engine - INFO - [generated in 0.00086s] (1, 'premium', 1, 0)
2025-03-21 14:56:20,883 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:21,620 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:21,621 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:21,621 - sqlalchemy.engine.Engine - INFO - [cached since 3.12s ago] (7139312538, 1, 0)
2025-03-21 14:56:21,623 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:21,624 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:21,624 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:21,625 - sqlalchemy.engine.Engine - INFO - [cached since 3.124s ago] (7139312538, 1, 0)
2025-03-21 14:56:21,626 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:21,627 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:21,627 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:21,627 - sqlalchemy.engine.Engine - INFO - [cached since 3.121s ago] (7139312538, 1, 0)
2025-03-21 14:56:21,629 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:22,699 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:22,699 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:22,700 - sqlalchemy.engine.Engine - INFO - [cached since 4.199s ago] (7139312538, 1, 0)
2025-03-21 14:56:22,701 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:22,702 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:22,703 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:22,703 - sqlalchemy.engine.Engine - INFO - [cached since 4.203s ago] (7139312538, 1, 0)
2025-03-21 14:56:22,705 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:22,705 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:22,705 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:22,706 - sqlalchemy.engine.Engine - INFO - [cached since 4.199s ago] (7139312538, 1, 0)
2025-03-21 14:56:22,706 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:22,706 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:22,707 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:22,707 - sqlalchemy.engine.Engine - INFO - [cached since 4.201s ago] (7139312538, 1, 0)
2025-03-21 14:56:22,708 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:22,708 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:56:22,709 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:56:22,709 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] (7139312538, 1, 0)
2025-03-21 14:56:22,710 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:56:22,710 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-31' coro=<Dispatcher._process_polling_updates() done, defined at C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py:407> exception=ValueError('not enough values to unpack (expected 3, got 2)')>
Traceback (most recent call last):
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 415, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 235, in process_updates
    return await asyncio.gather(*tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 256, in process_update
    return await self.message_handlers.notify(update.message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\handlers\premium.py", line 127, in process_promo_code
    success, msg, duration_days = use_promo_code(message.from_user.id, promo_code)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 3, got 2)
2025-03-21 14:57:37,834 - aiogram.dispatcher.dispatcher - INFO - Stop polling...
2025-03-21 14:57:37,834 - aiogram - WARNING - Goodbye!
2025-03-21 14:57:39,020 - __main__ - INFO - Запуск бота...
2025-03-21 14:57:39,267 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:39,267 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-03-21 14:57:39,268 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:57:39,269 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referrals")
2025-03-21 14:57:39,269 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:57:39,270 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("announcements")
2025-03-21 14:57:39,270 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:57:39,270 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("reports")
2025-03-21 14:57:39,271 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:57:39,271 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("favorites")
2025-03-21 14:57:39,271 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:57:39,272 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("crystal_transactions")
2025-03-21 14:57:39,272 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:57:39,272 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("premium_prices")
2025-03-21 14:57:39,272 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:57:39,272 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sponsors")
2025-03-21 14:57:39,273 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:57:39,273 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_sponsor_subscriptions")
2025-03-21 14:57:39,273 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:57:39,274 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_codes")
2025-03-21 14:57:39,274 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:57:39,274 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_uses")
2025-03-21 14:57:39,274 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:57:39,274 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-03-21 14:57:39,275 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:57:39,275 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_achievements")
2025-03-21 14:57:39,276 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:57:39,277 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_visited_sections")
2025-03-21 14:57:39,277 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:57:39,277 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_secret_purchases")
2025-03-21 14:57:39,277 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:57:39,277 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("bot_settings")
2025-03-21 14:57:39,278 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:57:39,278 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:57:39,297 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:39,301 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:39,301 - sqlalchemy.engine.Engine - INFO - [generated in 0.00082s] (30, 1, 0)
2025-03-21 14:57:39,305 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:39,306 - sqlalchemy.engine.Engine - INFO - [cached since 0.004948s ago] (180, 1, 0)
2025-03-21 14:57:39,307 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:39,307 - sqlalchemy.engine.Engine - INFO - [cached since 0.006464s ago] (365, 1, 0)
2025-03-21 14:57:39,308 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:39,308 - sqlalchemy.engine.Engine - INFO - [cached since 0.007818s ago] (36500, 1, 0)
2025-03-21 14:57:39,309 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:57:39,323 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:39,326 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements) AS anon_1
2025-03-21 14:57:39,327 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] ()
2025-03-21 14:57:39,327 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:39,329 - root - INFO - Achievements handlers registered successfully
2025-03-21 14:57:39,461 - aiogram - INFO - Bot: Бубсер Поиск Бот [@Bubser_PoiskBot]
2025-03-21 14:57:39,538 - aiogram - WARNING - Updates were skipped successfully.
2025-03-21 14:57:39,538 - __main__ - INFO - Бот успешно запущен!
2025-03-21 14:57:39,538 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:39,541 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.tg_id, users.username, users.first_name, users.is_premium, users.premium_end_date, users.crystals, users.language, users.blocked, users.last_gift, users.created_at, users.updated_at, users.coins, users.premium_until 
FROM users 
WHERE users.is_premium = 1 AND users.premium_end_date <= ?
2025-03-21 14:57:39,541 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] ('2025-03-21 14:57:39.538762',)
2025-03-21 14:57:39,543 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:57:39,543 - aiogram.dispatcher.dispatcher - INFO - Start polling.
2025-03-21 14:57:41,411 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:41,412 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:41,413 - sqlalchemy.engine.Engine - INFO - [generated in 0.00062s] (7139312538, 1, 0)
2025-03-21 14:57:41,414 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:41,416 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:41,416 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:41,416 - sqlalchemy.engine.Engine - INFO - [cached since 0.00405s ago] (7139312538, 1, 0)
2025-03-21 14:57:41,417 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:41,417 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:41,418 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:41,418 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] (7139312538, 1, 0)
2025-03-21 14:57:41,419 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:41,419 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:41,419 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:41,419 - sqlalchemy.engine.Engine - INFO - [cached since 0.001632s ago] (7139312538, 1, 0)
2025-03-21 14:57:41,420 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:41,421 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:41,421 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:41,421 - sqlalchemy.engine.Engine - INFO - [cached since 0.003388s ago] (7139312538, 1, 0)
2025-03-21 14:57:41,422 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:41,422 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:41,423 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:41,423 - sqlalchemy.engine.Engine - INFO - [cached since 0.00534s ago] (7139312538, 1, 0)
2025-03-21 14:57:41,424 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:42,147 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:42,147 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:42,148 - sqlalchemy.engine.Engine - INFO - [cached since 0.7355s ago] (7139312538, 1, 0)
2025-03-21 14:57:42,149 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:42,149 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:42,150 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:42,151 - sqlalchemy.engine.Engine - INFO - [cached since 0.7382s ago] (7139312538, 1, 0)
2025-03-21 14:57:42,151 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:42,152 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:42,152 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:42,152 - sqlalchemy.engine.Engine - INFO - [cached since 0.7345s ago] (7139312538, 1, 0)
2025-03-21 14:57:42,153 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:43,241 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:43,241 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:43,242 - sqlalchemy.engine.Engine - INFO - [cached since 1.829s ago] (7139312538, 1, 0)
2025-03-21 14:57:43,242 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:43,244 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:43,244 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:43,246 - sqlalchemy.engine.Engine - INFO - [cached since 1.833s ago] (7139312538, 1, 0)
2025-03-21 14:57:43,246 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:43,247 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:43,247 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:43,248 - sqlalchemy.engine.Engine - INFO - [cached since 1.829s ago] (7139312538, 1, 0)
2025-03-21 14:57:43,250 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:43,250 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:43,251 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:43,251 - sqlalchemy.engine.Engine - INFO - [cached since 1.833s ago] (7139312538, 1, 0)
2025-03-21 14:57:43,251 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:43,252 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:43,252 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:43,252 - sqlalchemy.engine.Engine - INFO - [cached since 1.834s ago] (7139312538, 1, 0)
2025-03-21 14:57:43,253 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:43,253 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] (1, 'premium', 1, 0)
2025-03-21 14:57:43,253 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:44,446 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:44,446 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:44,446 - sqlalchemy.engine.Engine - INFO - [cached since 3.034s ago] (7139312538, 1, 0)
2025-03-21 14:57:44,448 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:44,450 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:44,451 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:44,451 - sqlalchemy.engine.Engine - INFO - [cached since 3.039s ago] (7139312538, 1, 0)
2025-03-21 14:57:44,451 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:44,452 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:44,452 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:44,452 - sqlalchemy.engine.Engine - INFO - [cached since 3.035s ago] (7139312538, 1, 0)
2025-03-21 14:57:44,455 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:47,350 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:47,351 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:47,351 - sqlalchemy.engine.Engine - INFO - [cached since 5.939s ago] (7139312538, 1, 0)
2025-03-21 14:57:47,353 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:47,355 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:47,356 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:47,356 - sqlalchemy.engine.Engine - INFO - [cached since 5.944s ago] (7139312538, 1, 0)
2025-03-21 14:57:47,357 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:47,357 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:47,358 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:47,358 - sqlalchemy.engine.Engine - INFO - [cached since 5.941s ago] (7139312538, 1, 0)
2025-03-21 14:57:47,359 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:47,360 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:47,361 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:47,363 - sqlalchemy.engine.Engine - INFO - [cached since 5.945s ago] (7139312538, 1, 0)
2025-03-21 14:57:47,365 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:47,367 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:47,370 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:47,371 - sqlalchemy.engine.Engine - INFO - [generated in 0.00158s] ('TEST3', 1, 0)
2025-03-21 14:57:47,374 - sqlalchemy.engine.Engine - INFO - SELECT promo_uses.id AS promo_uses_id, promo_uses.promo_id AS promo_uses_promo_id, promo_uses.user_tg_id AS promo_uses_user_tg_id, promo_uses.used_at AS promo_uses_used_at 
FROM promo_uses 
WHERE promo_uses.promo_id = ? AND promo_uses.user_tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:47,374 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] (3, 7139312538, 1, 0)
2025-03-21 14:57:47,377 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:47,377 - sqlalchemy.engine.Engine - INFO - [cached since 5.96s ago] (7139312538, 1, 0)
2025-03-21 14:57:47,381 - sqlalchemy.engine.Engine - INFO - UPDATE promo_codes SET uses_count=? WHERE promo_codes.id = ?
2025-03-21 14:57:47,383 - sqlalchemy.engine.Engine - INFO - [generated in 0.00167s] (1, 3)
2025-03-21 14:57:47,386 - sqlalchemy.engine.Engine - INFO - INSERT INTO promo_uses (promo_id, user_tg_id, used_at) VALUES (?, ?, ?)
2025-03-21 14:57:47,386 - sqlalchemy.engine.Engine - INFO - [generated in 0.00067s] (3, 7139312538, '2025-03-21 12:57:47.386559')
2025-03-21 14:57:47,389 - sqlalchemy.engine.Engine - INFO - UPDATE users SET premium_end_date=?, updated_at=?, premium_until=? WHERE users.id = ?
2025-03-21 14:57:47,389 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] ('2025-04-11 14:48:00.865070', '2025-03-21 12:57:47.389550', '2025-04-11 14:48:00.865070', 1)
2025-03-21 14:57:47,390 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:57:47,392 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:47,393 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.id = ?
2025-03-21 14:57:47,393 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] (3,)
2025-03-21 14:57:47,394 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:47,396 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:57:47,397 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:57:47,397 - sqlalchemy.engine.Engine - INFO - [cached since 5.98s ago] (7139312538, 1, 0)
2025-03-21 14:57:47,398 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:57:47,399 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-31' coro=<Dispatcher._process_polling_updates() done, defined at C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py:407> exception=KeyError('code')>
Traceback (most recent call last):
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 415, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 235, in process_updates
    return await asyncio.gather(*tasks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 256, in process_update
    return await self.message_handlers.notify(update.message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\venv\Lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\misha\OneDrive\Рабочий стол\Brawlstars_bot\handlers\premium.py", line 141, in process_promo_code
    user_locale.get("promo_code_success", "✅ Промокод успешно активирован! Премиум статус активирован на {days} дней.\nДата окончания: {date}").format(
KeyError: 'code'
2025-03-21 14:59:10,953 - aiogram.dispatcher.dispatcher - INFO - Stop polling...
2025-03-21 14:59:10,954 - aiogram - WARNING - Goodbye!
2025-03-21 14:59:12,061 - __main__ - INFO - Запуск бота...
2025-03-21 14:59:12,307 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:12,308 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-03-21 14:59:12,309 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:59:12,309 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referrals")
2025-03-21 14:59:12,310 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:59:12,310 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("announcements")
2025-03-21 14:59:12,311 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:59:12,311 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("reports")
2025-03-21 14:59:12,312 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:59:12,312 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("favorites")
2025-03-21 14:59:12,312 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:59:12,313 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("crystal_transactions")
2025-03-21 14:59:12,313 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:59:12,314 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("premium_prices")
2025-03-21 14:59:12,314 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:59:12,314 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sponsors")
2025-03-21 14:59:12,315 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:59:12,315 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_sponsor_subscriptions")
2025-03-21 14:59:12,315 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:59:12,316 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_codes")
2025-03-21 14:59:12,316 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:59:12,317 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("promo_uses")
2025-03-21 14:59:12,317 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:59:12,317 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-03-21 14:59:12,317 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:59:12,318 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_achievements")
2025-03-21 14:59:12,318 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:59:12,318 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_visited_sections")
2025-03-21 14:59:12,318 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:59:12,318 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_secret_purchases")
2025-03-21 14:59:12,318 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:59:12,319 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("bot_settings")
2025-03-21 14:59:12,319 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-03-21 14:59:12,320 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:59:12,340 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:12,343 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:12,343 - sqlalchemy.engine.Engine - INFO - [generated in 0.00057s] (30, 1, 0)
2025-03-21 14:59:12,346 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:12,346 - sqlalchemy.engine.Engine - INFO - [cached since 0.003905s ago] (180, 1, 0)
2025-03-21 14:59:12,348 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:12,349 - sqlalchemy.engine.Engine - INFO - [cached since 0.005958s ago] (365, 1, 0)
2025-03-21 14:59:12,349 - sqlalchemy.engine.Engine - INFO - SELECT premium_prices.id AS premium_prices_id, premium_prices.duration_days AS premium_prices_duration_days, premium_prices.price AS premium_prices_price, premium_prices.created_at AS premium_prices_created_at, premium_prices.updated_at AS premium_prices_updated_at 
FROM premium_prices 
WHERE premium_prices.duration_days = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:12,350 - sqlalchemy.engine.Engine - INFO - [cached since 0.006992s ago] (36500, 1, 0)
2025-03-21 14:59:12,350 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:59:12,363 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:12,366 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM achievements) AS anon_1
2025-03-21 14:59:12,366 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] ()
2025-03-21 14:59:12,367 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:12,370 - root - INFO - Achievements handlers registered successfully
2025-03-21 14:59:12,505 - aiogram - INFO - Bot: Бубсер Поиск Бот [@Bubser_PoiskBot]
2025-03-21 14:59:12,584 - aiogram - WARNING - Updates were skipped successfully.
2025-03-21 14:59:12,584 - __main__ - INFO - Бот успешно запущен!
2025-03-21 14:59:12,585 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:12,586 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.tg_id, users.username, users.first_name, users.is_premium, users.premium_end_date, users.crystals, users.language, users.blocked, users.last_gift, users.created_at, users.updated_at, users.coins, users.premium_until 
FROM users 
WHERE users.is_premium = 1 AND users.premium_end_date <= ?
2025-03-21 14:59:12,587 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] ('2025-03-21 14:59:12.585024',)
2025-03-21 14:59:12,587 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:59:12,588 - aiogram.dispatcher.dispatcher - INFO - Start polling.
2025-03-21 14:59:17,755 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:17,757 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:17,758 - sqlalchemy.engine.Engine - INFO - [generated in 0.00119s] (7115599761, 1, 0)
2025-03-21 14:59:17,760 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:17,761 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:17,762 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:17,762 - sqlalchemy.engine.Engine - INFO - [cached since 0.005207s ago] (7115599761, 1, 0)
2025-03-21 14:59:17,763 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:17,764 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:17,765 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:17,767 - sqlalchemy.engine.Engine - INFO - [generated in 0.00139s] (7115599761, 1, 0)
2025-03-21 14:59:17,768 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:17,768 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:17,769 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:17,770 - sqlalchemy.engine.Engine - INFO - [cached since 0.004715s ago] (7115599761, 1, 0)
2025-03-21 14:59:17,771 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:17,772 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:17,772 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:17,773 - sqlalchemy.engine.Engine - INFO - [cached since 0.008001s ago] (7115599761, 1, 0)
2025-03-21 14:59:17,774 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:17,776 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:17,776 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:17,777 - sqlalchemy.engine.Engine - INFO - [cached since 0.01192s ago] (7115599761, 1, 0)
2025-03-21 14:59:17,777 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:18,673 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:18,673 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:18,674 - sqlalchemy.engine.Engine - INFO - [cached since 0.9163s ago] (7115599761, 1, 0)
2025-03-21 14:59:18,675 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:18,676 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:18,678 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:18,678 - sqlalchemy.engine.Engine - INFO - [cached since 0.9208s ago] (7115599761, 1, 0)
2025-03-21 14:59:18,679 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:18,679 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:18,679 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:18,680 - sqlalchemy.engine.Engine - INFO - [cached since 0.9148s ago] (7115599761, 1, 0)
2025-03-21 14:59:18,681 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:19,690 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:19,691 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:19,691 - sqlalchemy.engine.Engine - INFO - [cached since 1.933s ago] (7115599761, 1, 0)
2025-03-21 14:59:19,692 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:19,694 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:19,694 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:19,695 - sqlalchemy.engine.Engine - INFO - [cached since 1.938s ago] (7115599761, 1, 0)
2025-03-21 14:59:19,697 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:19,698 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:19,699 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:19,700 - sqlalchemy.engine.Engine - INFO - [cached since 1.935s ago] (7115599761, 1, 0)
2025-03-21 14:59:19,701 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:19,704 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:19,704 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:19,705 - sqlalchemy.engine.Engine - INFO - [cached since 1.94s ago] (7115599761, 1, 0)
2025-03-21 14:59:19,707 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:19,708 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:19,709 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:19,709 - sqlalchemy.engine.Engine - INFO - [cached since 1.944s ago] (7115599761, 1, 0)
2025-03-21 14:59:19,714 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:19,715 - sqlalchemy.engine.Engine - INFO - [generated in 0.00057s] (3, 'premium', 1, 0)
2025-03-21 14:59:19,715 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:20,661 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:20,661 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:20,662 - sqlalchemy.engine.Engine - INFO - [cached since 2.905s ago] (7115599761, 1, 0)
2025-03-21 14:59:20,663 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:20,665 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:20,666 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:20,667 - sqlalchemy.engine.Engine - INFO - [cached since 2.91s ago] (7115599761, 1, 0)
2025-03-21 14:59:20,669 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:20,670 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:20,670 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:20,670 - sqlalchemy.engine.Engine - INFO - [cached since 2.905s ago] (7115599761, 1, 0)
2025-03-21 14:59:20,671 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:22,001 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:22,002 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:22,003 - sqlalchemy.engine.Engine - INFO - [cached since 4.246s ago] (7115599761, 1, 0)
2025-03-21 14:59:22,003 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:22,006 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:22,006 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:22,006 - sqlalchemy.engine.Engine - INFO - [cached since 4.249s ago] (7115599761, 1, 0)
2025-03-21 14:59:22,007 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:22,007 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:22,008 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:22,008 - sqlalchemy.engine.Engine - INFO - [cached since 4.243s ago] (7115599761, 1, 0)
2025-03-21 14:59:22,010 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:22,011 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:22,011 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:22,012 - sqlalchemy.engine.Engine - INFO - [cached since 4.246s ago] (7115599761, 1, 0)
2025-03-21 14:59:22,012 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:22,013 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:22,016 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.code = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:22,016 - sqlalchemy.engine.Engine - INFO - [generated in 0.00079s] ('TEST3', 1, 0)
2025-03-21 14:59:22,018 - sqlalchemy.engine.Engine - INFO - SELECT promo_uses.id AS promo_uses_id, promo_uses.promo_id AS promo_uses_promo_id, promo_uses.user_tg_id AS promo_uses_user_tg_id, promo_uses.used_at AS promo_uses_used_at 
FROM promo_uses 
WHERE promo_uses.promo_id = ? AND promo_uses.user_tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:22,018 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] (3, 7115599761, 1, 0)
2025-03-21 14:59:22,019 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:22,019 - sqlalchemy.engine.Engine - INFO - [cached since 4.254s ago] (7115599761, 1, 0)
2025-03-21 14:59:22,021 - sqlalchemy.engine.Engine - INFO - UPDATE promo_codes SET uses_count=? WHERE promo_codes.id = ?
2025-03-21 14:59:22,022 - sqlalchemy.engine.Engine - INFO - [generated in 0.00086s] (2, 3)
2025-03-21 14:59:22,026 - sqlalchemy.engine.Engine - INFO - INSERT INTO promo_uses (promo_id, user_tg_id, used_at) VALUES (?, ?, ?)
2025-03-21 14:59:22,027 - sqlalchemy.engine.Engine - INFO - [generated in 0.00071s] (3, 7115599761, '2025-03-21 12:59:22.026269')
2025-03-21 14:59:22,028 - sqlalchemy.engine.Engine - INFO - UPDATE users SET is_premium=?, premium_end_date=?, updated_at=?, premium_until=? WHERE users.id = ?
2025-03-21 14:59:22,028 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] (1, '2025-03-28 14:59:22.020683', '2025-03-21 12:59:22.028261', '2025-03-28 14:59:22.020683', 3)
2025-03-21 14:59:22,029 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:59:22,033 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:22,036 - sqlalchemy.engine.Engine - INFO - SELECT promo_codes.id AS promo_codes_id, promo_codes.code AS promo_codes_code, promo_codes.duration_days AS promo_codes_duration_days, promo_codes.max_uses AS promo_codes_max_uses, promo_codes.uses_count AS promo_codes_uses_count, promo_codes.is_active AS promo_codes_is_active, promo_codes.created_at AS promo_codes_created_at, promo_codes.expires_at AS promo_codes_expires_at 
FROM promo_codes 
WHERE promo_codes.id = ?
2025-03-21 14:59:22,037 - sqlalchemy.engine.Engine - INFO - [generated in 0.00092s] (3,)
2025-03-21 14:59:22,037 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:22,038 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:22,039 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:22,039 - sqlalchemy.engine.Engine - INFO - [cached since 4.275s ago] (7115599761, 1, 0)
2025-03-21 14:59:22,040 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:23,924 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:23,924 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:23,925 - sqlalchemy.engine.Engine - INFO - [cached since 6.168s ago] (7115599761, 1, 0)
2025-03-21 14:59:23,926 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:23,927 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:23,928 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:23,928 - sqlalchemy.engine.Engine - INFO - [cached since 6.172s ago] (7115599761, 1, 0)
2025-03-21 14:59:23,929 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:23,930 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:23,930 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:23,930 - sqlalchemy.engine.Engine - INFO - [cached since 6.165s ago] (7115599761, 1, 0)
2025-03-21 14:59:23,932 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:24,794 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:24,794 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:24,794 - sqlalchemy.engine.Engine - INFO - [cached since 7.037s ago] (7115599761, 1, 0)
2025-03-21 14:59:24,796 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:24,797 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:24,798 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:24,799 - sqlalchemy.engine.Engine - INFO - [cached since 7.042s ago] (7115599761, 1, 0)
2025-03-21 14:59:24,800 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:24,801 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:24,801 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:24,801 - sqlalchemy.engine.Engine - INFO - [cached since 7.037s ago] (7115599761, 1, 0)
2025-03-21 14:59:24,802 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:24,803 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:24,803 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:24,803 - sqlalchemy.engine.Engine - INFO - [cached since 7.039s ago] (7115599761, 1, 0)
2025-03-21 14:59:24,806 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:24,806 - sqlalchemy.engine.Engine - INFO - [cached since 5.092s ago] (3, 'crystals', 1, 0)
2025-03-21 14:59:24,808 - sqlalchemy.engine.Engine - INFO - INSERT INTO user_visited_sections (user_id, section, visited_at) VALUES (?, ?, ?)
2025-03-21 14:59:24,808 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] (3, 'crystals', '2025-03-21 12:59:24.808174')
2025-03-21 14:59:24,811 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-21 14:59:24,813 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:24,816 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
2025-03-21 14:59:24,816 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] (3,)
2025-03-21 14:59:24,817 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.section AS user_visited_sections_section 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section IN (?, ?, ?, ?, ?, ?)
2025-03-21 14:59:24,818 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] (3, 'search_team_menu', 'search_club_menu', 'crystals', 'premium', 'additional', 'gift')
2025-03-21 14:59:24,818 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:24,818 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:24,819 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:24,819 - sqlalchemy.engine.Engine - INFO - [cached since 7.054s ago] (7115599761, 1, 0)
2025-03-21 14:59:24,819 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:24,905 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:24,907 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:24,908 - sqlalchemy.engine.Engine - INFO - [cached since 7.143s ago] (7115599761, 1, 0)
2025-03-21 14:59:24,910 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:25,442 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:25,443 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:25,443 - sqlalchemy.engine.Engine - INFO - [cached since 7.686s ago] (7115599761, 1, 0)
2025-03-21 14:59:25,444 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:25,446 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:25,447 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:25,447 - sqlalchemy.engine.Engine - INFO - [cached since 7.69s ago] (7115599761, 1, 0)
2025-03-21 14:59:25,448 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:25,448 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:25,448 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:25,448 - sqlalchemy.engine.Engine - INFO - [cached since 7.683s ago] (7115599761, 1, 0)
2025-03-21 14:59:25,449 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:26,386 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:26,386 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:26,387 - sqlalchemy.engine.Engine - INFO - [cached since 8.629s ago] (7115599761, 1, 0)
2025-03-21 14:59:26,387 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:26,389 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:26,389 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:26,390 - sqlalchemy.engine.Engine - INFO - [cached since 8.632s ago] (7115599761, 1, 0)
2025-03-21 14:59:26,391 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:26,392 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:26,392 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:26,392 - sqlalchemy.engine.Engine - INFO - [cached since 8.628s ago] (7115599761, 1, 0)
2025-03-21 14:59:26,393 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:26,518 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:26,519 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:26,520 - sqlalchemy.engine.Engine - INFO - [cached since 8.755s ago] (7115599761, 1, 0)
2025-03-21 14:59:26,525 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:26,525 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:26,526 - sqlalchemy.engine.Engine - INFO - [cached since 8.76s ago] (7115599761, 1, 0)
2025-03-21 14:59:26,528 - sqlalchemy.engine.Engine - INFO - SELECT user_achievements.id AS user_achievements_id, user_achievements.user_id AS user_achievements_user_id, user_achievements.achievement_id AS user_achievements_achievement_id, user_achievements.achieved_at AS user_achievements_achieved_at, achievements.id AS achievements_id, achievements."key" AS achievements_key, achievements.name AS achievements_name, achievements.description AS achievements_description, achievements.icon AS achievements_icon, achievements.is_purchasable AS achievements_is_purchasable, achievements.price AS achievements_price, achievements.created_at AS achievements_created_at 
FROM user_achievements JOIN achievements ON user_achievements.achievement_id = achievements.id 
WHERE user_achievements.user_id = ?
2025-03-21 14:59:26,528 - sqlalchemy.engine.Engine - INFO - [generated in 0.00078s] (3,)
2025-03-21 14:59:26,530 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:26,531 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:26,531 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:26,532 - sqlalchemy.engine.Engine - INFO - [cached since 8.767s ago] (7115599761, 1, 0)
2025-03-21 14:59:26,534 - utils.helpers - ERROR - Error checking premium status: can't compare offset-naive and offset-aware datetimes
2025-03-21 14:59:26,534 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:26,535 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:27,520 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:27,520 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:27,521 - sqlalchemy.engine.Engine - INFO - [cached since 9.764s ago] (7115599761, 1, 0)
2025-03-21 14:59:27,524 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:27,525 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:27,527 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:27,528 - sqlalchemy.engine.Engine - INFO - [cached since 9.771s ago] (7115599761, 1, 0)
2025-03-21 14:59:27,528 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:27,529 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:27,530 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:27,530 - sqlalchemy.engine.Engine - INFO - [cached since 9.765s ago] (7115599761, 1, 0)
2025-03-21 14:59:27,531 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:27,532 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:27,533 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:27,534 - sqlalchemy.engine.Engine - INFO - [cached since 9.769s ago] (7115599761, 1, 0)
2025-03-21 14:59:27,534 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:27,537 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-21 14:59:27,538 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.tg_id AS users_tg_id, users.username AS users_username, users.first_name AS users_first_name, users.is_premium AS users_is_premium, users.premium_end_date AS users_premium_end_date, users.crystals AS users_crystals, users.language AS users_language, users.blocked AS users_blocked, users.last_gift AS users_last_gift, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.coins AS users_coins, users.premium_until AS users_premium_until 
FROM users 
WHERE users.tg_id = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:27,538 - sqlalchemy.engine.Engine - INFO - [cached since 9.773s ago] (7115599761, 1, 0)
2025-03-21 14:59:27,540 - sqlalchemy.engine.Engine - INFO - SELECT user_visited_sections.id AS user_visited_sections_id, user_visited_sections.user_id AS user_visited_sections_user_id, user_visited_sections.section AS user_visited_sections_section, user_visited_sections.visited_at AS user_visited_sections_visited_at 
FROM user_visited_sections 
WHERE user_visited_sections.user_id = ? AND user_visited_sections.section = ?
 LIMIT ? OFFSET ?
2025-03-21 14:59:27,540 - sqlalchemy.engine.Engine - INFO - [cached since 7.826s ago] (3, 'premium', 1, 0)
2025-03-21 14:59:27,541 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-21 14:59:32,050 - aiogram.dispatcher.dispatcher - INFO - Stop polling...
2025-03-21 14:59:32,050 - aiogram - WARNING - Goodbye!
